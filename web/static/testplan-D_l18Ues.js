import{r as d,l as xe,aR as Fe,j as Ye,z as c,B as n,R as o,J as t,al as w,u as b,L as x,Q as D,aS as Je,A as r,O as u,P as y,I as g,E as de,a6 as I,K as Oe,aj as Qe,D as Ze}from"./vue-CdYMfVVj.js";import{_ as Ge,c as Xe,E as el,H as ll,u as tl,ai as al,i as Ce,aj as Ve,ak as ol,al as nl,am as il,an as sl,ao as rl,R as $e,l as dl}from"./index-B6WbZO8q.js";import{a as ue}from"./comp-ClzPtuSi.js";import ul from"./list-DOZRfPC-.js";import pl from"./unittest-BXxv-x3t.js";import{C as _l}from"./list-BbxMWpnt.js";import"./element-GwJlJi_X.js";import"./editor-Dhn2M38E.js";import"./result-CcYZ99eM.js";import"./logdetail-BpmCFm-r.js";import"./changeTree-DT6Je88Y.js";import"./editor.api-_A1huWdg.js";import"./list.vue_vue_type_style_index_1_lang-B8pmpZgU.js";function F(k){return k<10?"0"+k:k}function vl(k,W){/^[\d\-]+T[\d\:]+(\.\d{1,3})?\+0000$/.test(k)&&(k=k.replace("+0000","Z")),k=new Date(k).getTime(),k=parseInt(k)===NaN?0:parseInt(k);let $=new Date(k),Z=$.getFullYear(),S=$.getMonth()+1,f=$.getDate(),R=$.getHours(),G=$.getMinutes(),Y=$.getSeconds();return Z+"-"+F(S)+"-"+F(f)+" "+F(R)+":"+F(G)+":"+F(Y)}const fl={class:"pagelistbox"},cl={class:"c-titlebox"},ml={class:"btns"},gl={class:"c-top-searchbox"},wl={class:"rbox"},bl={class:"el-form-item asterisk-left"},hl={class:"el-form-item__content"},yl={class:"c-tablebox tableboxContain c-tooltip"},kl={class:"bodybox"},xl={class:"c-scroll-contain"},Cl={class:"ellipsis"},Vl={style:{margin:"0 -20px"}},$l=["innerHTML"],Tl=["onClick"],zl=["onClick"],Dl={style:{display:"flex"}},Sl=["onClick"],Ul=["onClick"],ql=["onClick"],Il=["onClick"],Ll=["onClick"],El={class:"c-emptybox"},Rl={key:0,class:"c-pagination"},Ml={class:"isShowAddDialogBox c-scroll-contain"},Wl={key:0},Hl={key:1,class:"placeholder"},Nl={class:"dialog-footer"},Al={class:"isShowAddDialogBox c-scroll-contain"},Bl={key:0},jl={key:1,class:"placeholder"},Pl={class:"dialog-footer"},Kl={class:"ylkDialogContent"},Fl={class:"lbox"},Yl={style:{margin:"0px 20px 20px 20px"},class:"c-treeinpbox"},Jl={class:"treecontian"},Ol=["title"],Ql={class:"item"},Zl={class:"ellipsis"},Gl={class:"rbox topbox"},Xl={style:{height:"33px"},class:"totalbox"},et={class:"num"},lt={style:{height:"calc(100% - 40px)"},class:"checklistbox"},tt={class:"citem"},at={class:"pname"},ot=["onClick"],nt={class:"name"},it=["onClick"],st={class:"dialog-footer"},rt={class:"glDialogboxContent re"},dt={class:"glDialogbox"},ut={class:"ellipsis"},pt={style:{margin:"0 -20px"}},_t=["innerHTML"],vt={class:"ellipsis"},ft={style:{margin:"0 -20px"}},ct=["innerHTML"],mt=["onClick"],gt={class:"c-emptybox"},wt={class:"dialog-footer"},bt={class:"testbox"},ht={class:"drawerbtn"},yt={__name:"testplan",setup(k){const W=Fe(),$=Je(),Z=tl(),S=d(!1);let f=xe({page:1,pagesize:30,plan_name:"",plan_state:0});const R=d(0),G=()=>{f.plan_state=0,f.plan_name=""};Xe(f,W.query);let Y=d([]);const T=a=>{if(a=="init"&&(f.page=1),al(f).then(e=>{let s=e.rows||[];Y.value=s,R.value=e.total_records}),a!="noquery"){let e={...W.query,...f};$.replace({path:W.path,query:e})}};T(),d([]),d(null);const X=d([]),ee=d([]),pe=d(),J=d(),Te=async a=>{a&&a.validate((e,s)=>{if(e){if(!i.unit_llm_id&&i.tag=="S")return _this.$message("请选择执行大模型","error"),!1;if(!i.evaluation_llm_id)return _this.$message("请选择评测大模型","error"),!1;if(!i.evaluation_prompt_id)return _this.$message("请选择提示词","error"),!1;nl({id:i.id,name:i.name,caption:i.caption,tag:i.tag||"W",note:i.note,workflow_id:i.workflow_id||void 0,unit_llm_id:i.unit_llm_id||void 0,evaluation_llm_id:i.evaluation_llm_id||void 0,evaluation_prompt_id:i.evaluation_prompt_id||void 0,app_id:i.app_id||void 0,is_forced:i.is_forced}).then(p=>{p&&(_this.$message("操作成功"),N.value=!1,T())}).catch(p=>{})}})},H=d([]),ze=async a=>{q.value&&q.value.tag=="S"?(ee.value.length<1&&(ee.value=await $e({},"S")),H.value=[{id:0,name:"未分类",color:"#ff0000",pid:null,children:[]}].concat(ee.value)):(X.value.length<1&&(X.value=await $e({},"W")),H.value=[{id:0,name:"未分类",color:"#ff0000",pid:null,children:[]}].concat(X.value)),a&&a()},N=d(!1),i=xe({id:0,name:"",caption:"",note:"",app_id:"",workflow_id:"",is_forced:!1,evaluation_llm_id:"",evaluation_prompt_id:"",evaluation_prompt_name:"",tag:"W"}),O=d([]),De=a=>{S.value=!1,O.value=[],i.evaluation_prompt_id=a[0].id,i.evaluation_prompt_name=a[0].name,v.value.evaluation_prompt_id=a[0].id,v.value.evaluation_prompt_name=a[0].name},L=d(null),le=async a=>{J.value&&J.value.clearValidate(),i.tag=a.tag||"W",i.id=a.id,i.name=a.name,i.is_forced=a.is_forced===void 0?!1:a.is_forced,i.caption=a.caption,i.note=a.note,i.unit_llm_id=a.unit_llm_id?parseInt(a.unit_llm_id):"",i.app_id=a.app_id?parseInt(a.app_id):"",i.workflow_id=a.workflow_id?parseInt(a.workflow_id):"",i.evaluation_llm_id=a.evaluation_llm_id?parseInt(a.evaluation_llm_id):"",i.evaluation_prompt_id=a.evaluation_prompt_id?parseInt(a.evaluation_prompt_id):"",i.evaluation_prompt_name=a.evaluation_prompt_name||"",N.value=!0},Se=d([]),Ue=a=>{Se.value=a},qe=async(a,e)=>{e&&e.validate((s,p)=>{if(s){let _={...v.value};_.id=a,_.tag=void 0,il(_,te.value.is_continue).then(h=>{h&&(A.value=!1,_this.$message("执行成功"),T())})}})},te=d(null),A=d(!1),v=d({plan_name:"",unit_llm_id:void 0,evaluation_llm_id:void 0,workflow_id:void 0,evaluation_prompt_id:"",evaluation_prompt_name:"",tag:"W"}),_e=a=>{te.value=a,v.value.tag=a.tag||"W",v.value.unit_llm_id=void 0,v.value.workflow_id=void 0,v.value.evaluation_llm_id=a.evaluation_llm_id?parseInt(a.evaluation_llm_id):"",v.value.evaluation_prompt_id=a.evaluation_prompt_id?parseInt(a.evaluation_prompt_id):"",v.value.evaluation_prompt_name=a.evaluation_prompt_name,v.value.plan_name=a.name+" ("+vl(Date.now())+") 测试报告",A.value=!0},Ie=a=>{_this.$confirm("确定要删除所选数据?").then(e=>{ol({id:a.id}).then(s=>{_this.$message("删除成功"),T()})})};let ve=null;const B=d(!1),ae=d([]),U=d([]),q=d(null),Le=async a=>{U.value=[];let e=await Ve({id:a.id});e&&(ae.value=e.relation_cate_ids,U.value=e.relation_cate_ids),q.value=a,ze(()=>{ce(ae.value)}),B.value=!0},Ee=(a,e)=>{let s=-1;U.value.forEach((p,_)=>{p==a.id&&(s=_)}),e?s==-1&&U.value.push(a.id):s!=-1&&U.value.splice(s,1),clearTimeout(ve),ve=setTimeout(()=>{let p=[];L.value&&(p=L.value.getCheckedKeys()),ce(p)},70)},fe=d([]),ce=(a=[])=>{if(console.log(a),!Array.isArray(a)||!H.value)return;U.value=a;const e=dl.cloneDeep(H.value),s=p=>{var h;const _=a.includes(p.id);if(p.checked=_,p.isshow=_,(h=p.children)!=null&&h.length){let V=!1;p.children.forEach(M=>{s(M),M.checked&&(V=!0)}),_||(p.isshow=V)}};e.forEach(s),fe.value=e},oe=d("");Ye(oe,a=>{var e;(e=L.value)==null||e.filter(a)});const Re=(a,e)=>a?e.name.includes(a):!0,Me=()=>{sl({cates:U.value,id:q.value.id}).then(a=>{B.value=!1,T()}).catch(a=>{})},j=d(!1),me=d(),ge=d(),We=()=>{j.value=!0},P=d(!1),He=async a=>{z.value=[];let e=await Ve({id:a.id});e&&(z.value=e.case_models),q.value=a,P.value=!0},z=d([]),we=a=>{z.value.length==0?z.value=a:a.forEach(e=>{let s=-1;z.value.forEach((p,_)=>{p.id==e.id&&(s=_)}),s==-1&&z.value.push(e)})},Ne=()=>{q.value.tag=="S"?we(ge.value.getCheckList()):we(me.value.getCheckList()),j.value=!1},Ae=a=>{let e=z.value,s=[];e.forEach(p=>{s.push(p.id)}),rl({cates:s,id:q.value.id}).then(p=>{P.value=!1,T()}).catch(p=>{})};d([]);const Be=a=>{$.push({path:"/testplan/detail",query:{id:a.id,fpath:W.fullPath}})},K=d([]);el({page:1,pagesize:1e4}).then(a=>{K.value=a||[]});const ne=d([]);ll({page:1,pagesize:1e4}).then(a=>{let e=a.rows||[];ne.value=e});const be=(a,e,s)=>{if(a.field=="workflow_id"&&!e)return i.app_id?(s(),!0):(s(new Error("请选择流程")),!1);s()},ie=d(null);return(a,e)=>{const s=w("el-button"),p=w("el-input"),_=w("el-form-item"),h=w("el-option"),V=w("el-select"),M=w("el-form"),C=w("el-table-column"),E=w("el-scrollbar"),se=w("el-popover"),re=w("el-tooltip"),he=w("el-table"),je=w("el-pagination"),ye=w("el-radio"),Pe=w("el-radio-group"),Q=w("el-dialog"),Ke=w("el-tree"),ke=w("el-drawer");return r(),c(D,null,[n("div",fl,[n("div",cl,[e[42]||(e[42]=n("div",{class:"title"},"测试计划",-1)),n("div",ml,[o(s,{onClick:e[0]||(e[0]=l=>le({id:null,tag:"W"})),plain:"",size:"small"},{default:t(()=>e[40]||(e[40]=[u("新增流程测试计划")])),_:1}),o(s,{onClick:e[1]||(e[1]=l=>le({id:null,tag:"S"})),plain:"",size:"small"},{default:t(()=>e[41]||(e[41]=[u("新增单元测试计划")])),_:1})])]),n("div",gl,[o(M,{model:b(f),ref:"searchFormRef",inline:"",class:"demo-form-inline"},{default:t(()=>[o(_,{label:"名称",prop:"question"},{default:t(()=>[o(p,{clearable:"",modelValue:b(f).plan_name,"onUpdate:modelValue":e[2]||(e[2]=l=>b(f).plan_name=l),type:"text"},null,8,["modelValue"])]),_:1}),o(_,{label:"状态",prop:"case_state"},{default:t(()=>[o(V,{style:{width:"160px"},clearable:"",modelValue:b(f).plan_state,"onUpdate:modelValue":e[3]||(e[3]=l=>b(f).plan_state=l),placeholder:""},{default:t(()=>[o(h,{label:"请选择",value:0}),o(h,{label:"准备就绪",value:1001}),o(h,{label:"测试中",value:2001}),o(h,{label:"测试完成",value:3001})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),n("div",wl,[n("div",bl,[n("div",hl,[o(s,{onClick:e[4]||(e[4]=l=>T("init")),type:"primary"},{default:t(()=>e[43]||(e[43]=[u("查询")])),_:1}),o(s,{onClick:e[5]||(e[5]=l=>G()),plain:""},{default:t(()=>e[44]||(e[44]=[u("重置")])),_:1})])])])]),n("div",yl,[n("div",kl,[o(he,{ref_key:"tableRef",ref:ie,"tooltip-effect":"light",border:"",data:b(Y),style:{width:"100%"},"max-height":b(Z).getters.innerHeight-193,onSelectionChange:Ue},{empty:t(l=>[n("div",El,[o(Ce,{type:"empzwssjg",width:"100",height:"100"}),e[51]||(e[51]=u("暂无数据~~ "))])]),default:t(()=>[o(C,{prop:"id",width:"70",label:"id"}),o(C,{label:"计划名称"},{default:t(l=>[n("div",xl,y(l.row.name),1)]),_:1}),o(C,{label:"介绍"},{default:t(l=>[l.row.caption?(r(),g(se,{key:0,placement:"top-start",width:500,trigger:"hover"},{reference:t(()=>[n("div",Cl,y(l.row.caption),1)]),default:t(()=>[n("div",Vl,[o(E,{"max-height":"400"},{default:t(()=>[n("div",{innerHTML:l.row.caption.replace(/\n/g,"<br>"),style:{margin:"0 20px"}},null,8,$l)]),_:2},1024)])]),_:2},1024)):x("",!0)]),_:1}),o(C,{align:"left",label:"关联的测试库"},{default:t(l=>[n("span",{style:{cursor:"pointer"},onClick:m=>Le(l.row)},[n("span",{class:de([l.row.tag=="S"?"c-success":"c-primary","iconfont icon-liebiao-yongli"])},null,2),u("关联用例库("+y(l.row.cate_count)+") ",1)],8,Tl)]),_:1}),o(C,{align:"left",label:"选择的用例"},{default:t(l=>[n("span",{style:{cursor:"pointer"},onClick:m=>He(l.row)},[n("span",{class:de([l.row.tag=="S"?"c-success":"c-primary","iconfont icon-liebiao-yongli"])},null,2),u("关联用例("+y(l.row.case_count)+") ",1)],8,zl)]),_:1}),o(C,{width:"100",label:"状态"},{default:t(l=>[n("div",Dl,[n("span",{class:de({"c-plain-btn":l.row.state=="准备就绪","c-success-btn":l.row.state=="测试完成","c-primary-btn":l.row.state=="测试中"})},y(l.row.state),3),l.row.error_msg?(r(),g(re,{key:0,effect:"light",placement:"right",content:"<div style=display:block;max-width:600px; class=c-danger>"+l.row.error_msg+"</div>","raw-content":""},{default:t(()=>e[45]||(e[45]=[n("span",{class:"c-danger iconfont icon-gantanhao1"},null,-1)])),_:2},1032,["content"])):x("",!0)])]),_:1}),o(C,{width:"160",align:"center",label:"添加时间"},{default:t(l=>[u(y(b(ue)(l.row.created_at)),1)]),_:1}),o(C,{width:"160",align:"center",label:"最后执行时间"},{default:t(l=>[u(y(b(ue)(l.row.updated_at)||b(ue)(l.row.created_at)),1)]),_:1}),o(C,{width:"260",align:"right",label:"操作"},{default:t(l=>[l.row.state!="准备就绪"?(r(),c("div",{key:0,onClick:m=>Be(l.row),class:"c-table-ibtn"},e[46]||(e[46]=[n("span",{class:"iconfont icon-liebiao-baogao"},null,-1),u(" 查看报告 ")]),8,Sl)):x("",!0),l.row.is_continue?(r(),c("div",{key:1,onClick:m=>_e(l.row),class:"c-table-ibtn"},e[47]||(e[47]=[n("span",{class:"iconfont icon-liebiao-zhihang"},null,-1),u(" 继续执行 ")]),8,Ul)):(r(),c("div",{key:2,onClick:m=>_e(l.row),class:"c-table-ibtn"},e[48]||(e[48]=[n("span",{class:"iconfont icon-liebiao-zhihang"},null,-1),u(" 执行 ")]),8,ql)),n("div",{onClick:m=>le(l.row),class:"c-table-ibtn"},e[49]||(e[49]=[n("span",{class:"iconfont icon-xiugai"},null,-1),u(" 修改 ")]),8,Il),n("div",{onClick:m=>Ie(l.row),class:"c-table-ibtn c-btn-del"},e[50]||(e[50]=[n("span",{class:"iconfont icon-shuzhuang-shanchu"},null,-1),u(" 删除 ")]),8,Ll)]),_:1})]),_:1},8,["data","max-height"]),R.value>0?(r(),c("div",Rl,[o(je,{"hide-on-single-page":!1,background:"","page-size":b(f).pagesize,"current-page":b(f).page,onSizeChange:e[6]||(e[6]=l=>{b(f).pagesize=l,b(f).page=Math.min(Math.ceil(R.value/b(f).pagesize),b(f).page),T()}),onCurrentChange:e[7]||(e[7]=l=>{b(f).page=l,ie.value&&ie.value.scrollTo(0,0),T()}),"page-sizes":[30,50,100,900],layout:"total,sizes,jumper,prev, pager, next",total:R.value},null,8,["page-size","current-page","total"])])):x("",!0)])])]),o(Q,{"align-center":"",modelValue:N.value,"onUpdate:modelValue":e[18]||(e[18]=l=>N.value=l),"close-on-click-modal":!1,title:"测试计划",width:"800"},{footer:t(()=>[n("div",Nl,[o(s,{plain:"",onClick:e[16]||(e[16]=l=>N.value=!1)},{default:t(()=>e[59]||(e[59]=[u(" 取消 ")])),_:1}),o(s,{type:"primary",onClick:e[17]||(e[17]=l=>Te(J.value))},{default:t(()=>e[60]||(e[60]=[u(" 确定 ")])),_:1})])]),default:t(()=>[n("div",Ml,[o(E,{"max-height":"800"},{default:t(()=>[o(M,{ref_key:"formRef1",ref:J,model:i,style:{width:"100%"},"label-width":"auto",inline:"","label-position":"top",class:"demo-dynamic tl"},{default:t(()=>[i.tag=="W"?(r(),g(_,{key:0,style:{width:"100%","margin-right":"0"},prop:"type",label:""},{label:t(()=>[e[53]||(e[53]=u(" 使用的流程 ")),o(re,{"popper-class":"c-flowtip",class:"item",effect:"dark",content:"默认流程： 该测试按照 原流程执行。指定流程：按照人工指定的流程执行，注意输入参数要和原流程一致。",placement:"top"},{default:t(()=>e[52]||(e[52]=[n("span",{style:{position:"relative",top:"1px"},class:"iconfont icon-bangzhu"},null,-1)])),_:1})]),default:t(()=>[o(Pe,{modelValue:i.is_forced,"onUpdate:modelValue":e[8]||(e[8]=l=>i.is_forced=l)},{default:t(()=>[o(ye,{value:!0},{default:t(()=>e[54]||(e[54]=[u("按指定的流程执行")])),_:1}),o(ye,{value:!1},{default:t(()=>e[55]||(e[55]=[u("按默认流程执行")])),_:1})]),_:1},8,["modelValue"])]),_:1})):x("",!0),i.tag=="W"?(r(),g(_,{key:1,style:{width:"calc(50% - 8px)","margin-right":"16px"},prop:"workflow_id",label:"流程选择",rules:{trigger:"blur",required:!0,validator:be}},{default:t(()=>[o(V,{clearable:"",modelValue:i.workflow_id,"onUpdate:modelValue":e[9]||(e[9]=l=>i.workflow_id=l),class:"val",filterable:"",placeholder:"请选择流程"},{default:t(()=>[(r(!0),c(D,null,I(ne.value,l=>(r(),g(h,{value:parseInt(l.id,10),label:l.name},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1},8,["rules"])):x("",!0),i.tag=="S"?(r(),g(_,{key:2,style:{width:"calc(50% - 8px)","margin-right":"16px"},prop:"unit_llm_id",label:"执行大模型",rules:[{required:!0,message:"请选择执行大模型",trigger:"change"}]},{default:t(()=>[o(V,{modelValue:i.unit_llm_id,"onUpdate:modelValue":e[10]||(e[10]=l=>i.unit_llm_id=l),clearable:"",class:"val",filterable:"",placeholder:"请选择执行大模型"},{default:t(()=>[(r(!0),c(D,null,I(K.value,l=>(r(),g(h,{value:parseInt(l.id,10),label:l.name},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1})):x("",!0),o(_,{style:{width:"calc(50% - 8px)","margin-right":"0"},prop:"evaluation_llm_id",label:"",rules:[{required:!0,message:"请选择评测大模型",trigger:"change"}]},{label:t(()=>[e[57]||(e[57]=u(" 评测大模型 ")),o(re,{"popper-class":"c-flowtip",class:"item",effect:"dark",content:"用来对输出结果进行打分的大模型，按照提示词对输出和标准答案进行对比打分。",placement:"top"},{default:t(()=>e[56]||(e[56]=[n("span",{style:{position:"relative",top:"1px"},class:"iconfont icon-bangzhu"},null,-1)])),_:1})]),default:t(()=>[o(V,{modelValue:i.evaluation_llm_id,"onUpdate:modelValue":e[11]||(e[11]=l=>i.evaluation_llm_id=l),clearable:"",class:"val",filterable:"",placeholder:"请选择评测大模型"},{default:t(()=>[(r(!0),c(D,null,I(K.value,l=>(r(),g(h,{value:parseInt(l.id,10),label:l.name},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1}),o(_,{style:{width:"100%","margin-right":"0"},prop:"evaluation_prompt_id",rules:[{required:!0,message:"请选择提示词"}],label:"提示词"},{default:t(()=>[n("div",{onClick:e[12]||(e[12]=l=>{S.value=!0,O.value=[{id:i.evaluation_prompt_id}]}),class:"c-switchbox pointer"},[i.evaluation_prompt_id?(r(),c("span",Wl,y(i.evaluation_prompt_name),1)):(r(),c("span",Hl,"请选择提示词")),e[58]||(e[58]=n("span",{style:{position:"absolute",top:"-36px",right:"0",color:"var(--el-color-primary)"},class:"c-pointer"},"选择",-1))])]),_:1}),o(_,{style:{width:"100%","margin-right":"0"},prop:"name",label:"计划名称",rules:[{required:!0,message:"请填写计划名称",trigger:"blur"}]},{default:t(()=>[o(p,{modelValue:i.name,"onUpdate:modelValue":e[13]||(e[13]=l=>i.name=l),style:{width:"100%"},rows:4,type:"textarea",placeholder:"请填写计划名称"},null,8,["modelValue"])]),_:1}),o(_,{style:{width:"100%","margin-right":"0"},prop:"caption",label:"计划介绍"},{default:t(()=>[o(p,{modelValue:i.caption,"onUpdate:modelValue":e[14]||(e[14]=l=>i.caption=l),style:{width:"100%"},rows:4,type:"textarea",placeholder:"请填写计划介绍"},null,8,["modelValue"])]),_:1}),o(_,{style:{width:"100%","margin-right":"0"},prop:"note",label:"计划备注"},{default:t(()=>[o(p,{modelValue:i.note,"onUpdate:modelValue":e[15]||(e[15]=l=>i.note=l),style:{width:"100%"},rows:4,type:"textarea",placeholder:"请填写计划备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1},8,["modelValue"]),o(Q,{"align-center":"",modelValue:A.value,"onUpdate:modelValue":e[26]||(e[26]=l=>A.value=l),title:"执行测试计划",width:"600"},{footer:t(()=>[n("div",Pl,[o(s,{plain:"",onClick:e[24]||(e[24]=l=>A.value=!1)},{default:t(()=>e[62]||(e[62]=[u(" 取消 ")])),_:1}),o(s,{type:"primary",onClick:e[25]||(e[25]=l=>qe(te.value.id,pe.value))},{default:t(()=>e[63]||(e[63]=[u(" 确定 ")])),_:1})])]),default:t(()=>[n("div",Al,[o(M,{ref_key:"testparamRef1",ref:pe,style:{width:"100%"},model:v.value,"label-width":"auto",inline:"","label-position":"top",class:"demo-dynamic tl"},{default:t(()=>[v.value.tag=="W"?(r(),g(_,{key:0,style:{width:"calc(50% - 8px)","margin-right":"16px"},prop:"workflow_id",label:"流程选择",rules:{trigger:"blur",required:!0,validator:be}},{default:t(()=>[o(V,{clearable:"",modelValue:v.value.workflow_id,"onUpdate:modelValue":e[19]||(e[19]=l=>v.value.workflow_id=l),class:"val",filterable:"",placeholder:"请选择流程"},{default:t(()=>[(r(!0),c(D,null,I(ne.value,l=>(r(),g(h,{value:parseInt(l.id,10),label:l.name},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1},8,["rules"])):x("",!0),v.value.tag=="S"?(r(),g(_,{key:1,style:{width:"calc(50% - 8px)","margin-right":"16px"},prop:"unit_llm_id",label:"执行大模型",rules:[{required:!0,message:"请选择执行大模型",trigger:"change"}]},{default:t(()=>[o(V,{modelValue:v.value.unit_llm_id,"onUpdate:modelValue":e[20]||(e[20]=l=>v.value.unit_llm_id=l),clearable:"",class:"val",filterable:"",placeholder:"请选择执行大模型"},{default:t(()=>[(r(!0),c(D,null,I(K.value,l=>(r(),g(h,{value:parseInt(l.id,10),label:l.name},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1})):x("",!0),o(_,{style:{width:"calc(50% - 8px)","margin-right":"0"},prop:"evaluation_llm_id",label:"评测大模型",rules:[{required:!0,message:"请选择评测大模型",trigger:"change"}]},{default:t(()=>[o(V,{modelValue:v.value.evaluation_llm_id,"onUpdate:modelValue":e[21]||(e[21]=l=>v.value.evaluation_llm_id=l),clearable:"",class:"val",filterable:"",placeholder:"请选择评测大模型"},{default:t(()=>[(r(!0),c(D,null,I(K.value,l=>(r(),g(h,{value:parseInt(l.id,10),label:l.name},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1}),o(_,{style:{width:"100%","margin-right":"0"},prop:"evaluation_prompt_id",rules:[{required:!0,message:"请选择提示词"}],label:"提示词"},{default:t(()=>[n("div",{onClick:e[22]||(e[22]=l=>{S.value=!0,O.value=[{id:v.value.evaluation_prompt_id}]}),class:"c-switchbox pointer"},[v.value.evaluation_prompt_id?(r(),c("span",Bl,y(v.value.evaluation_prompt_name),1)):(r(),c("span",jl,"请选择提示词")),e[61]||(e[61]=n("span",{style:{position:"absolute",top:"-36px",right:"0",color:"var(--el-color-primary)"},class:"c-pointer"},"选择",-1))])]),_:1}),o(_,{style:{width:"100%","margin-right":"0"},prop:"plan_name",label:"测试报告名称",rules:[{required:!0,message:"请填写测试报告名称",trigger:"blur"}]},{default:t(()=>[o(p,{modelValue:v.value.plan_name,"onUpdate:modelValue":e[23]||(e[23]=l=>v.value.plan_name=l),style:{width:"100%"},rows:4,type:"textarea",placeholder:"请填写计划名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"]),o(Q,{"align-center":"",modelValue:B.value,"onUpdate:modelValue":e[31]||(e[31]=l=>B.value=l),title:"计划关联用例库",width:"900"},{footer:t(()=>[n("div",st,[o(s,{plain:"",onClick:e[29]||(e[29]=l=>B.value=!1)},{default:t(()=>e[65]||(e[65]=[u(" 取消 ")])),_:1}),o(s,{type:"primary",onClick:e[30]||(e[30]=l=>Me())},{default:t(()=>e[66]||(e[66]=[u(" 保存 ")])),_:1})])]),default:t(()=>[n("div",Kl,[n("div",Fl,[n("div",Yl,[e[64]||(e[64]=n("span",{class:"iconfont icon-sousuo1"},null,-1)),Oe(n("input",{"onUpdate:modelValue":e[27]||(e[27]=l=>oe.value=l),type:"text",placeholder:"搜索菜单名称"},null,512),[[Qe,oe.value]])]),n("div",Jl,[o(E,null,{default:t(()=>[o(Ke,{ref_key:"treeSelect1",ref:L,data:H.value,"node-key":"id","show-checkbox":"","filter-node-method":Re,onCheckChange:Ee,"default-checked-keys":ae.value,"empty-text":"暂无测试类目信息","highlight-current":"","default-expand-all":"","expand-on-click-node":!1},{default:t(({node:l,data:m})=>[n("div",{title:m.name,class:"custom-tree-node"},[n("div",Ql,[n("span",{class:"c-color",style:Ze("background-color:"+m.color)},null,4),n("p",Zl,y(m.name),1)])],8,Ol)]),_:1},8,["data","default-checked-keys"])]),_:1})])]),n("div",Gl,[n("div",Xl,[n("span",et,"已选择："+y(U.value.length),1),n("span",{onClick:e[28]||(e[28]=l=>L.value.setCheckedKeys([])),class:"c-btn-text"},"清空选择")]),n("div",lt,[o(E,null,{default:t(()=>[(r(!0),c(D,null,I(fe.value.filter(l=>l.isshow),l=>(r(),c("div",{key:l.id,class:"item"},[n("div",tt,[n("div",at,y(l.name),1),l.checked&&l.isshow?(r(),c("span",{key:0,onClick:m=>L.value.setChecked(l.id,!1,!0),class:"iconfont icon-guanbi"},null,8,ot)):x("",!0)]),l.children?(r(!0),c(D,{key:0},I(l.children.filter(m=>m.isshow),m=>(r(),c("div",{class:"citem",key:m.id},[n("div",nt,y(m.name),1),n("span",{onClick:kt=>L.value.setChecked(m.id,!1,!0),class:"iconfont icon-guanbi"},null,8,it)]))),128)):x("",!0)]))),128))]),_:1})])])])]),_:1},8,["modelValue"]),o(Q,{"align-center":"",modelValue:P.value,"onUpdate:modelValue":e[35]||(e[35]=l=>P.value=l),title:"计划关联用例",width:"1100"},{footer:t(()=>[n("div",wt,[o(s,{onClick:e[33]||(e[33]=l=>P.value=!1),plain:""},{default:t(()=>e[70]||(e[70]=[u("取消")])),_:1}),o(s,{onClick:e[34]||(e[34]=l=>Ae()),type:"primary"},{default:t(()=>e[71]||(e[71]=[u("保存")])),_:1})])]),default:t(()=>[n("div",rt,[o(s,{style:{position:"absolute",right:"50px",top:"12px"},onClick:e[32]||(e[32]=l=>We()),plain:"",class:"on"},{default:t(()=>e[67]||(e[67]=[u("新增关联用例")])),_:1}),n("div",dt,[o(E,null,{default:t(()=>[o(he,{"tooltip-effect":"light",border:"",data:z.value,style:{width:"100%"}},{empty:t(l=>[n("div",gt,[o(Ce,{type:"empzwssjg",width:"100",height:"100"}),e[69]||(e[69]=u("暂无数据~~ "))])]),default:t(()=>[o(C,{prop:"id",width:"70",label:"id"}),o(C,{label:"问题"},{default:t(l=>[l.row.question?(r(),g(se,{key:0,placement:"top-start",width:500,trigger:"hover"},{reference:t(()=>[n("div",ut,y(l.row.question),1)]),default:t(()=>[n("div",pt,[o(E,{"max-height":"400"},{default:t(()=>[n("div",{innerHTML:l.row.question.replace(/\n/g,"<br>"),style:{margin:"0 20px"}},null,8,_t)]),_:2},1024)])]),_:2},1024)):x("",!0)]),_:1}),o(C,{label:"参考答案"},{default:t(l=>[l.row.right_answer?(r(),g(se,{key:0,placement:"top-start",width:500,trigger:"hover"},{reference:t(()=>[n("div",vt,y(l.row.right_answer),1)]),default:t(()=>[n("div",ft,[o(E,{"max-height":"400"},{default:t(()=>[n("div",{innerHTML:l.row.right_answer.replace(/\n/g,"<br>"),style:{margin:"0 20px"}},null,8,ct)]),_:2},1024)])]),_:2},1024)):x("",!0)]),_:1}),o(C,{width:"100",align:"center",label:"操作"},{default:t(l=>[n("div",{onClick:m=>z.value.splice(l.$index,1),class:"c-table-ibtn c-btn-del"},e[68]||(e[68]=[n("span",{class:"iconfont icon-shuzhuang-shanchu"},null,-1),u(" 删除 ")]),8,mt)]),_:1})]),_:1},8,["data"])]),_:1})])])]),_:1},8,["modelValue"]),o(ke,{modelValue:j.value,"onUpdate:modelValue":e[38]||(e[38]=l=>j.value=l),"with-header":!1,"destroy-on-close":!0,size:"90%",title:"选择测试用例",direction:"rtl"},{default:t(()=>[n("div",bt,[q.value.tag=="S"?(r(),g(pl,{key:0,TEST_TYPE:"S",ref_key:"CompUnitTestref",ref:ge},null,512)):(r(),g(ul,{key:1,TEST_TYPE:"W",ref_key:"CompTestref",ref:me},null,512))]),n("div",ht,[o(s,{onClick:e[36]||(e[36]=l=>j.value=!1),plain:""},{default:t(()=>e[72]||(e[72]=[u("取消")])),_:1}),o(s,{onClick:e[37]||(e[37]=l=>Ne()),type:"primary"},{default:t(()=>e[73]||(e[73]=[u("保存")])),_:1})])]),_:1},8,["modelValue"]),o(ke,{modelValue:S.value,"onUpdate:modelValue":e[39]||(e[39]=l=>S.value=l),size:"90%",title:"",direction:"rtl"},{default:t(()=>[S.value?(r(),g(_l,{key:0,onSubfn:De,isCheck:!0,checkList:O.value},null,8,["checkList"])):x("",!0)]),_:1},8,["modelValue"])],64)}}},Rt=Ge(yt,[["__scopeId","data-v-86b194dc"]]);export{Rt as default};
