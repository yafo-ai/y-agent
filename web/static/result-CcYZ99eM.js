import{r as p,j as ve,I as Y,J as u,B as e,R as n,z as d,a6 as K,Q as I,al as C,L as f,aR as ge,aS as ye,A as a,E as P,P as b,W as z,O as y,l as $e,D as ae,ar as ke,K as D,u as Ce,S as oe}from"./vue-CdYMfVVj.js";import{_ as be,u as xe,l as Te,S as Ae,aL as Se,aM as Ee,R as Pe,E as ze,aN as Ie,aF as je,i as ne,aO as Ne,aP as Be}from"./index-B6WbZO8q.js";const He={class:"drawerbox"},Ye={class:"dtop"},Oe={class:"contextbox"},Le={class:"mg20"},Me={class:"item"},We=["src","title","alt"],Ke=["onClick"],Je={class:"title"},Qe={class:"filename ellipsis"},Xe=["title"],Ge=["innerHTML"],Ze=["onClick"],el={class:"score tl"},ll={class:"c-scorebox"},tl={class:"editorbox"},sl={class:"mg20"},ol={__name:"content",props:{curContext:{type:Array,default:[]},type:{type:String,default:"text"},title:{type:String,default:"引用内容"},modelValue:{type:Boolean,default:!1}},emits:["subfn","update:modelValue"],setup(O,{emit:ie}){const w=O,L=ie;ge(),ye(),xe();const F=p(!1),v=p(null),J=p(null),r=p("1000px");ve(()=>w.modelValue,S=>{F.value=S,S&&(w.type=="img"?(U.value=-1,r.value="800px"):(U.value=0,r.value="1200px"),setTimeout(()=>{document.querySelectorAll(".js-intro").forEach(($,A)=>{$.offsetHeight<$.querySelector(".text").offsetHeight&&($.querySelector(".js-btn").style.cssText="")})},300))});const G=()=>{L("update:modelValue",!1)},c=S=>"c-topicon"+({knowledge_document:1,product_model:2,excel_document:3}[S]||1),i=S=>{if(S.metadata.detali_url)window.open(S.metadata.detali_url);else{let q=S.metadata.knowledgebase_id,$=S.metadata.type,A=S.metadata.ref_real_id,M=S.metadata.ref_id;window.open(`/chat/detail?id=${q}&type=${$}&did=${A}&rid=${M}`)}},U=p(0);return(S,q)=>{const $=C("el-button"),A=C("el-scrollbar"),M=C("v-md-preview"),E=C("el-drawer");return a(),Y(E,{title:O.title,onClosed:G,modelValue:F.value,"onUpdate:modelValue":q[0]||(q[0]=V=>F.value=V),direction:"rtl",size:r.value},{default:u(()=>[e("div",He,[e("div",Ye,[e("div",Oe,[n(A,{ref_key:"scrollbarRef",ref:v},{default:u(()=>[e("div",Le,[O.type=="img"?(a(!0),d(I,{key:0},K(O.curContext,V=>(a(),d("div",Me,[(a(),d("img",{class:"cimg",src:V.link,key:V.link,title:V.desc,alt:V.desc},null,8,We))]))),256)):(a(!0),d(I,{key:1},K(O.curContext,(V,W)=>(a(),d("div",{onClick:Z=>U.value=W,key:V.metadata.knowledgebase_id+"_"+V.ref_real_id+"_"+V.ref_id+"_"+V.metadata.id,class:P(["item",{on:W==U.value}])},[e("div",Je,[e("span",{class:P(c(V.metadata.type))},null,2),e("div",Qe,b(V.metadata.filename),1)]),e("div",{title:V.page_content,class:P(["intro js-intro",{open:V.isOpen}])},[e("div",{innerHTML:V.page_content.replace(/\n/g,"<br>"),class:"text"},null,8,Ge),V.isOpen?f("",!0):(a(),d("span",{key:0,onClick:Z=>{V.isOpen=!0},style:{display:"none"},class:"js-btn"},"展开",8,Ze))],10,Xe),e("div",el,[e("div",ll,b(V.metadata.score||0),1),S.$route.path!="/sharechat"?(a(),Y($,{key:0,size:"small",onClick:z(Z=>i(V),["stop"]),type:"primary"},{default:u(()=>q[1]||(q[1]=[y("查看文档")])),_:2},1032,["onClick"])):f("",!0)])],10,Ke))),128))])]),_:1},512)]),e("div",tl,[n(A,{ref_key:"scrollbarRef1",ref:J},{default:u(()=>[e("div",sl,[U.value>=0?(a(),Y(M,{key:0,text:O.curContext[U.value].page_content},null,8,["text"])):f("",!0)])]),_:1},512)])])])]),_:1},8,["title","modelValue","size"])}}},al=be(ol,[["__scopeId","data-v-adce2eb2"]]),nl={class:"isShowAddDialogBox c-scroll-contain c-addtestdialog dformbox"},il={class:"formbox"},dl={class:"flbox"},ul={style:{margin:"20px",height:"calc(100vh - 184px)"},class:"mg20"},rl={class:"frbox"},cl={style:{margin:"20px",display:"flex","flex-wrap":"wrap"},class:"mg20"},_l={style:{width:"100%"},class:"typelist"},pl=["title"],vl={class:"item"},ml={class:"c-switchbox"},fl={class:"switch"},gl={class:"c-switchbox"},yl={class:"switch"},bl={class:"llmbox"},xl={key:1,class:"anslist"},hl={class:"title"},wl={class:"c-primary-btn"},kl={class:"title"},Vl={key:0,class:"time c-warn-btn"},$l=["onClick"],Cl={class:"dialog-footer"},Tl={__name:"addtestDialog",props:{id:{type:[String,Number],default:()=>0},TEST_TYPE:{type:[String,Number],default:"W"},title:{type:[String,Number],default:()=>""},item:{type:Object,default:()=>({})},curResult:{type:Object,default:()=>({})},modelValue:{type:Boolean,default:!1}},emits:["subfn","update:modelValue"],setup(O,{emit:ie}){const w=O,L=ie;ge(),ye(),xe(),console.log(w,"props");const F=p([]),v=t=>{F.value.length>0||ze({page:1,pagesize:1e4},w.TEST_TYPE).then(o=>{F.value=o||[]})},J=p(!1),r=$e({id:0,cate_id:0,llm_id:void 0,workflow_log_id:"",message_history_id:0,question:"",message_history:"",right_answer:"",note:"",test_standard:void 0,is_marked:!1,is_modified:!1}),G=p("测试用例");ve(()=>w.TEST_TYPE,async(t,o)=>{t!==o&&t&&q(!0),J.value=t}),ve(()=>w.modelValue,async(t,o)=>{t!==o&&t&&(A.value&&A.value.clearValidate(),w.title?G.value=w.title:G.value=w.TEST_TYPE=="W"?"流程测试用例":"单元测试用例",q(),v(),c(w.item),x()),J.value=t});const c=t=>{E.value=[],r.id=t.id||0,r.workflow_node_log_id=t.workflow_node_log_id||void 0,r.cate_id=t.test_cate_id||0,r.message_history_id=t.message_history_id||0,r.message_history=t.message_history||"",r.workflow_log_id=t.workflow_log_id||0,r.question=t.question||"",r.right_answer=t.right_answer||"",r.note=t.note||"",r.is_marked=t.is_marked||!1,r.is_modified=t.is_modified||!1,r.test_standard=t.test_standard||void 0},i=()=>{L("update:modelValue",!1)},U=t=>[{id:0,name:"未分类",color:"#ff0000",pid:null,children:[]}].concat(S.value),S=p([]),q=t=>{S.value.length>0&&!t||Pe({},w.TEST_TYPE).then(async o=>{S.value=o||[]})},$=(t,o,_)=>{t.forEach(g=>{if(g.id===o)return _&&_(g),!0;g.children&&g.children.length>0&&$(g.children,o,_)})},A=p(),M=async t=>{t&&await t.validate((o,_)=>{o&&Ae(r,w.TEST_TYPE).then(g=>{if(g){let B=null;$(U(),r.cate_id,function(Q){B=Q}),L("subfn",{res:g,item:B})}})})},E=p([]),V=()=>{x(r.llm_id);let t=[];E.value=[],Array.isArray(r.llm_id)?t=r.llm_id:t=[r.llm_id],t.forEach(o=>{F.value.forEach(async _=>{_.id==o&&E.value.push(Te.cloneDeep(_))})}),Z()},W=p(0),Z=async()=>{W.value=Date.now();const t=E.value.map((o,_)=>(E.value[_].loading=!0,Se({llm_id:o.id,input:r.question,vision_file_str:w.curResult.vision_file_str}).then(g=>{E.value[_].right_answer=g.answer||"",E.value[_].loading=!1,E.value[_].time=Date.now()}).catch(g=>{console.error("Error in try_answer:",g),E.value[_].loading=!1,E.value[_].time=Date.now()})));await Promise.all(t)},x=t=>{let o=w.TEST_TYPE+"local_llm";if(t)window.localStorage.setItem(o,t.join(","));else{let _=window.localStorage.getItem(o);if(_){let g=[];_.split(",").forEach(B=>{g.push(parseInt(B))}),r.llm_id=g}}};return(t,o)=>{const _=C("el-input"),g=C("el-form-item"),B=C("el-scrollbar"),Q=C("el-tree-select"),de=C("el-switch"),ue=C("el-option"),re=C("el-select"),ee=C("el-button"),ce=C("el-form"),le=C("el-drawer"),k=ke("loading");return a(),Y(le,{modelValue:J.value,"onUpdate:modelValue":o[11]||(o[11]=m=>J.value=m),title:G.value,onClosed:i,direction:"rtl","close-on-click-modal":!0,size:"90%"},{default:u(()=>[e("div",nl,[n(ce,{ref_key:"formRef1",ref:A,model:r,"label-position":"top","label-width":"auto",inline:"",class:"demo-dynamic"},{default:u(()=>[e("div",il,[e("div",dl,[n(B,null,{default:u(()=>[e("div",ul,[n(g,{class:"fulltextarea",style:{margin:"0"},prop:"question",label:"问题",rules:[{required:!0,message:"请填写问题",trigger:"blur"}]},{default:u(()=>[n(_,{modelValue:r.question,"onUpdate:modelValue":o[0]||(o[0]=m=>r.question=m),style:{width:"100%"},rows:33,type:"textarea",placeholder:"请填写问题"},null,8,["modelValue"])]),_:1})])]),_:1})]),e("div",rl,[n(B,null,{default:u(()=>[e("div",cl,[n(g,{style:{width:"calc(33% - 16px)"},prop:"type",label:"测试类别"},{default:u(()=>[e("div",_l,[n(Q,{modelValue:r.cate_id,"onUpdate:modelValue":o[1]||(o[1]=m=>r.cate_id=m),filterable:"","check-strictly":"",props:{children:"children",label:"name",value:"id"},"node-key":"id","popper-class":"c-treebox","default-expand-all":!0,"check-on-click-node":!0,data:U()},{default:u(({node:m,data:H})=>[e("div",{title:H.name,class:"custom-tree-node"},[e("div",vl,[e("span",{class:"c-color radius",style:ae("background-color:"+H.color)},null,4),y(b(H.name),1)])],8,pl)]),_:1},8,["modelValue","data"])])]),_:1}),n(g,{class:"c-switchbox-label",style:{width:"calc(33% - 16px)","margin-right":"16px"},prop:"is_marked",label:"是否审核"},{default:u(()=>[e("div",ml,[o[12]||(o[12]=e("div",{class:"label"},null,-1)),e("div",fl,[n(de,{modelValue:r.is_marked,"onUpdate:modelValue":o[2]||(o[2]=m=>r.is_marked=m),"inline-prompt":"","active-text":"审核","inactive-text":"未审核"},null,8,["modelValue"])])])]),_:1}),n(g,{class:"c-switchbox-label",style:{width:"34%","margin-right":"0"},prop:"is_modified",label:"是否更正"},{default:u(()=>[e("div",gl,[o[13]||(o[13]=e("div",{class:"label"},null,-1)),e("div",yl,[n(de,{modelValue:r.is_modified,"onUpdate:modelValue":o[3]||(o[3]=m=>r.is_modified=m),"inline-prompt":"","active-text":"更正","inactive-text":"未更正"},null,8,["modelValue"])])])]),_:1}),n(g,{style:{width:"100%","margin-right":"0"},prop:"right_answer",class:"js-answer",label:"参考答案",rules:[{required:!0,message:"请填写参考答案",trigger:"blur"}]},{default:u(()=>[n(_,{modelValue:r.right_answer,"onUpdate:modelValue":o[4]||(o[4]=m=>r.right_answer=m),style:{width:"100%"},rows:8,type:"textarea",placeholder:"请填写参考答案"},null,8,["modelValue"])]),_:1}),n(g,{style:{width:"100%","margin-right":"0"},prop:"note",label:"备注"},{default:u(()=>[n(_,{modelValue:r.note,"onUpdate:modelValue":o[5]||(o[5]=m=>r.note=m),style:{width:"100%"},rows:4,type:"textarea",placeholder:"请填写备注"},null,8,["modelValue"])]),_:1}),w.TEST_TYPE=="S"?(a(),Y(g,{key:0,style:{width:"100%","margin-right":"0"},prop:"test_standard",label:"测试标准"},{default:u(()=>[n(_,{modelValue:r.test_standard,"onUpdate:modelValue":o[6]||(o[6]=m=>r.test_standard=m),style:{width:"100%"},rows:4,type:"textarea",placeholder:"请填写测试标准"},null,8,["modelValue"])]),_:1})):f("",!0),n(g,{style:{width:"100%","margin-right":"0"},prop:"",class:"js-answer",label:"视觉文件"},{default:u(()=>[e("div",null,b(w.curResult&&w.curResult.vision_file_str||"无"),1)]),_:1}),n(g,{style:{width:"100%","margin-right":"0"},prop:"llm_id",label:"选择大模型"},{default:u(()=>[n(re,{style:{width:"100%"},modelValue:r.llm_id,"onUpdate:modelValue":o[7]||(o[7]=m=>r.llm_id=m),class:"val",filterable:"",placeholder:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":3},{default:u(()=>[(a(!0),d(I,null,K(F.value,m=>(a(),Y(ue,{value:parseInt(m.id,10),label:m.name},null,8,["value","label"]))),256))]),_:1},8,["modelValue"]),e("div",bl,[o[15]||(o[15]=e("span",{class:"c-tips"},"* 通过大模型辅助生成参考答案",-1)),n(ee,{type:"primary",onClick:o[8]||(o[8]=m=>V()),disabled:!(r.llm_id&&r.question)},{default:u(()=>o[14]||(o[14]=[y("生成参考答案")])),_:1},8,["disabled"])])]),_:1}),E.value&&E.value.length>0?(a(),d("div",xl,[e("div",hl,[o[16]||(o[16]=e("span",{class:"el-form-item__label"},"生成结果",-1)),e("span",wl,b(E.value.length),1)]),(a(!0),d(I,null,K(E.value,(m,H)=>D((a(),d("div",{class:"item",key:H},[e("div",kl,[e("span",null,[y(b(m.name),1),m.time?(a(),d("span",Vl,b(((m.time-W.value)/1e3).toFixed(2))+" s",1)):f("",!0)]),e("span",{onClick:me=>{r.right_answer=m.right_answer,Ce(Ee)(".js-answer")},class:"c-pointer c-flex-center"},o[17]||(o[17]=[e("span",{class:"iconfont icon-xuanzedaan"},null,-1),y(" 选择答案 ")]),8,$l)]),n(_,{modelValue:m.right_answer,"onUpdate:modelValue":me=>m.right_answer=me,style:{width:"100%"},autosize:{minRows:4,maxRows:20},type:"textarea",placeholder:"请填写参考答案"},null,8,["modelValue","onUpdate:modelValue"])])),[[k,m.loading]])),128))])):f("",!0)])]),_:1})])])]),_:1},8,["model"])]),e("div",Cl,[n(ee,{type:"primary",onClick:o[9]||(o[9]=m=>M(A.value))},{default:u(()=>o[18]||(o[18]=[y(" 确定 ")])),_:1}),n(ee,{onClick:o[10]||(o[10]=m=>i()),plain:""},{default:u(()=>o[19]||(o[19]=[y("取消")])),_:1})])]),_:1},8,["modelValue","title"])}}},Sl=be(Tl,[["__scopeId","data-v-eeb4e185"]]),El={class:"isShowAddDialogBox c-scroll-contain c-addtestdialog dformbox"},zl={class:"formbox"},jl={class:"flbox"},ql={style:{margin:"20px",height:"calc(100vh - 184px)"},class:"mg20"},Rl={class:"frbox"},Dl={style:{margin:"20px",display:"flex","flex-wrap":"wrap"},class:"mg20"},Fl={style:{width:"100%"},class:"typelist"},Ul=["title"],Al={class:"item"},Pl={class:"ellipsis"},Il={class:"c-switchbox"},Nl={class:"switch"},Bl={class:"c-switchbox"},Hl={class:"switch"},Yl={class:"llmbox"},Ol={key:1,class:"anslist"},Ll={class:"title"},Ml={class:"c-primary-btn"},Wl={class:"title"},Kl={key:0,class:"time"},Jl=["onClick"],Ql={class:"dialog-footer"},Xl={__name:"addxlDialog",props:{id:{type:[String,Number],default:()=>0},title:{type:[String,Number],default:"测试用例"},TEST_TYPE:{type:[String,Number],default:"W"},item:{type:Object,default:()=>({})},curResult:{type:Object,default:()=>({})},modelValue:{type:Boolean,default:!1}},emits:["subfn","update:modelValue"],setup(O,{emit:ie}){const w=O,L=ie;ge(),ye(),xe();const F=p(!1),v=$e({id:0,train_cate_id:0,input_data:"",output_data:""});ve(()=>w.modelValue,async(x,t)=>{x!==t&&x&&(S.value&&S.value.clearValidate(),i(),W(),J(w.item),Z()),F.value=x});const J=x=>{$.value=[],v.id=x.id||0,v.llm_id=void 0,v.node_id=x.node_id||void 0,v.is_marked=!!x.is_marked,v.is_modified=!!x.is_modified,v.input_data=x.input_data||"",v.output_data=x.output_data||"",v.train_cate_id=x.train_cate_id||0,v.feature=x.feature||void 0},r=()=>{L("update:modelValue",!1)},G=x=>[{id:0,name:"未分类",color:"#ff0000",pid:null,children:[]}].concat(c.value),c=p([]),i=x=>{c.value.length<1&&je({}).then(async t=>{c.value=t||[]})},U=(x,t,o)=>{x.forEach(_=>{if(_.id===t)return o&&o(_),!0;_.children&&_.children.length>0&&U(_.children,t,o)})},S=p(),q=async x=>{x&&await x.validate((t,o)=>{t&&Ie(v).then(_=>{if(_){let g=null;U(G(),v.train_cate_id,function(B){g=B}),L("subfn",{res:_,item:g})}})})},$=p([]),A=()=>{Z(v.llm_id);let x=[];$.value=[],Array.isArray(v.llm_id)?x=v.llm_id:x=[v.llm_id],x.forEach(t=>{V.value.forEach(async o=>{o.id==t&&$.value.push(Te.cloneDeep(o))})}),E()},M=p(0),E=async()=>{M.value=Date.now();const x=$.value.map((t,o)=>($.value[o].loading=!0,Se({llm_id:t.id,input:v.input_data,vision_file_str:w.curResult.vision_file_str}).then(_=>{$.value[o].right_answer=_.answer||"",$.value[o].loading=!1,$.value[o].time=Date.now()}).catch(_=>{console.error("Error in try_answer:",_),$.value[o].loading=!1,$.value[o].time=Date.now()})));await Promise.all(x)},V=p([]),W=()=>{V.value.length>0||ze({page:1,pagesize:1e4},w.TEST_TYPE).then(x=>{V.value=x||[]})},Z=x=>{let t="edulocal_llm";if(x)window.localStorage.setItem(t,x.join(","));else{let o=window.localStorage.getItem(t);if(o){let _=[];o.split(",").forEach(g=>{_.push(parseInt(g))}),v.llm_id=_}}};return(x,t)=>{const o=C("el-input"),_=C("el-form-item"),g=C("el-scrollbar"),B=C("el-tree-select"),Q=C("el-switch"),de=C("el-option"),ue=C("el-select"),re=C("el-button"),ee=C("el-form"),ce=C("el-drawer"),le=ke("loading");return a(),Y(ce,{modelValue:F.value,"onUpdate:modelValue":t[10]||(t[10]=k=>F.value=k),title:O.title,onClosed:r,direction:"rtl","close-on-click-modal":!0,size:"90%"},{default:u(()=>[e("div",El,[n(ee,{ref_key:"formRef1",ref:S,model:v,"label-position":"top","label-width":"auto",inline:"",class:"demo-dynamic"},{default:u(()=>[e("div",zl,[e("div",jl,[n(g,null,{default:u(()=>[e("div",ql,[n(_,{class:"fulltextarea",style:{margin:"0"},prop:"input_data",label:"输入数据",rules:[{required:!1,message:"请填写输入数据",trigger:"blur"}]},{default:u(()=>[n(o,{modelValue:v.input_data,"onUpdate:modelValue":t[0]||(t[0]=k=>v.input_data=k),style:{width:"100%"},rows:36,type:"textarea",placeholder:"请填写输入数据"},null,8,["modelValue"])]),_:1})])]),_:1})]),e("div",Rl,[n(g,null,{default:u(()=>[e("div",Dl,[w.item&&w.item.__isTs__?f("",!0):(a(),d(I,{key:0},[n(_,{style:{width:"calc(33% - 16px)"},prop:"type",label:"语料类别"},{default:u(()=>[e("div",Fl,[n(B,{modelValue:v.train_cate_id,"onUpdate:modelValue":t[1]||(t[1]=k=>v.train_cate_id=k),filterable:"","check-strictly":"",props:{children:"children",label:"name",value:"id"},"node-key":"id","popper-class":"c-treebox","default-expand-all":!0,"check-on-click-node":!0,data:G()},{default:u(({node:k,data:m})=>[e("div",{title:m.name,class:"custom-tree-node"},[e("div",Al,[e("span",{class:"c-color",style:ae("background-color:"+m.color)},null,4),e("p",Pl,b(m.name),1)])],8,Ul)]),_:1},8,["modelValue","data"])])]),_:1}),n(_,{class:"c-switchbox-label",style:{width:"calc(33% - 16px)","margin-right":"16px"},prop:"is_marked",label:"是否审核"},{default:u(()=>[e("div",Il,[t[11]||(t[11]=e("div",{class:"label"},null,-1)),e("div",Nl,[n(Q,{modelValue:v.is_marked,"onUpdate:modelValue":t[2]||(t[2]=k=>v.is_marked=k),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])])])]),_:1}),n(_,{class:"c-switchbox-label",style:{width:"34%","margin-right":"0"},prop:"is_modified",label:"是否更正"},{default:u(()=>[e("div",Bl,[t[12]||(t[12]=e("div",{class:"label"},null,-1)),e("div",Hl,[n(Q,{modelValue:v.is_modified,"onUpdate:modelValue":t[3]||(t[3]=k=>v.is_modified=k),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])])])]),_:1}),n(_,{style:{width:"100%","margin-right":"0"},prop:"output_data",class:"js-answer",label:"输出数据",rules:[{required:!1,message:"请填写输出数据",trigger:"blur"}]},{default:u(()=>[n(o,{modelValue:v.output_data,"onUpdate:modelValue":t[4]||(t[4]=k=>v.output_data=k),style:{width:"100%"},rows:10,type:"textarea",placeholder:"请填写输出数据"},null,8,["modelValue"])]),_:1}),n(_,{style:{width:"100%","margin-right":"0"},rules:[{required:!0,message:"请填写特征概要",trigger:"blur"}],prop:"feature",label:"特征概要"},{default:u(()=>[n(o,{modelValue:v.feature,"onUpdate:modelValue":t[5]||(t[5]=k=>v.feature=k),style:{width:"100%"},rows:5,type:"textarea",placeholder:"请填写特征概要"},null,8,["modelValue"])]),_:1})],64)),n(_,{style:{width:"100%","margin-right":"0"},prop:"",class:"js-answer",label:"视觉文件"},{default:u(()=>[e("div",null,b(w.curResult&&w.curResult.vision_file_str||"无"),1)]),_:1}),n(_,{style:{width:"100%","margin-right":"0"},prop:"llm_id",label:"选择大模型"},{default:u(()=>[n(ue,{style:{width:"100%"},modelValue:v.llm_id,"onUpdate:modelValue":t[6]||(t[6]=k=>v.llm_id=k),class:"val",filterable:"",placeholder:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":3},{default:u(()=>[(a(!0),d(I,null,K(V.value,k=>(a(),Y(de,{value:parseInt(k.id,10),label:k.name},null,8,["value","label"]))),256))]),_:1},8,["modelValue"]),e("div",Yl,[t[14]||(t[14]=e("span",{class:"c-tips"},"* 通过选择的大模型生成参考输出",-1)),n(re,{type:"primary",onClick:t[7]||(t[7]=k=>A()),disabled:!(v.llm_id&&v.input_data),size:"small"},{default:u(()=>t[13]||(t[13]=[y("生成参考输出")])),_:1},8,["disabled"])])]),_:1}),$.value&&$.value.length>0?(a(),d("div",Ol,[e("div",Ll,[t[15]||(t[15]=e("span",{class:"el-form-item__label"},"生成结果",-1)),e("span",Ml,b($.value.length),1)]),(a(!0),d(I,null,K($.value,(k,m)=>D((a(),d("div",{class:"item",key:m},[e("div",Wl,[e("span",null,[y(b(k.name),1),k.time?(a(),d("span",Kl,"("+b(((k.time-M.value)/1e3).toFixed(2))+" s)",1)):f("",!0)]),e("span",{onClick:H=>{v.output_data=k.right_answer,Ce(Ee)(".js-answer")},class:"c-pointer c-flex-center"},t[16]||(t[16]=[e("span",{class:"iconfont icon-xuanzedaan"},null,-1),y(" 选择答案 ")]),8,Jl)]),n(o,{modelValue:k.right_answer,"onUpdate:modelValue":H=>k.right_answer=H,style:{width:"100%"},autosize:{minRows:4,maxRows:20},type:"textarea",placeholder:"请填写参考答案"},null,8,["modelValue","onUpdate:modelValue"])])),[[le,k.loading]])),128))])):f("",!0)])]),_:1})])])]),_:1},8,["model"])]),e("div",Ql,[n(re,{plain:"",onClick:t[8]||(t[8]=k=>r())},{default:u(()=>t[17]||(t[17]=[y("取消")])),_:1}),w.item&&w.item.__isTs__?f("",!0):(a(),Y(re,{key:0,type:"primary",onClick:t[9]||(t[9]=k=>q(S.value))},{default:u(()=>t[18]||(t[18]=[y(" 确定 ")])),_:1}))])]),_:1},8,["modelValue","title"])}}},Gl=be(Xl,[["__scopeId","data-v-37866f3e"]]),Zl={class:"titlebox"},et={class:"title"},lt={class:"lbox ellipsis"},tt={class:"rbox"},st={class:"dotbox"},ot={class:"dotcontentbox c-scroll-contain"},at={key:0,class:"items"},nt={class:"rtopbox"},it=["title"],dt={style:{"font-weight":"bold"}},ut={key:0,class:"nodeid"},rt={class:"runner_run_times ritem"},ct={class:"ritem c-warn-btn"},_t={key:0,class:"ritem c-primary-btn",style:{"max-width":"100px"}},pt=["title"],vt={key:1,class:"topbtn"},mt={class:"dotbox"},ft={class:"dotcontentbox c-scroll-contain"},gt={key:0,class:"title"},yt={key:1,class:"items"},bt={key:2,class:"title"},xt={key:3,class:"items"},ht={class:"item ellipsis"},wt={class:"resultbody"},kt={key:0,class:"resultDialogbox"},Vt={class:"resultDialog"},$t={class:"resultDialogitem"},Ct={class:"contbox"},Tt={class:"mr20"},St={key:0,class:"cardbox"},Et={class:"ltitlebox"},zt={class:"rbox"},jt={class:"resultDialogitem"},qt={class:"contbox"},Rt={class:"mr20"},Dt={key:0,class:"cardbox dqjdsc"},Ft={class:"ltitlebox"},Ut={class:"rbox"},At={key:1,class:"cardbox hsfhz"},Pt={class:"ltitlebox"},It={style:{padding:"0"},class:"rbox"},Nt={key:2,class:"cardbox qjgzbl"},Bt={class:"ltitlebox"},Ht={style:{padding:"0"},class:"rbox"},Yt={key:3,class:"cardbox dqjdbl"},Ot={class:"ltitlebox"},Lt={style:{padding:"0"},class:"rbox"},Mt={key:4,class:"cardbox ltsxx"},Wt={class:"ltitlebox"},Kt={style:{padding:"0"},class:"rbox"},Jt={class:"resultbox"},Qt={class:"mr20"},Xt={class:"ltitlebox"},Gt={style:{padding:"0",overflow:"hidden"},class:"cardbox"},Zt={class:"ltitlebox"},es={class:"c-copybox"},ls={class:"cardbox human_messages"},ts={key:0,class:"c-empty",style:{"text-align":"left"}},ss={class:"item"},os={class:"mestimebox"},as={class:"rolebox"},ns={class:"c-warn-btn radius",style:{"font-weight":"normal","margin-left":"8px"}},is={class:"c-danger"},ds={style:{margin:"0 -20px"}},us=["innerHTML"],rs={key:1,class:"c-danger"},cs={class:"message"},_s={class:"time"},ps={class:"timebox node_logbox"},vs={class:"timeline"},ms={class:"titem"},fs={class:"titem"},gs={class:"titem"},ys={class:"titem"},bs={class:"titem"},xs={class:"timecontain"},hs=["onClick"],ws={key:0,class:"toolbox"},ks={class:"nameitem"},Vs={style:{display:"inline-block"},class:"ellipsis"},$s=["onClick"],Cs={key:1,style:{opacity:"0.8","font-size":"12px"}},Ts={key:0,style:{opacity:"0.8","font-size":"12px",display:"inline-block"},class:"ellipsis"},Ss={class:"nodebox"},Es={class:"name"},zs={class:"time"},js={key:0,class:"c-primary-btn type"},qs={key:2,class:"c-danger",style:{padding:"20px 0"}},Rs={__name:"result",props:{id:{type:[String,Number],default:()=>0},nodeid:{type:[String,Number],default:()=>""},title:{type:[String,Number],default:"新建文件夹"},data:{type:Object,default:{}},modelValue:{type:Boolean,default:!1}},emits:["subfn","update:modelValue","change","btnclose"],setup(O,{emit:ie}){const w=O,L=ie;ge(),ye(),xe();const F=p(!1),v=p([{id:0,name:"未分类",color:"#ff0000",pid:null,children:[]}]);ve(()=>w.modelValue,async(h,l)=>{h!==l&&h&&(he.value=-1,v.value.length<=1&&await je().then(j=>{v.value=[{id:0,name:"未分类",color:"#ff0000",pid:null,children:[]}].concat(j)}),Z(w.data))});const J=()=>{L("update:modelValue",!1)},r=h=>{console.log(h),V.value="90%",window.innerWidth>2200&&(V.value="2000px"),window.innerWidth<1400&&(V.value="100%"),U.value=!0,S.value=!0,q.value=!0,$.value=!0,A.value=!0,G.value=!0,i.value=h},G=p(!1),c=p({}),i=p(null),U=p(!0),S=p(!0),q=p(!0),$=p(!0),A=p(!0),M=p(!0),E=p(!0),V=p("760px"),W=p(""),Z=async h=>{let l=null;if(h.id===void 0)l=h;else{try{l=await Ne({id:h.id})}catch(j){console.error("获取详情失败:",j),J();return}l.question_id&&(await Be({question_id:l.question_id})).forEach(T=>{l.human_messages.forEach(R=>{R.id==T.answer_id&&(R.score=T.score,T.score===5&&(R.amend_answer=T.amend_answer))})})}if(!l||Object.keys(l).length<1){_this.$message("获取数据失败","error"),J();return}c.value=l,i.value=null,V.value="760px",_(),F.value=!0,w.nodeid&&c.value.node_log&&c.value.node_log.forEach(j=>{j.detail_id==w.nodeid&&r(j)})},x=p(0),t=p(0),o=p(0),_=()=>{let h=c.value.node_log||[],l=0,j=0;h.forEach(T=>{let R=new Date(T.start_time).getTime(),N=new Date(T.end_time).getTime();(l==0||R<l)&&(l=R),N>j&&(j=N),T.mintime=R/1e3,T.maxtime=N/1e3,T.curtime=parseFloat(T.duration)}),h.forEach(T=>{let R=new Date(T.end_time).getTime();T.alltime=(R-l)/1e3}),c.value.human_messages&&c.value.human_messages.forEach(T=>{let R=new Date(T.send_time).getTime();T.alltime=(R-l)/1e3}),x.value=(j-l)/1e3,t.value=j/1e3,o.value=l/1e3},g={},B=(h,l,j)=>{let T={},R=((h.mintime-o.value)/(t.value-o.value)*100).toFixed(2);if(l=="namebox"){let N=5;h.runner&&h.runner.length>5&&(N=h.runner.length);let te=(1-18*N/720)*100;R<=te?T={left:R+"%"}:T={right:"0%"}}else{let N=["199, 246, 156","242, 217, 117","246, 138, 185","206, 155, 243","175, 214, 237","190, 242, 220","217, 249, 199","249, 222, 199","243, 161, 221","170, 161, 243","161, 205, 243","161, 243, 225","161, 243, 176","209, 241, 174","241, 233, 174"];if(!g[h.runner]){let pe=-1;N.forEach((X,s)=>{let se=!0;for(const we in g){const Ue=g[we];X==Ue&&(se=!1)}se&&(pe=s,g[h.runner]=X)}),pe==-1?g[h.runner]=N[Math.floor(Math.random()*N.length)]:g[h.runner]=N[pe]}let te=(h.curtime/x.value*100).toFixed(2);T={left:R+"%",width:te+"%",background:"rgba("+g[h.runner]+", 1)"}}return T},Q=h=>(x.value*h).toFixed(1),de=p([]),ue=p(!1),re=h=>{de.value=h.citations.map(l=>({...l,isOpen:!1})),ue.value=!0},ee=p("添加到语料"),ce=p({}),le=p(!1),k=()=>{ee.value="添加到语料",ce.value={train_cate_id:v.value[0].id||0,node_id:i.value.detail_id||void 0,output_data:i.value.response_content||"",input_data:i.value.prompt_str||"",feature:i.value.inputs.user_input,is_modified:!1},le.value=!0},m=p({}),H=p(!1),me=()=>{_e.value="S",m.value={workflow_node_log_id:i.value.detail_id||void 0,right_answer:i.value.response_content,question:i.value.prompt_str},H.value=!0},_e=p("S"),qe=()=>{_e.value="W",m.value={workflow_log_id:c.value.id,right_answer:c.value.output.join(`
`),question:c.value.user_input},H.value=!0},Re=h=>{_this.$message("添加成功"),H.value=!1,_e.value=="S"?(i.value.unit_cate||(i.value.unit_cate=[]),i.value.unit_cate.push(h.item)):_e.value=="W"&&(c.value.test_cates||(c.value.test_cates=[]),c.value.test_cates.push(h.item)),L("change",c.value)},De=async h=>{_this.$message("添加成功"),le.value=!1,i.value.cate.push(h.item),L("change",c.value)},fe=p(!0),he=p(-1),Fe=()=>{let h=i.value.unit_cate||[],l=i.value.cate||[];return l.forEach((j,T)=>{j.xl=!0}),l.concat(h)},Ve=h=>({tool:"工具",llm:"大模型",loop:"分批处理",temp_executor:"执行器"})[h]||"";return(h,l)=>{const j=C("el-popover"),T=C("el-button"),R=C("v-md-preview"),N=C("el-scrollbar"),te=C("json-viewer"),pe=C("el-drawer"),X=ke("copy");return a(),d(I,null,[n(pe,{modelValue:F.value,"onUpdate:modelValue":l[22]||(l[22]=s=>F.value=s),"with-header":!1,onClosed:J,"close-on-click-modal":!0,size:V.value,title:"试运行",direction:"rtl"},{default:u(()=>[e("div",{class:P([{on:i.value&&i.value.runner},"testbox"])},[e("div",Zl,[e("div",et,[e("div",lt," id:"+b(c.value.id)+" 的运行结果（ "+b(c.value&&c.value.flow_name)+" ） ",1),e("div",tt,[c.value.test_cates&&c.value.test_cates.some(s=>s&&s.tag!="S")?(a(),Y(j,{key:0,placement:"bottom",width:200,trigger:"hover"},{reference:u(()=>[e("div",st,[(a(!0),d(I,null,K(c.value.test_cates.filter(s=>s&&s.tag!="S"),(s,se)=>(a(),d("span",{class:P(["dot",{on:s.xl}]),style:ae("background-color: "+s.color+"; right: "+se*5+"px")},null,6))),256))])]),default:u(()=>[e("div",ot,[l[26]||(l[26]=e("div",{class:"title"}," 流程测试 ",-1)),c.value.test_cates&&c.value.test_cates.some(s=>s&&s.tag!="S")?(a(),d("div",at,[(a(!0),d(I,null,K(c.value.test_cates.filter(s=>s&&s.tag!="S"),s=>(a(),d("div",{class:P([{unit:s.tag=="S"},"item ellipsis"])},[e("span",{class:"c-color radius",style:ae("background-color:"+s.color)},null,4),y(" "+b(s.name),1)],2))),256))])):f("",!0)])]),_:1})):f("",!0),n(T,{onClick:l[0]||(l[0]=s=>qe()),style:{"margin-left":"10px"},plain:"",class:"on"},{default:u(()=>l[27]||(l[27]=[e("span",{style:{"margin-left":"0","font-size":"18px"},class:"iconfont icon-a-liuchengceshi-weixuanzhong-caidanicon2"},null,-1),y(" 添加到流程测试")])),_:1}),e("span",{onClick:l[1]||(l[1]=z(s=>{L("btnclose"),F.value=!1},["stop"])),class:"iconfont icon-guanbi"})])]),e("div",nt,[c.value.__isShowBtn__?(a(),Y(T,{key:0,onClick:l[2]||(l[2]=z(s=>{L("btnclose",1),F.value=!1},["stop"])),size:"small",type:"primary"},{default:u(()=>l[28]||(l[28]=[y("重新输入")])),_:1})):f("",!0),i.value&&i.value.runner?(a(),d(I,{key:1},[e("div",{title:i.value.runner,class:"runner ellipsis"},[e("span",dt,"【 "+b(i.value.runner)+" 】",1),i.value.runner_Id?(a(),d("span",ut,"id: "+b(i.value.runner_Id),1)):f("",!0)],8,it),e("div",rt," 第"+b(i.value.runner_run_times)+"次 ",1),e("div",ct,b(i.value.duration)+"s",1),i.value.model_name?(a(),d("div",_t,[e("p",{style:{padding:"0"},title:i.value.model_name,class:"ellipsis"},b(i.value.model_name),9,pt)])):f("",!0),i.value.prompt_str&&i.value.detail_id?(a(),d("div",vt,[n(T,{style:{"margin-left":"16px"},onClick:l[3]||(l[3]=s=>k()),size:"small",plain:""},{default:u(()=>l[29]||(l[29]=[y("添加到语料")])),_:1}),n(T,{onClick:l[4]||(l[4]=s=>me()),size:"small",plain:""},{default:u(()=>l[30]||(l[30]=[y("添加到单元测试")])),_:1})])):f("",!0),c.value.__isShowBtn__?(a(),Y(T,{key:2,style:{"margin-left":"16px"},size:"small",onClick:l[5]||(l[5]=z(s=>{ee.value="调试节点",ce.value={input_data:i.value.prompt_str||"",__isTs__:!0},le.value=!0},["stop"])),plain:""},{default:u(()=>l[31]||(l[31]=[y("调试")])),_:1})):f("",!0),i.value.cate&&i.value.cate.length>0||i.value.unit_cate&&i.value.unit_cate.length>0?(a(),Y(j,{key:3,placement:"bottom",width:200,trigger:"hover"},{reference:u(()=>[e("div",mt,[(a(!0),d(I,null,K(Fe(),(s,se)=>(a(),d("span",{class:P(["dot",{on:s.xl}]),style:ae("background-color: "+s.color+"; left: "+se*5+"px")},null,6))),256))])]),default:u(()=>[e("div",ft,[i.value.unit_cate.length>0?(a(),d("div",gt," 单元测试 ")):f("",!0),i.value.unit_cate.length>0?(a(),d("div",yt,[(a(!0),d(I,null,K(i.value.unit_cate,s=>(a(),d("div",{class:P([{unit:s.tag=="S"},"item ellipsis"])},[e("span",{class:"c-color radius",style:ae("background-color:"+s.color)},null,4),y(" "+b(s.name),1)],2))),256))])):f("",!0),i.value.cate&&i.value.cate.length>0?(a(),d("div",bt,"语料类型")):f("",!0),i.value.cate&&i.value.cate.length>0?(a(),d("div",xt,[(a(!0),d(I,null,K(i.value.cate,s=>(a(),d("div",ht,[e("span",{class:"c-color",style:ae("background-color:"+s.color)},null,4),y(" "+b(s.name),1)]))),256))])):f("",!0)])]),_:1})):f("",!0)],64)):f("",!0)])]),e("div",wt,[i.value&&i.value.runner?(a(),d("div",kt,[e("div",Vt,[e("div",$t,[l[34]||(l[34]=e("div",{class:"topbtn"},null,-1)),e("div",Ct,[n(N,null,{default:u(()=>[e("div",Tt,[i.value.prompt_str?(a(),d("div",St,[e("div",Et,[e("div",{onClick:l[6]||(l[6]=z(s=>U.value=!U.value,["stop"])),class:"ltitle"},[n(ne,{type:"shuru1"}),e("span",{class:P([{off:U.value},"iconfont icon-xiajiantou pointer"])},null,2),l[32]||(l[32]=y("当前节点输入 "))]),D((a(),d("div",{onClick:l[7]||(l[7]=z(()=>{},["stop"])),style:{color:"#333"},class:"c-copybox"},l[33]||(l[33]=[e("span",{class:"iconfont icon-chakanxiangqing-fuzhidaima"},null,-1),y(" 复制代码 ")]))),[[X,i.value.prompt_str]])]),D(e("div",zt,[n(R,{text:i.value.prompt_str},null,8,["text"])],512),[[oe,U.value]])])):f("",!0)])]),_:1})])]),e("div",jt,[l[45]||(l[45]=e("div",{class:"topbtn"},null,-1)),e("div",qt,[n(N,null,{default:u(()=>[e("div",Rt,[i.value.response_content?(a(),d("div",Dt,[e("div",Ft,[e("div",{onClick:l[8]||(l[8]=z(s=>S.value=!S.value,["stop"])),class:"ltitle"},[n(ne,{type:"shuchu1"}),e("span",{class:P([{off:S.value},"iconfont icon-xiajiantou pointer"])},null,2),l[35]||(l[35]=y("当前节点输出 "))]),D((a(),d("div",{onClick:l[9]||(l[9]=z(()=>{},["stop"])),class:"c-copybox"},l[36]||(l[36]=[e("span",{class:"iconfont icon-chakanxiangqing-fuzhidaima"},null,-1),y(" 复制代码 ")]))),[[X,i.value.response_content]])]),D(e("div",Ut,[n(R,{text:i.value.response_content},null,8,["text"])],512),[[oe,S.value]])])):f("",!0),i.value.function_calls?(a(),d("div",At,[e("div",Pt,[e("div",{onClick:l[10]||(l[10]=z(s=>q.value=!q.value,["stop"])),class:"ltitle"},[n(ne,{type:"hsfhz"}),e("span",{class:P([{off:q.value},"iconfont icon-xiajiantou pointer"])},null,2),l[37]||(l[37]=y("工具函数返回值 "))]),D((a(),d("div",{onClick:l[11]||(l[11]=z(()=>{},["stop"])),class:"c-copybox"},l[38]||(l[38]=[e("span",{class:"iconfont icon-chakanxiangqing-fuzhidaima"},null,-1),y(" 复制代码 ")]))),[[X,i.value.function_calls]])]),D(e("div",It,[n(te,{"show-array-index":!0,sort:"","expand-depth":2,value:i.value.function_calls},null,8,["value"])],512),[[oe,q.value]])])):f("",!0),i.value.variables?(a(),d("div",Nt,[e("div",Bt,[e("div",{onClick:l[12]||(l[12]=z(s=>$.value=!$.value,["stop"])),class:"ltitle"},[n(ne,{type:"qjgzbl"}),e("span",{class:P([{off:$.value},"iconfont icon-xiajiantou pointer"])},null,2),l[39]||(l[39]=y("全局工作空间变量 "))]),D((a(),d("div",{onClick:l[13]||(l[13]=z(()=>{},["stop"])),class:"c-copybox"},l[40]||(l[40]=[e("span",{class:"iconfont icon-chakanxiangqing-fuzhidaima"},null,-1),y(" 复制代码 ")]))),[[X,i.value.variables]])]),D(e("div",Ht,[n(te,{"show-array-index":!0,sort:"","expand-depth":2,value:i.value.variables},null,8,["value"])],512),[[oe,$.value]])])):f("",!0),i.value.role_variables?(a(),d("div",Yt,[e("div",Ot,[e("div",{onClick:l[14]||(l[14]=z(s=>fe.value=!fe.value,["stop"])),class:"ltitle"},[n(ne,{type:"dqjdbl"}),e("span",{class:P([{off:fe.value},"iconfont icon-xiajiantou pointer"])},null,2),l[41]||(l[41]=y("当前节点变量 "))]),D((a(),d("div",{onClick:l[15]||(l[15]=z(()=>{},["stop"])),class:"c-copybox"},l[42]||(l[42]=[e("span",{class:"iconfont icon-chakanxiangqing-fuzhidaima"},null,-1),y(" 复制代码 ")]))),[[X,i.value.role_variables]])]),D(e("div",Lt,[n(te,{"show-array-index":!0,sort:"","expand-depth":2,value:i.value.role_variables},null,8,["value"])],512),[[oe,fe.value]])])):f("",!0),i.value.room_messages?(a(),d("div",Mt,[e("div",Wt,[e("div",{onClick:l[16]||(l[16]=z(s=>A.value=!A.value,["stop"])),class:"ltitle"},[n(ne,{type:"ltsxx"}),e("span",{class:P([{off:A.value},"iconfont icon-xiajiantou pointer"])},null,2),l[43]||(l[43]=y("聊天室消息 "))]),D((a(),d("div",{onClick:l[17]||(l[17]=z(()=>{},["stop"])),class:"c-copybox"},l[44]||(l[44]=[e("span",{class:"iconfont icon-chakanxiangqing-fuzhidaima"},null,-1),y(" 复制代码 ")]))),[[X,i.value.room_messages]])]),D(e("div",Kt,[n(te,{"show-array-index":!0,sort:"","expand-depth":2,value:i.value.room_messages},null,8,["value"])],512),[[oe,A.value]])])):f("",!0)])]),_:1})])])])])):f("",!0),e("div",Jt,[n(N,null,{default:u(()=>[e("div",Qt,[c.value&&c.value.inputs?(a(),d(I,{key:0},[e("div",Xt,[e("div",{onClick:l[18]||(l[18]=z(s=>M.value=!M.value,["stop"])),class:"ltitle"},[n(ne,{width:"32",height:"32",type:"shuru"}),e("span",{class:P([{off:M.value},"iconfont icon-xiajiantou pointer"])},null,2),l[46]||(l[46]=y(" 输入 "))]),D((a(),d("div",{onClick:l[19]||(l[19]=z(()=>{},["stop"])),class:"c-copybox"},l[47]||(l[47]=[e("span",{class:"iconfont icon-chakanxiangqing-fuzhidaima"},null,-1),y(" 复制代码 ")]))),[[X,c.value.inputs]])]),D(e("div",Gt,[n(te,{"show-array-index":!0,sort:"","expand-depth":2,value:c.value.inputs},null,8,["value"])],512),[[oe,M.value]])],64)):f("",!0),c.value&&c.value.human_messages?(a(),d(I,{key:1},[e("div",Zt,[e("div",{onClick:l[21]||(l[21]=z(s=>E.value=!E.value,["stop"])),class:"ltitle"},[n(ne,{width:"32",height:"32",type:"shuchu"}),e("span",{class:P([{off:E.value},"iconfont icon-xiajiantou pointer"])},null,2),l[48]||(l[48]=y("输出 ")),c.value.citations&&c.value.citations.length>0?(a(),d("span",{key:0,onClick:l[20]||(l[20]=z(s=>re(c.value),["stop"])),class:"c-primary pointer citations"}," ["+b(c.value.citations.length)+"条引用] ",1)):f("",!0)]),D((a(),d("div",es,l[49]||(l[49]=[e("span",{class:"iconfont icon-chakanxiangqing-fuzhidaima"},null,-1),y(" 复制代码 ")]))),[[X,c.value.human_messages]])]),D(e("div",ls,[!c.value.human_messages||c.value.human_messages.length<1?(a(),d("div",ts,l[50]||(l[50]=[y(" 抱歉：目前没有任何输出 "),e("br",null,null,-1)]))):f("",!0),(a(!0),d(I,null,K(c.value.human_messages,s=>(a(),d("div",ss,[e("div",os,[e("div",as,[y(b(s.from_role)+" ",1),e("span",ns,b(s.alltime.toFixed(2)+"s"),1),(s.score||s.score===0)&&s.amend_answer?(a(),Y(j,{key:0,placement:"right",width:400,trigger:"hover"},{reference:u(()=>[e("span",is,"（"+b(s.score)+"分）",1)]),default:u(()=>[e("div",ds,[n(N,{"max-height":"400"},{default:u(()=>[e("div",{innerHTML:s.amend_answer,style:{margin:"0 20px"}},null,8,us)]),_:2},1024)])]),_:2},1024)):f("",!0),(s.score||s.score===0)&&!s.amend_answer?(a(),d("span",rs,"（"+b(s.score)+"分）",1)):f("",!0)])]),e("div",cs,[n(R,{text:s.message},null,8,["text"])]),e("div",_s,b(s.send_time?s.send_time.split(".")[0]:""),1)]))),256))],512),[[oe,E.value]])],64)):f("",!0),e("div",ps,[l[53]||(l[53]=e("div",{class:"bgline"},null,-1)),l[54]||(l[54]=e("div",{class:"bgline"},null,-1)),l[55]||(l[55]=e("div",{class:"bgline"},null,-1)),l[56]||(l[56]=e("div",{class:"bgline"},null,-1)),l[57]||(l[57]=e("div",{class:"bgline"},null,-1)),l[58]||(l[58]=e("div",{class:"bgline"},null,-1)),l[59]||(l[59]=e("div",{class:"bgc"},null,-1)),l[60]||(l[60]=e("div",{class:"bgc"},null,-1)),l[61]||(l[61]=e("div",{class:"bgc"},null,-1)),l[62]||(l[62]=e("div",{class:"bgc"},null,-1)),l[63]||(l[63]=e("div",{class:"bgc"},null,-1)),l[64]||(l[64]=e("div",{class:"bgc"},null,-1)),e("div",vs,[l[51]||(l[51]=e("div",{class:"titem"},"0s",-1)),e("div",ms,b(Q(.2))+"s",1),e("div",fs,b(Q(.4))+"s",1),e("div",gs,b(Q(.6))+"s",1),e("div",ys,b(Q(.8))+"s",1),e("div",bs,b(x.value.toFixed(2))+"s",1)]),e("div",xs,[(a(!0),d(I,null,K(c.value.node_log,(s,se)=>D((a(),d("div",{onClick:we=>{r(s),he.value=se},class:P([{is_section_sub:s.is_section_sub,checked:he.value==se},"titem"])},[e("div",{style:ae(B(s,"process")),class:"process"},[s.runner_type=="tool"?(a(),d("span",ws)):f("",!0)],4),e("div",{style:ae(B(s,"namebox")),class:"namebox"},[n(j,{"show-after":1e3,placement:"right","popper-style":{width:"auto",padding:"10px",minWidth:"80px"},trigger:"hover"},{reference:u(()=>[e("div",ks,[e("p",Vs,[s.is_section?(a(),d("span",{key:0,onClick:z(we=>W.value==s.id?W.value="":W.value=s.id,["stop"]),class:P(["iconfont icon-xiajiantou opensection pointer",{on:W.value==s.id}])},null,10,$s)):f("",!0),y(" "+b(s.runner)+" ",1),s.is_section_sub?(a(),d("span",Cs,"（"+b(parseFloat(s.duration).toFixed(2)+"/"+parseFloat(s.alltime).toFixed(2)+"s")+"）",1)):f("",!0)]),l[52]||(l[52]=e("br",null,null,-1)),s.is_section_sub?f("",!0):(a(),d("p",Ts,b(parseFloat(s.duration).toFixed(2)+"/"+parseFloat(s.alltime).toFixed(2)+"s"),1))])]),default:u(()=>[e("div",Ss,[e("div",null,[e("div",Es,b(s.runner),1),e("div",zs,b(parseFloat(s.duration).toFixed(2)+"/"+parseFloat(s.alltime).toFixed(2)+"s"),1)]),Ve(s.runner_type)?(a(),d("span",js,b(Ve(s.runner_type)),1)):f("",!0)])]),_:2},1024)],4)],10,hs)),[[oe,!s.is_section_sub||s.pid==W.value]])),256))])]),c.value.error_msg?(a(),d("div",qs,[l[65]||(l[65]=y(" 错误提示：")),l[66]||(l[66]=e("br",null,null,-1)),y(b(c.value.error_msg),1)])):f("",!0)])]),_:1})])])],2)]),_:1},8,["modelValue","size"]),n(al,{title:"引用内容",curContext:de.value,modelValue:ue.value,"onUpdate:modelValue":l[23]||(l[23]=s=>ue.value=s)},null,8,["curContext","modelValue"]),n(Gl,{modelValue:le.value,"onUpdate:modelValue":l[24]||(l[24]=s=>le.value=s),curResult:i.value,item:ce.value,title:ee.value,onSubfn:De},null,8,["modelValue","curResult","item","title"]),n(Sl,{modelValue:H.value,"onUpdate:modelValue":l[25]||(l[25]=s=>H.value=s),TEST_TYPE:_e.value,curResult:i.value,item:m.value,onSubfn:Re},null,8,["modelValue","TEST_TYPE","curResult","item"])],64)}}},Us=be(Rs,[["__scopeId","data-v-c46fc6e4"]]);export{Sl as a,Gl as b,al as c,Us as r};
