import{r as c,aR as at,l as pe,z as p,B as a,R as l,O as d,L as m,u,P as h,J as s,al as v,K as Ve,Q as I,aS as ot,n as Te,ar as $e,A as i,E as nt,D as ce,W,I as V,a6 as G}from"./vue-CdYMfVVj.js";import{_ as it,c as Se,E as rt,H as dt,u as ut,d as pt,ap as ct,av as _t,R as mt,aw as ft,aq as vt,i as gt,ar as bt,Q as wt,as as ht,at as yt,l as kt,au as xt}from"./index-B6WbZO8q.js";import{a as Ct,r as Vt}from"./result-CcYZ99eM.js";import{a as ze}from"./comp-ClzPtuSi.js";import{C as Tt}from"./list-BbxMWpnt.js";import{C as $t}from"./changeTree-DT6Je88Y.js";import St from"./logdetail-BpmCFm-r.js";import"./element-GwJlJi_X.js";import"./editor-Dhn2M38E.js";import"./editor.api-_A1huWdg.js";import"./list.vue_vue_type_style_index_1_lang-B8pmpZgU.js";const zt={class:"pagelistbox"},qt={class:"c-titlebox"},Ut={class:"title"},Et={key:0,style:{"font-size":"18px",color:"#999"}},Lt={class:"c-bodybox"},Rt={class:"catebox leftbox"},Mt={class:"topbtns"},Dt={class:"treebox contain"},Ht={class:"el-tree el-tree--highlight-current",role:"tree",style:{width:"100%"}},It={class:"el-tree-node__content",style:{"padding-left":"0px"}},jt=["title"],Nt={class:"item"},Ot={class:"ellipsis"},Bt={class:"btns"},Pt=["onClick"],At=["onClick"],Jt=["onClick"],Kt={class:"botbtns"},Yt={class:"c-tablebox tableboxContain c-tooltip rightbox"},Ft={style:{"margin-left":"24px","margin-right":"24px"},class:"c-top-searchbox c-js-item"},Qt={class:"rbox"},Wt={class:"topbtns tl c-js-item"},Gt={class:"btns"},Xt={class:"bodybox c-js-body"},Zt={class:"contain"},el={class:"dotbox"},tl={class:"dotcontentbox c-scroll-contain"},ll={key:0,class:"title"},sl={key:1,class:"items"},al={class:"item ellipsis"},ol={class:"c-color-aaa c-pointer"},nl={class:"ellipsis2"},il={style:{margin:"0 -20px"}},rl=["innerHTML"],dl={class:"ellipsis2"},ul={style:{margin:"0 -20px"}},pl=["innerHTML"],cl={class:"ellipsis2"},_l={style:{margin:"0 -20px"}},ml=["innerHTML"],fl={class:"ellipsis"},vl={style:{margin:"0 -20px"}},gl=["innerHTML"],bl={class:"ellipsis"},wl={style:{margin:"0 -20px"}},hl=["innerHTML"],yl={key:0,class:"c-success-btn"},kl={key:1,class:"c-plain-btn"},xl={key:2,class:"c-danger-btn"},Cl={key:0,class:"c-success-btn"},Vl={key:1,class:"c-primary-btn"},Tl={key:2,class:"c-plain-btn"},$l=["onClick"],Sl={key:0,class:"c-success-btn"},zl={key:1,class:"c-plain-btn"},ql={key:0,class:"c-success-btn"},Ul={key:1,class:"c-plain-btn"},El=["onClick"],Ll=["onClick"],Rl=["onClick"],Ml=["onClick"],Dl={class:"c-emptybox"},Hl={key:0,class:"c-pagination"},Il={class:"dialog-footer"},jl={key:0},Nl={key:1,class:"placeholder"},Ol={class:"dialog-footer"},Bl={__name:"unittest",props:{TEST_TYPE:{type:[String,Number],default:""}},setup(qe,{expose:Ue}){const X=c(!1),Z=c(0),Ee=qe,L=at(),Le=ot(),z=ut(),T=Ee.TEST_TYPE||(L.path==="/unittest"?"S":"W");let n=pe({page:1,pagesize:30,question:"",answer:"",cate_id:void 0,case_state:0,case_result:0});const j=c(0),Re=()=>{n.case_result=0,n.question="",n.answer="",n.cate_id=void 0,n.id=void 0,n.case_state=0};Se(n,L.query,"cate_id,id");let ee=c([]),N="id";const x=o=>{if(o=="init"&&(n.page=1),n.id=n.id||void 0,ct(n,T).then(e=>{let r=e.rows||[],k=[];r.forEach(w=>{w[N]&&k.push(w[N])}),k.length>0?_t({ids:k}).then(w=>{Me(w.rows||[],r)}):ee.value=r,j.value=e.total_records}),o!="noquery"&&L.path=="/unittest"){let e={...L.query,...n};Le.replace({path:L.path,query:e})}},Me=(o,e)=>{e.forEach(r=>{if(r[N]){let k=[];o.forEach(w=>{w.unit_case_id==r[N]&&k.push(w)}),r.test_cates=k}}),ee.value=e};x(),c(null);const R=c([]),te=c(null),le=async o=>{n.cate_id=o.id,R.value=[].concat(R.value),await Te(),te.value.setCurrentKey(parseInt(n.category_id)),x("init")},se=o=>{mt({},T).then(async e=>{R.value=e||[],await Te(),te.value.setCurrentKey(parseInt(n.category_id))})};se();const M=c(!1),g=pe({name:"",color:"",id:0});function _e(){return("#"+Math.floor(Math.random()*16777215).toString(16).padEnd(6,"0")).toUpperCase()}const ae=c(),oe=async(o,e)=>{g.pid=o.pid||null,g.id=o.id||void 0,g.cate_name=o.name||"",g.color=o.color||_e(),e=="child"&&(g.pid=o.id,g.cate_name="",g.id=void 0,g.color=_e()),M.value=!0,setTimeout(()=>{ae.value.focus()},400)},De=()=>{if(!g.color)return _this.$message("请选择分类颜色","error"),!1;if(!g.cate_name)return ae.value.focus(),!1;yt(g,T).then(o=>{_this.$message("操作成功"),M.value=!1,se()})},He=o=>{_this.$confirm("确定要删除所选数据?").then(e=>{bt({id:o.id},T).then(r=>{_this.$message("删除成功"),se()})})},q=c(!1),U=c({}),me=async o=>{U.value=o,q.value=!0},D=c(!1),_=pe({id:"",id1:"",curTestType:2,llm_id:"",unit_llm_id:"",prompt_id:"",prompt_name:"",is_forced:!1}),y=c({}),fe=c(),ne=o=>{let e="unittestoptformparamSave";o?localStorage.setItem(e,JSON.stringify(o)):localStorage.getItem(e)&&(y.value=JSON.parse(localStorage.getItem(e)))};ne();const Ie=async o=>{o&&await o.validate((e,r)=>{if(e){if(!_.unit_llm_id)return _this.$message("请选择执行大模型","error"),!1;if(!_.llm_id)return _this.$message("请选择评测大模型","error"),!1;if(!_.prompt_id)return _this.$message("请选择提示词","error"),!1;y.value=kt.cloneDeep(_),ne(y.value),D.value=!1,P.value.length>0&&ie(P.value)}})},ve=async o=>{Se(_,y.value),P.value=o||[],D.value=!0},O=c([]),H=c(!1),je=()=>{q.value?O.value=[{id:U.value.prompt_id}]:O.value=[{id:_.prompt_id}],H.value=!0},Ne=o=>{H.value=!1,O.value=[],q.value?(U.value.prompt_id=o[0].id,U.value.prompt_name=o[0].name):(_.prompt_id=o[0].id,_.prompt_name=o[0].name)},Oe=o=>{_.id="",_.is_forced="",_.id1="",_.llm_id="",_.unit_llm_id="",_.workflow_id="",_.curTestType=2,_.prompt_id="",_.prompt_name="",y.value={},ne(y.value)},B=c([]),Be=o=>{B.value=o},P=c([]),ie=async o=>{if(!o){if(B.value.length==0)return _this.$message("请选择测试用例","error"),!1;o=[],B.value.forEach(r=>{o.push(r.id)})}if(!y.value.curTestType)return _this.$message("请先配置参数，再执行测试","error"),ve(o),!1;P.value=[];let e={ids:o};e.unit_llm_id=y.value.unit_llm_id,e.evaluation_llm_id=y.value.llm_id,e.evaluation_prompt_id=y.value.prompt_id,e.evaluation_prompt_name=y.value.prompt_name,e.is_forced=y.value.is_forced,vt(e,T).then(r=>{r&&(_this.$message("测试任务提交成功"),x())}).catch(r=>{})},Pe=o=>{_this.$confirm("确定要删除所选数据?").then(e=>{ht({id:o.id},T).then(r=>{_this.$message("删除成功"),x()})})},S=c(null),Ae=()=>B.value,Je=o=>{var e;o?o.forEach(r=>{var k;(k=S.value)==null||k.toggleRowSelection(r,void 0)}):(e=S.value)==null||e.clearSelection()},re=c([]);rt({page:1,pagesize:1e4},T).then(o=>{re.value=o||[]});const Ke=c([]);dt({page:1,pagesize:1e4},T).then(o=>{let e=o.rows||[];Ke.value=e});const ge=c({}),de=c(!1),Ye=async o=>{wt({page:1,pagesize:1,flow_id:o},T).then(r=>{let k=r.rows||[];ge.value=k[0]||{},de.value=!0})};Ue({getCheckList:Ae,setCehckList:Je});const Fe=o=>{_this.$message("操作成功"),x(),q.value=!1},be=c(null),we=o=>(z.commit("loading",!0),!0),he=o=>{let e=o.toString();e=e.replace("UploadAjaxError: ",""),e=JSON.parse(e),_this.$message(e.detail,"error"),z.commit("loading",!1),x()},A=c(null),ye=(o,e,r)=>{_this.$message("导入成功"),A.value&&A.value.clearFiles(),z.commit("loading",!1),x()},J=c(!1),Qe=o=>{xt({source_cate_id:o.curcateData.id,target_cate_id:o.curcateData1.id,tag:"S"}).then(e=>{_this.$message("操作成功"),J.value=!1,x()})},We=()=>{if(n.cate_id===void 0||n.cate_id===null||n.cate_id==="")return _this.$message("请先选择分类","error"),!1;ft({cate_id:n.cate_id})},K=c(0);return(o,e)=>{const r=v("el-button"),k=v("el-tree"),w=v("el-scrollbar"),Y=v("el-input"),$=v("el-form-item"),C=v("el-option"),F=v("el-select"),ue=v("el-form"),ke=v("el-upload"),Ge=v("el-link"),b=v("el-table-column"),E=v("el-popover"),Xe=v("el-table"),Ze=v("el-pagination"),et=v("el-color-picker"),xe=v("el-dialog"),tt=v("el-tooltip"),Ce=v("el-drawer"),lt=$e("searchOpen"),st=$e("copy");return i(),p(I,null,[a("div",zt,[a("div",qt,[a("span",Ut,[e[36]||(e[36]=d("单元测试 ")),u(n).cate_id!==void 0?(i(),p("span",Et," [id:"+h(u(n).cate_id)+"]",1)):m("",!0)])]),a("div",Lt,[a("div",Rt,[a("div",Mt,[e[38]||(e[38]=a("span",{class:"title"},"用例库",-1)),l(r,{onClick:e[0]||(e[0]=t=>le({id:void 0})),class:"on noradius",plain:""},{default:s(()=>e[37]||(e[37]=[a("span",{class:"iconfont icon-anniu-zhankai"},null,-1),d(" 查看全部 ")])),_:1})]),a("div",Dt,[l(w,null,{default:s(()=>[a("div",Ht,[a("div",{class:nt(["el-tree-node",{"is-current":u(n).cate_id==0}])},[a("div",It,[a("div",{onClick:e[1]||(e[1]=t=>le({id:0})),style:{"padding-left":"35px"},class:"custom-tree-node"},e[39]||(e[39]=[a("div",{class:"item"},[a("span",{class:"c-color radius",style:"background-color:#ff0000"}),d("未分类 ")],-1)]))])],2)]),l(k,{ref_key:"treeSelect",ref:te,style:{width:"100%"},data:R.value,"node-key":"id","empty-text":"暂无测试类目信息","highlight-current":"","current-node-key":u(n).cate_id?parseInt(u(n).cate_id):void 0,"default-expand-all":"",onNodeClick:le,"expand-on-click-node":!1},{default:s(({node:t,data:f})=>[a("div",{title:f.name,class:"custom-tree-node"},[a("div",Nt,[a("span",{class:"c-color radius",style:ce("background-color:"+f.color)},null,4),a("p",Ot,h(f.name),1)]),a("div",Bt,[a("span",{title:"添加子类目",onClick:W(Q=>oe(f,"child"),["stop"]),class:"iconfont icon-shuzhuang-tianjia"},null,8,Pt),a("span",{title:"修改",onClick:W(Q=>oe(f),["stop"]),class:"iconfont icon-xiugai"},null,8,At),a("span",{title:"删除类目",onClick:W(Q=>He(f),["stop"]),class:"iconfont icon-shuzhuang-shanchu"},null,8,Jt)])],8,jt)]),_:1},8,["data","current-node-key"])]),_:1})]),a("div",Kt,[l(r,{style:{width:"100%"},plain:"",class:"on noradius",onClick:e[2]||(e[2]=t=>oe({name:"",color:"",id:0}))},{default:s(()=>e[40]||(e[40]=[a("span",{class:"iconfont icon-liebiao-xinzeng"},null,-1),d(" 新增用例库")])),_:1})])]),a("div",Yt,[a("div",Ft,[l(ue,{model:u(n),ref:"searchFormRef",inline:"",class:"demo-form-inline"},{default:s(()=>[l($,{label:"id",prop:"id"},{default:s(()=>[l(Y,{clearable:"",modelValue:u(n).id,"onUpdate:modelValue":e[3]||(e[3]=t=>u(n).id=t),type:"text"},null,8,["modelValue"])]),_:1}),l($,{label:"问题",prop:"question"},{default:s(()=>[l(Y,{clearable:"",modelValue:u(n).question,"onUpdate:modelValue":e[4]||(e[4]=t=>u(n).question=t),type:"text"},null,8,["modelValue"])]),_:1}),l($,{label:"结果",prop:"case_result"},{default:s(()=>[l(F,{style:{width:"160px"},clearable:"",modelValue:u(n).case_result,"onUpdate:modelValue":e[5]||(e[5]=t=>u(n).case_result=t),placeholder:""},{default:s(()=>[l(C,{label:"请选择",value:0}),l(C,{label:"未测试",value:1001}),l(C,{label:"成功",value:2001}),l(C,{label:"失败",value:3001})]),_:1},8,["modelValue"])]),_:1}),l($,{label:"状态",prop:"case_state"},{default:s(()=>[l(F,{style:{width:"160px"},clearable:"",modelValue:u(n).case_state,"onUpdate:modelValue":e[6]||(e[6]=t=>u(n).case_state=t),placeholder:""},{default:s(()=>[l(C,{label:"请选择",value:0}),l(C,{label:"准备就绪",value:1001}),l(C,{label:"测试中",value:2001}),l(C,{label:"测试完成",value:3001})]),_:1},8,["modelValue"])]),_:1}),l($,{label:"回答",prop:"answer"},{default:s(()=>[l(Y,{clearable:"",modelValue:u(n).answer,"onUpdate:modelValue":e[7]||(e[7]=t=>u(n).answer=t),type:"text"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),a("div",Qt,[Ve((i(),p("span",{onClick:e[8]||(e[8]=t=>{K.value==0?K.value=67:K.value=0,S.value&&S.value.update()}),class:"c-search-openbtn"},e[41]||(e[41]=[a("span",{class:"iconfont icon-anniu-zhankai"},null,-1),a("span",{class:"opentext"},"展开",-1),a("span",{class:"closetext"},"收起",-1)]))),[[lt]]),l(r,{onClick:e[9]||(e[9]=t=>x("init")),type:"primary"},{default:s(()=>e[42]||(e[42]=[d("查询")])),_:1}),l(r,{onClick:e[10]||(e[10]=t=>Re()),plain:""},{default:s(()=>e[43]||(e[43]=[d("重置")])),_:1})])]),a("div",Wt,[a("div",Gt,[l(r,{onClick:e[11]||(e[11]=t=>me({id:null,cate_id:null,message_history_id:null,workflow_log_id:null,question:"",message_history:"",right_answer:"",note:""})),type:"primary"},{default:s(()=>e[44]||(e[44]=[d("新增")])),_:1}),l(r,{onClick:e[12]||(e[12]=t=>J.value=!0),plain:""},{default:s(()=>e[45]||(e[45]=[d("调整类目")])),_:1}),l(ke,{class:"upload-demo",style:{margin:"0 12px"},ref_key:"uploadRef",ref:A,headers:{authorization:"Bearer "+u(z).state.token},"before-upload":we,"show-file-list":!1,"on-error":he,"on-success":ye,limit:1,action:"/api/test/case/unit/import"},{default:s(()=>[l(r,{plain:""},{default:s(()=>e[46]||(e[46]=[d("批量导入")])),_:1})]),_:1},8,["headers"]),l(r,{onClick:e[13]||(e[13]=t=>We()),plain:""},{default:s(()=>e[47]||(e[47]=[d("导出")])),_:1}),l(ke,{class:"upload-demo",style:{margin:"0 12px 0 12px"},ref_key:"uploadRef",ref:A,headers:{authorization:"Bearer "+u(z).state.token},"before-upload":we,"show-file-list":!1,"on-error":he,"on-success":ye,limit:1,action:"/api/test/case/unit/import_update"},{default:s(()=>[l(r,{plain:""},{default:s(()=>e[48]||(e[48]=[d("批量修改")])),_:1})]),_:1},8,["headers"]),l(r,{onClick:e[14]||(e[14]=t=>ie()),type:"primary",plain:""},{default:s(()=>e[49]||(e[49]=[d("批量测试")])),_:1}),l(r,{onClick:e[16]||(e[16]=t=>ve()),style:{background:"rgba(22,93,255,0.1)",color:"var(--el-color-primary)"},plain:""},{default:s(()=>[e[50]||(e[50]=d("参数配置 ")),y.value.curTestType?(i(),p("span",{key:0,style:{color:"var(--el-text-color-regular)"},title:"删除已配置参数",onClick:e[15]||(e[15]=W(t=>Oe(!0),["stop"])),class:"iconfont icon-guanbi"})):m("",!0)]),_:1})]),l(Ge,{onClick:e[17]||(e[17]=t=>u(pt)("/api/test/download/case_unit_template"))},{default:s(()=>e[51]||(e[51]=[a("span",{class:"iconfont icon-anniu-xiazai"},null,-1),d("下载导入模板")])),_:1})]),a("div",Xt,[a("div",Zt,[l(Xe,{"tooltip-effect":"light",border:"",data:u(ee),style:{width:"100%"},"max-height":u(z).getters.innerHeight-293-K.value,onSelectionChange:Be,ref_key:"tableRef",ref:S},{empty:s(t=>[a("div",Dl,[l(gt,{type:"empzwssjg",width:"100",height:"100"}),e[60]||(e[60]=d("暂无数据~~ "))])]),default:s(()=>[l(b,{fixed:"left",type:"selection",width:"40"}),l(b,{width:"100",prop:"id",label:"id"},{default:s(t=>[t.row.test_cates&&t.row.test_cates.length>0?(i(),V(E,{key:0,placement:"top-start",width:200,trigger:"hover"},{reference:s(()=>[a("div",el,[(i(!0),p(I,null,G(t.row.test_cates,(f,Q)=>(i(),p("span",{class:"dot on",style:ce("background-color: "+f.case_cate_color+"; left: "+Q*5+"px")},null,4))),256))])]),default:s(()=>[a("div",tl,[t.row.test_cates&&t.row.test_cates.length>0?(i(),p("div",ll," 语料类型 ")):m("",!0),t.row.test_cates&&t.row.test_cates.length>0?(i(),p("div",sl,[(i(!0),p(I,null,G(t.row.test_cates,f=>(i(),p("div",al,[a("span",{class:"c-color on",style:ce("background-color:"+f.case_cate_color)},null,4),Ve((i(),p("span",ol,[d("id: "+h(f.case_id),1)])),[[st,f.case_id]]),d("  "+h(f.case_cate_name),1)]))),256))])):m("",!0)])]),_:2},1024)):m("",!0),d(" "+h(t.row.id),1)]),_:1}),l(b,{"min-width":"160",label:"问题"},{default:s(t=>[t.row.question?(i(),V(E,{key:0,placement:"top-start",width:500,trigger:"hover"},{reference:s(()=>[a("div",nl,[e[52]||(e[52]=a("span",{class:"c-primary-btn c-mini"},"问",-1)),d(" "+h(t.row.question),1)])]),default:s(()=>[a("div",il,[l(w,{"max-height":"400"},{default:s(()=>[a("div",{innerHTML:t.row.question.replace(/\n/g,"<br>"),style:{margin:"0 20px"}},null,8,rl)]),_:2},1024)])]),_:2},1024)):m("",!0)]),_:1}),l(b,{"min-width":"160",label:"参考答案"},{default:s(t=>[t.row.right_answer?(i(),V(E,{key:0,placement:"top-start",width:500,trigger:"hover"},{reference:s(()=>[a("div",dl,[e[53]||(e[53]=a("span",{class:"c-success-btn c-mini"},"参",-1)),d(" "+h(t.row.right_answer),1)])]),default:s(()=>[a("div",ul,[l(w,{"max-height":"400"},{default:s(()=>[a("div",{innerHTML:t.row.right_answer.replace(/\n/g,"<br>"),style:{margin:"0 20px"}},null,8,pl)]),_:2},1024)])]),_:2},1024)):m("",!0)]),_:1}),l(b,{"min-width":"160",label:"最终回答"},{default:s(t=>[t.row.test_result_answer?(i(),V(E,{key:0,placement:"top-start",width:500,trigger:"hover"},{reference:s(()=>[a("div",cl,[e[54]||(e[54]=a("span",{class:"c-warn-btn c-mini"},"终",-1)),d(" "+h(t.row.test_result_answer),1)])]),default:s(()=>[a("div",_l,[l(w,{"max-height":"400"},{default:s(()=>[a("div",{innerHTML:t.row.test_result_answer.replace(/\n/g,"<br>"),style:{margin:"0 20px"}},null,8,ml)]),_:2},1024)])]),_:2},1024)):m("",!0)]),_:1}),l(b,{"min-width":"160",label:"备注"},{default:s(t=>[t.row.note?(i(),V(E,{key:0,placement:"top-start",width:500,trigger:"hover"},{reference:s(()=>[a("div",fl,h(t.row.note),1)]),default:s(()=>[a("div",vl,[l(w,{"max-height":"400"},{default:s(()=>[a("div",{innerHTML:t.row.note.replace(/\n/g,"<br>"),style:{margin:"0 20px"}},null,8,gl)]),_:2},1024)])]),_:2},1024)):m("",!0)]),_:1}),l(b,{"min-width":"160",label:"测试标准"},{default:s(t=>[t.row.test_standard?(i(),V(E,{key:0,placement:"top-start",width:500,trigger:"hover"},{reference:s(()=>[a("div",bl,h(t.row.test_standard),1)]),default:s(()=>[a("div",wl,[l(w,{"max-height":"400"},{default:s(()=>[a("div",{innerHTML:t.row.test_standard.replace(/\n/g,"<br>"),style:{margin:"0 20px"}},null,8,hl)]),_:2},1024)])]),_:2},1024)):m("",!0)]),_:1}),l(b,{width:"100",label:"测试结果"},{default:s(t=>[t.row.test_result==2001?(i(),p("span",yl,"成功")):m("",!0),t.row.test_result==1001?(i(),p("span",kl,"未测试")):m("",!0),t.row.test_result==3001?(i(),p("span",xl,"失败")):m("",!0)]),_:1}),l(b,{width:"100",label:"测试状态"},{default:s(t=>[t.row.test_state==3001?(i(),p("span",Cl,"测试完成")):m("",!0),t.row.test_state==2001?(i(),p("span",Vl,"测试中")):m("",!0),t.row.test_state==1001?(i(),p("span",Tl,"准备就绪")):m("",!0)]),_:1}),l(b,{width:"160",label:"运行记录"},{default:s(t=>[t.row.test_result!=1001?(i(),p("span",{key:0,onClick:f=>{Z.value=t.row.id,X.value=!0},class:"c-pointer c-flex"},[e[55]||(e[55]=a("span",{style:{color:"var(--el-color-primary)"},class:"iconfont icon-yunhangjilu"},null,-1)),d("运行记录("+h(t.row.test_count)+") ",1)],8,$l)):m("",!0)]),_:1}),l(b,{width:"100",align:"center",label:"是否审核"},{default:s(t=>[t.row.is_marked?(i(),p("span",Sl,"已审核")):(i(),p("span",zl,"未审核"))]),_:1}),l(b,{width:"100",align:"center",label:"是否更正"},{default:s(t=>[t.row.is_modified?(i(),p("span",ql,"已更正")):(i(),p("span",Ul,"未更正"))]),_:1}),l(b,{width:"160",align:"center",label:"创建时间"},{default:s(t=>[d(h(u(ze)(t.row.created_at)),1)]),_:1}),l(b,{width:"160",align:"center",label:"最后测试时间"},{default:s(t=>[d(h(u(ze)(t.row.last_test_time)),1)]),_:1}),l(b,{fixed:"right",width:"240",align:"right",label:"操作"},{default:s(t=>[a("div",{onClick:f=>me(t.row),class:"c-table-ibtn"},e[56]||(e[56]=[a("span",{class:"iconfont icon-xiugai"},null,-1),d(" 修改 ")]),8,El),a("div",{onClick:f=>ie([t.row.id]),class:"c-table-ibtn"},e[57]||(e[57]=[a("span",{class:"iconfont icon-liebiao-ceshi"},null,-1),d(" 测试 ")]),8,Ll),t.row.workflow_log_id?(i(),p("div",{key:0,onClick:f=>{be.value=t.row.workflow_node_log_id,Ye(t.row.workflow_log_id)},class:"c-table-ibtn"},e[58]||(e[58]=[a("span",{class:"iconfont icon-liebiao-xiangqing"},null,-1),d(" 用例详情 ")]),8,Rl)):m("",!0),a("div",{onClick:f=>Pe(t.row),class:"c-table-ibtn c-btn-del"},e[59]||(e[59]=[a("span",{class:"iconfont icon-shuzhuang-shanchu"},null,-1),d(" 删除 ")]),8,Ml)]),_:1})]),_:1},8,["data","max-height"]),j.value>0?(i(),p("div",Hl,[l(Ze,{"hide-on-single-page":!1,background:"","page-size":u(n).pagesize,"current-page":u(n).page,onSizeChange:e[18]||(e[18]=t=>{u(n).pagesize=t,u(n).page=Math.min(Math.ceil(j.value/u(n).pagesize),u(n).page),x()}),onCurrentChange:e[19]||(e[19]=t=>{u(n).page=t,S.value&&S.value.scrollTo(0,0),x()}),"page-sizes":[30,50,100,900],layout:"total,sizes,jumper,prev, pager, next",total:j.value},null,8,["page-size","current-page","total"])])):m("",!0)])])])])]),l(xe,{"align-center":"",modelValue:M.value,"onUpdate:modelValue":e[24]||(e[24]=t=>M.value=t),title:g.id?"修改用例库":"新增用例库",width:"500"},{footer:s(()=>[a("div",Il,[l(r,{plain:"",onClick:e[22]||(e[22]=t=>M.value=!1)},{default:s(()=>e[61]||(e[61]=[d(" 取消 ")])),_:1}),l(r,{type:"primary",onClick:e[23]||(e[23]=t=>De())},{default:s(()=>e[62]||(e[62]=[d(" 确定 ")])),_:1})])]),default:s(()=>[l(ue,{ref:"formRef",model:g,"label-width":"auto","label-position":"top",class:"demo-dynamic tl"},{default:s(()=>[l($,{prop:"cate_name",label:"分类名称",rules:[{required:!0,message:"请输入分类名称",trigger:"blur"}]},{default:s(()=>[l(Y,{modelValue:g.cate_name,"onUpdate:modelValue":e[20]||(e[20]=t=>g.cate_name=t),ref_key:"inputRef",ref:ae,autofocus:"",style:{width:"calc(100% - 42px)","margin-right":"10px"},placeholder:"分类名称"},null,8,["modelValue"]),l(et,{modelValue:g.color,"onUpdate:modelValue":e[21]||(e[21]=t=>g.color=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(xe,{"align-center":"",modelValue:D.value,"onUpdate:modelValue":e[30]||(e[30]=t=>D.value=t),title:"配置参数",width:"700"},{footer:s(()=>[a("div",Ol,[l(r,{plain:"",onClick:e[28]||(e[28]=t=>D.value=!1)},{default:s(()=>e[66]||(e[66]=[d(" 取消 ")])),_:1}),l(r,{type:"primary",onClick:e[29]||(e[29]=t=>Ie(fe.value))},{default:s(()=>e[67]||(e[67]=[d(" 确定 ")])),_:1})])]),default:s(()=>[l(ue,{ref_key:"optform",ref:fe,model:_,"label-width":"auto",inline:"","label-position":"top",class:"demo-dynamic tl"},{default:s(()=>[l($,{style:{width:"calc(50% - 8px)","margin-right":"16px"},prop:"unit_llm_id",label:"执行大模型",rules:[{required:!0,message:"请选执行大模型",trigger:"change"}]},{default:s(()=>[l(F,{modelValue:_.unit_llm_id,"onUpdate:modelValue":e[25]||(e[25]=t=>_.unit_llm_id=t),class:"val",filterable:"",placeholder:"请选择大模型"},{default:s(()=>[(i(!0),p(I,null,G(re.value,t=>(i(),V(C,{value:parseInt(t.id,10),label:t.name},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1}),l($,{style:{width:"calc(50% - 8px)","margin-right":"0px"},prop:"llm_id",label:"",rules:[{required:!0,message:"请选评测大模型",trigger:"change"}]},{label:s(()=>[e[64]||(e[64]=d(" 评测大模型 ")),l(tt,{"popper-class":"c-flowtip",class:"item",effect:"dark",content:"用来对输出结果进行打分的大模型，按照提示词对输出和标准答案进行对比打分。",placement:"top"},{default:s(()=>e[63]||(e[63]=[a("span",{style:{position:"relative",top:"1px"},class:"iconfont icon-bangzhu"},null,-1)])),_:1})]),default:s(()=>[l(F,{modelValue:_.llm_id,"onUpdate:modelValue":e[26]||(e[26]=t=>_.llm_id=t),class:"val",filterable:"",placeholder:"请选择大模型"},{default:s(()=>[(i(!0),p(I,null,G(re.value,t=>(i(),V(C,{value:parseInt(t.id,10),label:t.name},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1}),l($,{style:{width:"100%","margin-right":"0px"},prop:"prompt_id",rules:[{required:!0,message:"请选提示词"}],label:"提示词"},{default:s(()=>[a("div",{onClick:e[27]||(e[27]=t=>je()),class:"c-switchbox pointer"},[_.prompt_name?(i(),p("span",jl,h(_.prompt_name),1)):(i(),p("span",Nl,"请选择提示词")),e[65]||(e[65]=a("span",{style:{position:"absolute",top:"-36px",right:"0",color:"var(--el-color-primary)"},class:"c-pointer"},"选择",-1))])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(Ce,{modelValue:H.value,"onUpdate:modelValue":e[31]||(e[31]=t=>H.value=t),size:"90%",title:"",direction:"rtl"},{default:s(()=>[H.value?(i(),V(Tt,{key:0,onSubfn:Ne,isCheck:!0,checkList:O.value},null,8,["checkList"])):m("",!0)]),_:1},8,["modelValue"]),l(Ct,{modelValue:q.value,"onUpdate:modelValue":e[32]||(e[32]=t=>q.value=t),TEST_TYPE:"S",item:U.value,title:U.value.id?"修改单元测试":"添加单元测试",onSubfn:Fe},null,8,["modelValue","item","title"]),l(Vt,{modelValue:de.value,"onUpdate:modelValue":e[33]||(e[33]=t=>de.value=t),nodeid:be.value,data:ge.value},null,8,["modelValue","nodeid","data"]),l($t,{dataSource:R.value,modelValue:J.value,"onUpdate:modelValue":e[34]||(e[34]=t=>J.value=t),onSubfn:Qe},null,8,["dataSource","modelValue"]),l(Ce,{modelValue:X.value,"onUpdate:modelValue":e[35]||(e[35]=t=>X.value=t),title:"运行记录",direction:"rtl","close-on-click-modal":!0,size:"90%"},{default:s(()=>[Z.value?(i(),V(St,{key:0,id:Z.value},null,8,["id"])):m("",!0)]),_:1},8,["modelValue"])],64)}}},es=it(Bl,[["__scopeId","data-v-f4c2bf1f"]]);export{es as default};
