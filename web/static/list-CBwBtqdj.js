import{r as u,aR as se,l as D,z as c,B as o,R as t,J as a,al as r,Q as N,aS as oe,A as f,O as p,a6 as L,u as h,E as j,L as te,P as y,W as K,a4 as ae}from"./vue-CdYMfVVj.js";import{_ as ne,V as ie,l as M,u as de,ag as ue,ah as re}from"./index-B6WbZO8q.js";import{x as pe}from"./xltest-sIMEY9zz.js";import"./element-GwJlJi_X.js";import"./editor-Dhn2M38E.js";const ve={class:"c-titlebox"},ce={class:"btns"},fe={class:"c-cardbtn-btns"},_e={class:"tabbox"},be={class:"scrollbox"},me={class:"pagelistbox"},ge=["onClick"],ke={class:"rbox"},ye={class:"c-cardbtn-btns"},xe=["onClick"],we=["onClick"],Ve=["title"],Ce={class:"typebox"},$e=["title"],qe=["title"],Re={class:"brand_name c-primary-btn ellipsis"},ze={key:1,class:"brand_name c-plain-btn ellipsis"},Ee=["onClick"],De={class:"dialog-footer"},Ne={__name:"list",setup(Se){const k=se(),X=oe(),I=de(),m=u(!1),v=u("");k.query.active&&(v.value=k.query.active);let _=u([]);const S=u([]),x=()=>{ie().then(s=>{let e=s||[];S.value=M.cloneDeep(e),_.value=e,$.value=[],q.value=[],R.value=[],e.forEach(n=>{n.type==2?q.value.push(n):n.type==1?$.value.push(n):n.type==3&&R.value.push(n)}),v.value&&T()})};x();const b=u([]),i=D({name:"",caption:"",id:"",type:"",label:""}),J=()=>{b.value=M.uniq([...b.value])},w=(s,e="")=>{i.id=s?s.id:"",i.name=s?s.name:"",i.caption=s?s.caption:"",i.label=s?s.label:"",b.value=s!=null&&s.label?s.label.split(","):[],i.type=e||(s==null?void 0:s.type)||"",m.value=!0,setTimeout(()=>{document.querySelectorAll(".autofocus.inp2 input")[0].focus()},100)},O=s=>{_this.$confirm("此操作将永久删除该知识库, 是否继续?").then(e=>{ue({id:s}).then(n=>{_this.$message("删除成功"),x()})})},V=u(),P=D({name:[{required:!0,message:"请输入知识库名称"}]}),U=async s=>{s&&s.validate(e=>{if(e)i.label=b.value.join(","),re(i).then(n=>{n&&(_this.$message("提交成功"),m.value=!1,x())});else return document.querySelectorAll(".autofocus.inp2 input")[0].focus(),!1})},C=u(!1),d=D({knowledgebase_k:5,knowledgebase_ids:[],file_knowledgebase_ids:[],product_model_ids:[],file_knowledgebase_k:5,product_model_top_k:5,question:""}),Q=u([]),A=s=>{Q.value=[],d.knowledgebase_k=5,d.knowledgebase_ids=[],d.product_model_ids=[],d.file_knowledgebase_ids=[],d.product_model_top_k=5,d.file_knowledgebase_k=5,d.question="",s&&(s.type==2?d.product_model_ids=[s.id]:s.type==3?d.file_knowledgebase_ids=[s.id]:s.type==1&&(d.knowledgebase_ids=[s.id])),C.value=!0},$=u([]),q=u([]),R=u([]),W=(s,e)=>{let n={...k.query};n.active=v.value,X.replace({path:k.path,query:n}),T()},T=()=>{v.value=="1"?_.value=$.value:v.value=="2"?_.value=q.value:v.value=="3"?_.value=R.value:_.value=S.value};return(s,e)=>{const n=r("el-button"),B=r("el-popover"),z=r("el-tab-pane"),Z=r("el-tabs"),G=r("el-scrollbar"),F=r("el-input"),E=r("el-form-item"),H=r("el-input-tag"),Y=r("el-form"),ee=r("el-dialog");return f(),c(N,null,[o("div",ve,[e[17]||(e[17]=o("span",{class:"title"},"知识库",-1)),o("div",ce,[t(n,{size:"small",onClick:e[0]||(e[0]=l=>A()),type:"primary"},{default:a(()=>e[13]||(e[13]=[p("向量检测")])),_:1}),t(B,{width:200},{reference:a(()=>[t(n,{size:"small",class:"on",style:{border:"none"},plain:""},{default:a(()=>e[14]||(e[14]=[p("新建")])),_:1})]),default:a(()=>[o("div",fe,[o("div",{onClick:e[1]||(e[1]=l=>w(void 0,1)),class:"item"},e[15]||(e[15]=[o("span",{class:"name"},"文本知识库",-1)])),o("div",{onClick:e[2]||(e[2]=l=>w(void 0,3)),class:"item"},e[16]||(e[16]=[o("span",{class:"name"},"EXCEL知识库",-1)]))])]),_:1})])]),o("div",_e,[t(Z,{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=l=>v.value=l),class:"demo-tabs",onTabChange:W},{default:a(()=>[t(z,{name:"1"},{label:a(()=>e[18]||(e[18]=[p(" 文本知识库 ")])),_:1}),t(z,{name:"3"},{label:a(()=>e[19]||(e[19]=[p(" EXCEL知识库 ")])),_:1}),t(z,{name:""},{label:a(()=>e[20]||(e[20]=[p(" 全部 ")])),_:1})]),_:1},8,["modelValue"])]),o("div",be,[t(G,{ref:"scrollbarRef"},{default:a(()=>[o("div",me,[(f(!0),c(N,null,L(h(_),(l,le)=>(f(),c("div",{onClick:g=>s.$router.push(l.type==2?`/dataset/shop?id=${l.id}`:l.type==1?`/dataset/detail?id=${l.id}`:`/dataset/excel?id=${l.id}&name=${l.name}`),key:le,class:j(["type"+l.type,"item"])},[e[25]||(e[25]=o("span",{class:"iconfont icon-zhishiku-kapianzaiti"},null,-1)),e[26]||(e[26]=o("span",{class:"iconfont icon-zhishiku-ceshianniubeijing"},null,-1)),o("span",{class:j("c-topicon"+l.type)},null,2),o("div",ke,[t(B,{width:160},{reference:a(()=>e[21]||(e[21]=[o("span",{class:"iconfont icon-gengduo c-cardbtn-icon"},null,-1)])),default:a(()=>[o("div",ye,[o("div",{onClick:g=>w(l),class:"item"},e[22]||(e[22]=[o("span",{class:"name"},"修改",-1)]),8,xe),o("div",{onClick:g=>O(l.id),class:"item err"},e[23]||(e[23]=[o("span",{class:"name"},"删除",-1)]),8,we)])]),_:2},1024)]),o("div",{title:l.name,class:"title ellipsis"},y(l.name),9,Ve),o("div",Ce,y(h(I).getters.iconMaps.knowledgeNames[l.type].name),1),o("div",{title:l.caption,class:"introbox ellipsis2"},y(l.caption||"这个知识库还没有介绍~"),9,$e),l?(f(),c("div",{key:0,title:l.label,class:"ellipsis labelbox"},[l.label?(f(!0),c(N,{key:0},L(l.label.split(","),g=>(f(),c("div",Re,y(g),1))),256)):(f(),c("div",ze,"暂无标签"))],8,qe)):te("",!0),o("div",{onClick:K(g=>A(l),["stop"]),class:"fotbtn"},e[24]||(e[24]=[p(" 测试 "),o("span",{class:"iconfont icon-xiangyoujiantou"},null,-1)]),8,Ee)],10,ge))),128))])]),_:1},512)]),t(ee,{modelValue:m.value,"onUpdate:modelValue":e[11]||(e[11]=l=>m.value=l),title:i.id?"修改知识库":"创建知识库",width:"700"},{footer:a(()=>[o("div",De,[t(n,{onClick:e[9]||(e[9]=l=>m.value=!1)},{default:a(()=>e[28]||(e[28]=[p("取消")])),_:1}),t(n,{type:"primary",onClick:e[10]||(e[10]=l=>U(V.value))},{default:a(()=>e[29]||(e[29]=[p(" 确认提交 ")])),_:1})])]),default:a(()=>[t(Y,{onSubmit:e[8]||(e[8]=K(()=>{},["prevent"])),ref_key:"ruleFormRef1",ref:V,class:"tl",rules:P,"label-width":"auto","label-position":"top",inline:"",model:i},{default:a(()=>[t(E,{style:{width:"calc(50% - 8px)","margin-right":"16px"},label:"知识库名称",prop:"name"},{default:a(()=>[t(F,{onKeyup:e[4]||(e[4]=ae(l=>U(V.value),["native","enter"])),class:"autofocus inp2",placeholder:"请输入知识库名称",modelValue:i.name,"onUpdate:modelValue":e[5]||(e[5]=l=>i.name=l),maxlength:"50",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(E,{style:{width:"calc(50% - 8px)","margin-right":"0px"},label:"标签",prop:"label"},{label:a(()=>e[27]||(e[27]=[p(" 标签 "),o("span",{class:"c-tips"},"(回车可添加多个标签)",-1)])),default:a(()=>[t(H,{onAddTag:J,"collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":2,modelValue:b.value,"onUpdate:modelValue":e[6]||(e[6]=l=>b.value=l),placeholder:"请输入标签信息"},null,8,["modelValue"])]),_:1}),t(E,{style:{width:"100%","margin-right":"0"},label:"介绍",prop:"caption"},{default:a(()=>[t(F,{modelValue:i.caption,"onUpdate:modelValue":e[7]||(e[7]=l=>i.caption=l),maxlength:"200",autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"这个知识库还没有介绍~"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"]),t(pe,{xlform:d,modelValue:C.value,"onUpdate:modelValue":e[12]||(e[12]=l=>C.value=l)},null,8,["xlform","modelValue"])],64)}}},Le=ne(Ne,[["__scopeId","data-v-478750fc"]]);export{Le as default};
