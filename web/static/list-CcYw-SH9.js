import{l as He,r as g,aR as Ie,z as $,B as i,R as t,I as k,L as w,u as s,J as a,al as b,K as fe,Q as N,S as Ce,ar as $e,aS as Oe,n as ze,A as y,O as u,E as Pe,P as v,W as z,a6 as Ue,a4 as Je}from"./vue-CdYMfVVj.js";import{_ as Qe,c as We,d as Se,u as Ge,g as Xe,p as Re,s as Ye,a as Ze,b as el,i as me,e as ll,f as tl,h as ol,j as al,l as qe,k as il,m as sl,n as nl,o as dl,q as ul}from"./index-B6WbZO8q.js";import{a as G}from"./comp-ClzPtuSi.js";import"./element-GwJlJi_X.js";import"./editor-Dhn2M38E.js";const rl={class:"pagelistbox"},pl={class:"c-titlebox"},fl={class:"btns"},ml={class:"tabbox"},cl={class:"c-tablebox tableboxContain c-tooltip c-bodybox"},_l={class:"leftbox"},vl={class:"topbtns"},gl={class:"contain"},bl={class:"el-tree el-tree--highlight-current",role:"tree",style:{width:"100%"}},yl={class:"el-tree-node__content",style:{"padding-left":"0px"}},hl=["title"],wl={class:"item"},xl={class:"ellipsis"},kl={class:"btns"},Vl=["onClick"],Cl=["onClick"],$l=["onClick"],zl={class:"botbtns"},Ul={class:"topbtns"},Sl={class:"contain"},Rl=["title"],ql={class:"item"},Tl={class:"ellipsis"},Fl={class:"btns"},jl=["onClick"],Kl=["onClick"],El={class:"botbtns"},Bl={class:"rightbox"},Dl={class:"c-top-searchbox c-js-item"},Ll={class:"rbox"},Ml={class:"tablebox"},Nl={class:"contain"},Al={class:"ellipsis2"},Hl={style:{margin:"0 -20px"}},Il=["innerHTML"],Ol=["onClick"],Pl=["onClick"],Jl={class:"c-emptybox"},Ql={key:0,class:"c-pagination"},Wl={class:"rightbox"},Gl={class:"c-top-searchbox c-js-item"},Xl={class:"rbox"},Yl={class:"tablebox c-js-body"},Zl={class:"contain"},et={class:"c-scroll-contain"},lt={class:"c-scroll-contain"},tt={class:"c-scroll-contain"},ot={class:"c-scroll-contain"},at=["onClick"],it=["onClick"],st={class:"c-emptybox"},nt={key:0,class:"c-pagination"},dt={class:"dformbox"},ut={disabled:"",class:"c-switchbox"},rt={class:"switch"},pt={class:"c-switchbox"},ft={class:"switch"},mt={class:"c-switchbox"},ct={class:"switch"},_t={class:"ltitlebox"},vt={class:"inp",style:{position:"relative"}},gt={class:"c-tablebox"},bt=["onClick"],yt={class:"dialog-footer"},ht={class:"dialog-footer"},wt={__name:"list",setup(xt){const X=Ie(),Te=Oe(),U=Ge();let o=He({page:1,pagesize:30,active:"1",name:"",goods_code:"",barcode:"",category_id:void 0,category_name:"",recommend_flag:void 0,on_sale_flag:void 0,is_empty_profile:void 0,suite_flag:void 0,shop_id:void 0,sku:""});const S=g(0);let Y=g([]);const A=n=>{o.page=1,o.name="",o.goods_code="",o.barcode="",o.category_name="",o.sku="",o.active==2&&(o.shop_id=void 0),o.active==1&&(o.category_id=void 0,o.recommend_flag=void 0,o.on_sale_flag=void 0,o.suite_flag=void 0,o.is_empty_profile=void 0)},F=g(""),Fe=()=>{if(!F.value)return!1;let n={page_index:1,pagesize:1e4,profile_code:F.value,barcode:"",name:"",category_id:void 0};Re(n).then(e=>{let r=e.rows||[];if(r.length==0)return _this.$message("没有找到相关商品","warning"),!1;r.forEach(p=>{p.quantity=1;let V=-1;d.value.profile_tuple.forEach((J,de)=>{J.id==p.id&&(V=de)}),V===-1?d.value.profile_tuple.push(p):_this.$message("商品已存在，请勿重复添加","warning")}),se(),F.value=""})},h=async n=>{n==="init"&&(o.page=1),n!=="noquery"&&Te.replace({path:X.path,query:{...X.query,...o}});try{const e={page_index:o.page,pagesize:o.pagesize,...o.active==1?{category_id:o.category_id,sku:o.sku,goods_code:o.goods_code||void 0,shop_id:o.shop_id,recommend_flag:o.recommend_flag,on_sale_flag:o.on_sale_flag,suite_flag:o.suite_flag,is_empty_profile:o.is_empty_profile}:{goods_code:o.goods_code||void 0,barcode:o.barcode,name:o.name,category_id:o.category_id}},r=await(o.active==1?Xe(e):Re(e));Y.value=r.rows||[],S.value=r.total}catch(e){console.error("Search error:",e)}};We(o,X.query,"shop_id"),h("noquery"),g(null);const ce=n=>{_this.$confirm("确定要删除所选条目吗?").then(e=>{o.active==2?ll({id:n.id}).then(r=>{_this.$message("删除成功"),oe()}):tl({id:n.id}).then(r=>{_this.$message("删除成功"),le()})})},_e=n=>{_this.$confirm("确定要删除商品吗，删除后将无法识别商品链接，此操作不可恢复!").then(e=>{o.active==2?ol({id:n.id}).then(r=>{_this.$message("删除成功"),h()}):al({id:n.id}).then(r=>{_this.$message("删除成功"),h()})})},R=g(!1),H=n=>n==1?{id:0,pid:void 0,platform_id:"",shop_name:""}:{id:0,shop_id:void 0,category_id:void 0,sku:"",suite_flag:!1,recommend_flag:!1,on_sale_flag:!0,price:0,sale_point:"",goods_name:"",goods_code:"",barcode:"",profile_tuple:[]},j=g(null),d=g(H()),I=async n=>{if(d.value=H(),n)if(o.active==2)n.goods_name=n.name,d.value=qe.cloneDeep(n);else{let e=await ul({id:n.id});e.category_id=e.goods_category_id,e.profiles.forEach(r=>{r.id=r.profile_id}),e.profile_tuple=e.profiles||[],delete e.profiles,d.value=e}R.value=!0,j.value&&j.value.clearValidate()},q=g(!1),Z=g(null),c=g(H(1)),ve=n=>{dl(n).then(async e=>{if(e.is_forced_commit){if(await _this.$confirm("此商品已经配置到店铺商品，是否强制修改？","提示")){n.is_forced_commit=!0,ve(n);return}}else _this.$message("保存成功"),h(),R.value=!1})},je=n=>{n&&n.validate(e=>{if(e){let r=qe.cloneDeep(d.value);if(o.active==2)r={id:d.value.id,goods_name:d.value.goods_name,goods_code:d.value.goods_code,barcode:d.value.barcode,category_id:d.value.category_id},r.is_forced_commit=void 0,ve(r);else{let p=[];d.value.profile_tuple.forEach(V=>{p.push([V.id||V.profile_id,V.quantity,V.mapping_id||0])}),r.profile_tuple=p,delete r.barcode,delete r.goods_code,delete r.goods_name,il(r).then(V=>{_this.$message("保存成功"),h(),R.value=!1})}}})},Ke=(n,e)=>{A(),h("init")},ge=n=>{n&&n.validate(e=>{if(e){let r={};o.active==2?(r={parent_id:c.value.pid,id:c.value.id,name:c.value.shop_name},sl(r).then(p=>{_this.$message("保存成功"),oe(),q.value=!1})):(r={platform_id:c.value.platform_id,id:c.value.id,shop_name:c.value.shop_name},nl(r).then(p=>{_this.$message("保存成功"),le(),q.value=!1}))}})},Ee=()=>{setTimeout(()=>{document.querySelectorAll(".c-focus-inp input")[0]&&document.querySelectorAll(".c-focus-inp input")[0].focus()},500)},ee=g([]),le=()=>{Ye().then(async n=>{ee.value=n||[],await ze(),te.value.setCurrentKey(parseInt(o.shop_id))}).catch(n=>{})};le();const K=g([]),te=g(null),Be=g(null),E=async n=>{A(),o.active==1?o.shop_id=n.id:o.category_id=n.id,h()},oe=n=>{Ze().then(async e=>{K.value=e||[],await ze(),te.value.setCurrentKey(parseInt(o.category_id))}).catch(e=>{})};oe();const be=g([]);(()=>{el().then(n=>{be.value=n})})();const B=g("新增分类"),D=async(n,e)=>{n.id?(o.active==1?(B.value="编辑店铺",c.value.pid=n.pid,c.value.id=n.id):(B.value="编辑分类",c.value.id=n.id,c.value.platform_id=n.platform_id),c.value.shop_name=n.name,c.value.pid=n.pid,c.value.id=n.id,c.value.platform_id=n.platform_id):(o.active==1?B.value="新增店铺":B.value="新增分类",c.value=H(1)),e=="child"&&(c.value.pid=n.id,c.value.shop_name="",c.value.platform_id="",c.value.id=0),Ee(),q.value=!0},ye=n=>{let e=n.toString();e=e.replace("UploadAjaxError: ",""),e=JSON.parse(e),_this.$message(e.detail,"error"),U.commit("loading",!1),h()},ae=g(null),ie=g(null),he=(n,e,r)=>{_this.$message("导入成功"),ae.value&&ae.value.clearFiles(),ie.value&&ie.value.clearFiles(),U.commit("loading",!1),h()},O=g([]),we=n=>o.active==1&&!o.shop_id?(_this.$message("请先选择店铺","error"),!1):(U.commit("loading",!0),!0),se=()=>{let n=0;d.value.profile_tuple.forEach(e=>{n+=e.quantity}),n>1?d.value.suite_flag=!0:d.value.suite_flag=!1},P=g(0),L=g(null),ne=g(null);return(n,e)=>{const r=b("el-link"),p=b("el-button"),V=b("el-upload"),J=b("el-tab-pane"),de=b("el-tabs"),xe=b("el-tree"),Q=b("el-scrollbar"),ue=b("el-tree-select"),f=b("el-form-item"),x=b("el-input"),C=b("el-option"),T=b("el-select"),M=b("el-form"),_=b("el-table-column"),De=b("el-popover"),re=b("el-table"),ke=b("el-pagination"),pe=b("el-switch"),Ve=b("el-input-number"),Le=b("el-drawer"),Me=b("el-dialog"),Ne=$e("searchOpen"),Ae=$e("initTableHeight");return y(),$(N,null,[i("div",rl,[i("div",pl,[e[66]||(e[66]=i("span",{class:"title"},"商品管理",-1)),i("div",fl,[s(o).active=="1"?(y(),k(r,{key:0,onClick:e[0]||(e[0]=l=>s(Se)("/api/goods/download/goods_template"))},{default:a(()=>e[60]||(e[60]=[i("span",{class:"iconfont icon-anniu-xiazai"},null,-1),u(" 下载店铺商品模板")])),_:1})):w("",!0),s(o).active=="2"?(y(),k(r,{key:1,onClick:e[1]||(e[1]=l=>s(Se)("/api/goods/download/profile_template"))},{default:a(()=>e[61]||(e[61]=[i("span",{class:"iconfont icon-anniu-xiazai"},null,-1),u("下载商品档案模板")])),_:1})):w("",!0),s(o).active=="1"?(y(),k(p,{key:2,onClick:e[2]||(e[2]=l=>I()),size:"small",type:"primary"},{default:a(()=>e[62]||(e[62]=[u("新增商品")])),_:1})):w("",!0),s(o).active=="1"?(y(),k(V,{key:3,class:"upload-demo",ref_key:"uploadRef",ref:ae,"file-list":O.value,"onUpdate:fileList":e[3]||(e[3]=l=>O.value=l),headers:{authorization:"Bearer "+s(U).state.token},"before-upload":we,"show-file-list":!1,"on-error":ye,"on-success":he,data:{shop_id:s(o).shop_id},limit:1,action:"/api/goods/import"},{default:a(()=>[t(p,{class:"on",style:{border:"none"},size:"small",plain:""},{default:a(()=>e[63]||(e[63]=[u("导入商品")])),_:1})]),_:1},8,["file-list","headers","data"])):w("",!0),s(o).active=="2"?(y(),k(p,{key:4,onClick:e[4]||(e[4]=l=>I()),size:"small",type:"primary"},{default:a(()=>e[64]||(e[64]=[u("新增档案")])),_:1})):w("",!0),s(o).active=="2"?(y(),k(V,{key:5,class:"upload-demo",ref_key:"uploadRef1",ref:ie,"file-list":O.value,"onUpdate:fileList":e[5]||(e[5]=l=>O.value=l),headers:{authorization:"Bearer "+s(U).state.token},"before-upload":we,"show-file-list":!1,"on-error":ye,"on-success":he,limit:1,action:"/api/goods/profile/import"},{default:a(()=>[t(p,{size:"small",plain:""},{default:a(()=>e[65]||(e[65]=[u("导入档案")])),_:1})]),_:1},8,["file-list","headers"])):w("",!0)])]),i("div",ml,[t(de,{modelValue:s(o).active,"onUpdate:modelValue":e[6]||(e[6]=l=>s(o).active=l),class:"demo-tabs",onTabChange:Ke},{default:a(()=>[t(J,{name:"1"},{label:a(()=>e[67]||(e[67]=[u(" 店铺商品 ")])),_:1}),t(J,{name:"2"},{label:a(()=>e[68]||(e[68]=[u(" 商品档案 ")])),_:1})]),_:1},8,["modelValue"])]),i("div",cl,[i("div",_l,[s(o).active==2?(y(),$(N,{key:0},[i("div",vl,[e[70]||(e[70]=i("span",{class:"title"},"分类",-1)),t(p,{onClick:e[7]||(e[7]=l=>E({id:void 0})),class:"on noradius",plain:""},{default:a(()=>e[69]||(e[69]=[i("span",{class:"iconfont icon-anniu-zhankai"},null,-1),u(" 查看全部 ")])),_:1})]),i("div",gl,[t(Q,null,{default:a(()=>[i("div",bl,[i("div",{class:Pe(["el-tree-node",{"is-current":s(o).category_id==0}])},[i("div",yl,[i("div",{onClick:e[8]||(e[8]=l=>E({id:0})),style:{"padding-left":"35px"},class:"custom-tree-node"},e[71]||(e[71]=[i("div",{class:"item"}," 未分类 ",-1)]))])],2)]),t(xe,{ref_key:"treeSelect",ref:te,style:{width:"100%"},data:K.value,"node-key":"id","empty-text":"暂无分类信息","highlight-current":"","current-node-key":s(o).category_id?parseInt(s(o).category_id):void 0,"default-expand-all":"",onNodeClick:E,"expand-on-click-node":!1},{default:a(({node:l,data:m})=>[i("div",{title:m.name,class:"custom-tree-node"},[i("div",wl,[i("p",xl,v(m.name),1)]),i("div",kl,[i("span",{title:"添加子类目",onClick:z(W=>D(m,"child"),["stop"]),class:"iconfont icon-shuzhuang-tianjia"},null,8,Vl),i("span",{title:"修改",onClick:z(W=>D(m),["stop"]),class:"iconfont icon-xiugai"},null,8,Cl),i("span",{title:"删除类目",onClick:z(W=>ce(m),["stop"]),class:"iconfont icon-shuzhuang-shanchu"},null,8,$l)])],8,hl)]),_:1},8,["data","current-node-key"])]),_:1})]),i("div",zl,[t(p,{style:{width:"100%"},plain:"",class:"on noradius",onClick:e[9]||(e[9]=l=>D({name:"",id:0}))},{default:a(()=>e[72]||(e[72]=[i("span",{class:"iconfont icon-liebiao-xinzeng"},null,-1),u(" 新增分类")])),_:1})])],64)):w("",!0),s(o).active==1?(y(),$(N,{key:1},[i("div",Ul,[e[74]||(e[74]=i("span",{class:"title"},"店铺",-1)),t(p,{onClick:e[10]||(e[10]=l=>E({id:void 0})),class:"on noradius",plain:""},{default:a(()=>e[73]||(e[73]=[i("span",{class:"iconfont icon-anniu-zhankai"},null,-1),u(" 查看全部 ")])),_:1})]),i("div",Sl,[t(Q,null,{default:a(()=>[t(xe,{ref_key:"treeSelect1",ref:Be,style:{width:"100%"},data:ee.value,"node-key":"id","empty-text":"暂无店铺信息","highlight-current":"","current-node-key":s(o).shop_id?parseInt(s(o).shop_id):void 0,"default-expand-all":"",onNodeClick:E,"expand-on-click-node":!1},{default:a(({node:l,data:m})=>[i("div",{title:m.name+"("+m.platform_name+")",class:"custom-tree-node"},[i("div",ql,[t(me,{type:"treedianpu",width:"20",height:"20"}),i("p",Tl,v(m.name+"("+m.platform_name+")"),1)]),i("div",Fl,[i("span",{title:"修改",onClick:z(W=>D(m),["stop"]),class:"iconfont icon-xiugai"},null,8,jl),i("span",{title:"删除店铺",onClick:z(W=>ce(m),["stop"]),class:"iconfont icon-shuzhuang-shanchu"},null,8,Kl)])],8,Rl)]),_:1},8,["data","current-node-key"])]),_:1})]),i("div",El,[t(p,{style:{width:"100%"},plain:"",class:"on noradius",onClick:e[11]||(e[11]=l=>D({name:"",id:0}))},{default:a(()=>e[75]||(e[75]=[i("span",{class:"iconfont icon-liebiao-xinzeng"},null,-1),u(" 新增店铺")])),_:1})])],64)):w("",!0)]),fe(i("div",Bl,[i("div",Dl,[t(M,{model:s(o),ref:"searchFormRef",inline:"",class:"demo-form-inline"},{default:a(()=>[t(f,{style:{width:"240px"},label:"分类",prop:"is_modified"},{default:a(()=>[t(ue,{modelValue:s(o).category_id,"onUpdate:modelValue":e[12]||(e[12]=l=>s(o).category_id=l),filterable:"","check-strictly":"",props:{children:"children",label:"name",value:"id"},"default-expand-all":!0,"check-on-click-node":!0,data:K.value},{default:a(({node:l,data:m})=>[i("span",null,v(m.name),1)]),_:1},8,["modelValue","data"])]),_:1}),t(f,{style:{width:"calc(20% - 16px)","margin-right":"16px"},label:"商品SKU",prop:"sku"},{default:a(()=>[t(x,{modelValue:s(o).sku,"onUpdate:modelValue":e[13]||(e[13]=l=>s(o).sku=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(f,{style:{width:"calc(20% - 16px)","margin-right":"16px"},label:"商品编码",prop:"goods_code"},{default:a(()=>[t(x,{modelValue:s(o).goods_code,"onUpdate:modelValue":e[14]||(e[14]=l=>s(o).goods_code=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(f,{style:{width:"calc(20% - 16px)","margin-right":"16px"},label:"套装标记",prop:"suite_flag"},{default:a(()=>[t(T,{modelValue:s(o).suite_flag,"onUpdate:modelValue":e[15]||(e[15]=l=>s(o).suite_flag=l),placeholder:"请选择"},{default:a(()=>[t(C,{label:"套装",value:!0}),t(C,{label:"无",value:!1})]),_:1},8,["modelValue"])]),_:1}),t(f,{style:{width:"calc(20% - 16px)","margin-right":"16px"},label:"销售状态",prop:"on_sale_flag"},{default:a(()=>[t(T,{modelValue:s(o).on_sale_flag,"onUpdate:modelValue":e[16]||(e[16]=l=>s(o).on_sale_flag=l),placeholder:"请选择"},{default:a(()=>[t(C,{label:"上架",value:!0}),t(C,{label:"下架",value:!1})]),_:1},8,["modelValue"])]),_:1}),t(f,{style:{width:"calc(20% - 16px)","margin-right":"16px"},label:"推荐标记",prop:"recommend_flag"},{default:a(()=>[t(T,{modelValue:s(o).recommend_flag,"onUpdate:modelValue":e[17]||(e[17]=l=>s(o).recommend_flag=l),placeholder:"请选择"},{default:a(()=>[t(C,{label:"推荐",value:!0}),t(C,{label:"无",value:!1})]),_:1},8,["modelValue"])]),_:1}),t(f,{style:{width:"calc(20% - 16px)","margin-right":"16px"},label:"是否关联档案",prop:"is_empty_profile"},{default:a(()=>[t(T,{modelValue:s(o).is_empty_profile,"onUpdate:modelValue":e[18]||(e[18]=l=>s(o).is_empty_profile=l),placeholder:"请选择"},{default:a(()=>[t(C,{label:"没有关联",value:!0}),t(C,{label:"有关联",value:!1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),i("div",Ll,[fe((y(),$("span",{onClick:e[19]||(e[19]=l=>{P.value==0?P.value=67:P.value=0,L.value&&L.value.update()}),class:"c-search-openbtn"},e[76]||(e[76]=[i("span",{class:"iconfont icon-anniu-zhankai"},null,-1),i("span",{class:"opentext"},"展开",-1),i("span",{class:"closetext"},"收起",-1)]))),[[Ne]]),t(p,{onClick:e[20]||(e[20]=l=>h("init")),type:"primary"},{default:a(()=>e[77]||(e[77]=[u("查询")])),_:1}),t(p,{onClick:e[21]||(e[21]=l=>A()),plain:""},{default:a(()=>e[78]||(e[78]=[u("重置")])),_:1})])]),i("div",Ml,[i("div",Nl,[t(re,{"tooltip-effect":"light",border:"","max-height":s(U).getters.innerHeight-294-P.value,data:s(Y),style:{width:"100%"},ref_key:"tableRef",ref:L},{empty:a(l=>[i("div",Jl,[t(me,{type:"empzwssjg",width:"100",height:"100"}),e[81]||(e[81]=u("暂无数据~~ "))])]),default:a(()=>[t(_,{prop:"sku",width:"140",label:"商品SKU"}),t(_,{width:"100",align:"center",label:"套装标记"},{default:a(l=>[u(v(l.row.suite_flag?"套装":"无"),1)]),_:1}),t(_,{width:"100",align:"center",label:"销售状态"},{default:a(l=>[u(v(l.row.on_sale_flag?"上架":"下架"),1)]),_:1}),t(_,{width:"100",align:"center",label:"推荐标记"},{default:a(l=>[u(v(l.row.recommend_flag?"推荐":"无"),1)]),_:1}),t(_,{width:"160",label:"分类"},{default:a(l=>[u(v(l.row.goods_category_name),1)]),_:1}),t(_,{label:"关联档案名称"},{default:a(l=>[l.row.profiles_name?(y(),k(De,{key:0,placement:"top-start",width:500,trigger:"hover"},{reference:a(()=>[i("div",Al,v(l.row.profiles_name),1)]),default:a(()=>[i("div",Hl,[t(Q,{"max-height":"400"},{default:a(()=>[i("div",{innerHTML:l.row.profiles_name,style:{margin:"0 20px"}},null,8,Il)]),_:2},1024)])]),_:2},1024)):w("",!0)]),_:1}),t(_,{width:"160",label:"店铺"},{default:a(l=>[u(v(l.row.shop_name),1)]),_:1}),t(_,{width:"160",align:"center",label:"添加时间"},{default:a(l=>[u(v(s(G)(l.row.created_at)),1)]),_:1}),t(_,{width:"160",align:"center",label:"修改时间"},{default:a(l=>[u(v(s(G)(l.row.updated_at)),1)]),_:1}),t(_,{width:"160",align:"center",label:"操作"},{default:a(l=>[i("div",{onClick:m=>I(l.row),class:"c-table-ibtn"},e[79]||(e[79]=[i("span",{class:"iconfont icon-xiugai"},null,-1),u(" 修改 ")]),8,Ol),i("div",{onClick:m=>_e(l.row),class:"c-table-ibtn c-btn-del"},e[80]||(e[80]=[i("span",{class:"iconfont icon-shuzhuang-shanchu"},null,-1),u(" 删除 ")]),8,Pl)]),_:1})]),_:1},8,["max-height","data"]),S.value>0?(y(),$("div",Ql,[t(ke,{"hide-on-single-page":!1,background:"","page-size":s(o).pagesize,"current-page":s(o).page,onSizeChange:e[22]||(e[22]=l=>{s(o).pagesize=l,s(o).page=Math.min(Math.ceil(S.value/s(o).pagesize),s(o).page),h()}),onCurrentChange:e[23]||(e[23]=l=>{s(o).page=l,L.value&&L.value.scrollTo(0,0),h()}),"page-sizes":[30,50,100,900],layout:"total,sizes,jumper,prev, pager, next",total:S.value},null,8,["page-size","current-page","total"])])):w("",!0)])])],512),[[Ce,s(o).active==1]]),fe((y(),$("div",Wl,[i("div",Gl,[t(M,{model:s(o),ref:"searchFormRef1",inline:"",class:"demo-form-inline"},{default:a(()=>[t(f,{label:"商品编码",prop:"goods_code"},{default:a(()=>[t(x,{modelValue:s(o).goods_code,"onUpdate:modelValue":e[24]||(e[24]=l=>s(o).goods_code=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(f,{label:"商品条码",prop:"barcode"},{default:a(()=>[t(x,{modelValue:s(o).barcode,"onUpdate:modelValue":e[25]||(e[25]=l=>s(o).barcode=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(f,{label:"商品名称",prop:"name"},{default:a(()=>[t(x,{modelValue:s(o).name,"onUpdate:modelValue":e[26]||(e[26]=l=>s(o).name=l),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),i("div",Xl,[t(p,{onClick:e[27]||(e[27]=l=>h("init")),type:"primary"},{default:a(()=>e[82]||(e[82]=[u("查询")])),_:1}),t(p,{onClick:e[28]||(e[28]=l=>A()),plain:""},{default:a(()=>e[83]||(e[83]=[u("重置")])),_:1})])]),i("div",Yl,[i("div",Zl,[t(re,{"tooltip-effect":"light",ref_key:"tableRef2",ref:ne,border:"",data:s(Y),"max-height":s(U).getters.innerHeight-294,style:{width:"100%"}},{empty:a(l=>[i("div",st,[t(me,{type:"empzwssjg",width:"100",height:"100"}),e[86]||(e[86]=u("暂无数据~~ "))])]),default:a(()=>[t(_,{prop:"id",width:"160",label:"商品id"}),t(_,{width:"160",label:"商品编码"},{default:a(l=>[i("div",et,v(l.row.goods_code),1)]),_:1}),t(_,{width:"160",label:"商品条码"},{default:a(l=>[i("div",lt,v(l.row.barcode),1)]),_:1}),t(_,{width:"160",label:"分类"},{default:a(l=>[i("div",tt,v(l.row.category_name),1)]),_:1}),t(_,{label:"商品名称"},{default:a(l=>[i("div",ot,v(l.row.name),1)]),_:1}),t(_,{width:"160",align:"center",label:"添加时间"},{default:a(l=>[u(v(s(G)(l.row.created_at)),1)]),_:1}),t(_,{width:"160",align:"center",label:"修改时间"},{default:a(l=>[u(v(s(G)(l.row.updated_at)),1)]),_:1}),t(_,{width:"160",align:"center",label:"操作"},{default:a(l=>[i("div",{onClick:m=>I(l.row),class:"c-table-ibtn"},e[84]||(e[84]=[i("span",{class:"iconfont icon-xiugai"},null,-1),u(" 修改 ")]),8,at),i("div",{onClick:m=>_e(l.row),class:"c-table-ibtn c-btn-del"},e[85]||(e[85]=[i("span",{class:"iconfont icon-shuzhuang-shanchu"},null,-1),u(" 删除 ")]),8,it)]),_:1})]),_:1},8,["data","max-height"]),S.value>0?(y(),$("div",nt,[t(ke,{"hide-on-single-page":!1,background:"","page-size":s(o).pagesize,"current-page":s(o).page,onSizeChange:e[29]||(e[29]=l=>{s(o).pagesize=l,s(o).page=Math.min(Math.ceil(S.value/s(o).pagesize),s(o).page),h()}),onCurrentChange:e[30]||(e[30]=l=>{s(o).page=l,ne.value&&ne.value.scrollTo(0,0),h()}),"page-sizes":[30,50,100,900],layout:"total,sizes,jumper,prev, pager, next",total:S.value},null,8,["page-size","current-page","total"])])):w("",!0)])])])),[[Ae],[Ce,s(o).active==2]])])]),t(Le,{modelValue:R.value,"onUpdate:modelValue":e[51]||(e[51]=l=>R.value=l),onClosed:e[52]||(e[52]=l=>R.value=!1),title:(d.value.id?"修改":"新增")+(s(o).active==1?"店铺商品":"商品档案"),size:s(o).active==1?"90%":"800px",direction:"rtl"},{default:a(()=>[i("div",dt,[t(Q,null,{default:a(()=>[s(o).active==2?(y(),k(M,{key:0,onSubmit:e[36]||(e[36]=z(()=>{},["prevent"])),inline:"","label-position":"top","label-width":"auto",ref_key:"ruleFormRef",ref:j,model:d.value},{default:a(()=>[t(f,{style:{width:"calc(50% - 8px)","margin-right":"16px"},label:"商品id",prop:"id"},{default:a(()=>[t(x,{modelValue:d.value.id,"onUpdate:modelValue":e[31]||(e[31]=l=>d.value.id=l),disabled:"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(f,{style:{width:"calc(50% - 8px)","margin-right":"0px"},label:"商品编码",prop:"goods_code"},{default:a(()=>[t(x,{modelValue:d.value.goods_code,"onUpdate:modelValue":e[32]||(e[32]=l=>d.value.goods_code=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(f,{style:{width:"calc(50% - 8px)","margin-right":"16px"},label:"商品条码",prop:"barcode"},{default:a(()=>[t(x,{modelValue:d.value.barcode,"onUpdate:modelValue":e[33]||(e[33]=l=>d.value.barcode=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(f,{style:{width:"calc(50% - 8px)","margin-right":"0px"},label:"商品类目",prop:"category_id"},{default:a(()=>[t(ue,{modelValue:d.value.category_id,"onUpdate:modelValue":e[34]||(e[34]=l=>d.value.category_id=l),filterable:"","check-strictly":"",props:{children:"children",label:"name",value:"id"},"default-expand-all":!0,"check-on-click-node":!0,data:K.value,style:{width:"100%"}},{default:a(({node:l,data:m})=>[i("span",null,v(m.name),1)]),_:1},8,["modelValue","data"])]),_:1}),t(f,{style:{width:"100%","margin-right":"0"},rules:[{required:!0,message:"请输入商品名称",trigger:"blur"}],label:"商品名称",prop:"goods_name"},{default:a(()=>[t(x,{modelValue:d.value.goods_name,"onUpdate:modelValue":e[35]||(e[35]=l=>d.value.goods_name=l),type:"textarea",autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])):w("",!0),s(o).active==1?(y(),k(M,{key:1,onSubmit:e[48]||(e[48]=z(()=>{},["prevent"])),inline:"","label-position":"top","label-width":"auto",ref_key:"ruleFormRef",ref:j,model:d.value},{default:a(()=>[t(f,{style:{width:"calc(20% - 16px)","margin-right":"16px"},label:"商品SKU",rules:[{required:!0,message:"请输入商品SKU",trigger:"blur"}],prop:"sku"},{default:a(()=>[t(x,{modelValue:d.value.sku,"onUpdate:modelValue":e[37]||(e[37]=l=>d.value.sku=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(f,{style:{width:"calc(20% - 16px)","margin-right":"16px"},label:"店铺",prop:"shop_id"},{default:a(()=>[t(T,{modelValue:d.value.shop_id,"onUpdate:modelValue":e[38]||(e[38]=l=>d.value.shop_id=l),placeholder:""},{default:a(()=>[(y(!0),$(N,null,Ue(ee.value,l=>(y(),k(C,{label:l.name,value:l.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),t(f,{style:{width:"calc(20% - 16px)","margin-right":"16px"},label:"商品类目",prop:"category_id"},{default:a(()=>[t(ue,{modelValue:d.value.category_id,"onUpdate:modelValue":e[39]||(e[39]=l=>d.value.category_id=l),filterable:"","check-strictly":"",props:{children:"children",label:"name",value:"id"},"default-expand-all":!0,"check-on-click-node":!0,data:K.value,style:{width:"100%"}},{default:a(({node:l,data:m})=>[i("span",null,v(m.name),1)]),_:1},8,["modelValue","data"])]),_:1}),t(f,{class:"c-switchbox-label",style:{width:"calc(13.33% - 11px)","margin-right":"16px"},label:"套装标记",prop:"suite_flag"},{default:a(()=>[i("div",ut,[e[87]||(e[87]=i("div",{class:"label"},null,-1)),i("div",rt,[t(pe,{disabled:"",modelValue:d.value.suite_flag,"onUpdate:modelValue":e[40]||(e[40]=l=>d.value.suite_flag=l),"inline-prompt":"","active-text":"套装","inactive-text":"无"},null,8,["modelValue"])])])]),_:1}),t(f,{class:"c-switchbox-label",style:{width:"calc(13.33% - 11px)","margin-right":"16px"},label:"销售状态",prop:"on_sale_flag"},{default:a(()=>[i("div",pt,[e[88]||(e[88]=i("div",{class:"label"},null,-1)),i("div",ft,[t(pe,{modelValue:d.value.on_sale_flag,"onUpdate:modelValue":e[41]||(e[41]=l=>d.value.on_sale_flag=l),"inline-prompt":"","active-text":"上架","inactive-text":"下架"},null,8,["modelValue"])])])]),_:1}),t(f,{class:"c-switchbox-label",style:{width:"calc(13.34% - 10px)","margin-right":"0px"},label:"推荐标记",prop:"recommend_flag"},{default:a(()=>[i("div",mt,[e[89]||(e[89]=i("div",{class:"label"},null,-1)),i("div",ct,[t(pe,{modelValue:d.value.recommend_flag,"onUpdate:modelValue":e[42]||(e[42]=l=>d.value.recommend_flag=l),"inline-prompt":"","active-text":"推荐","inactive-text":"无"},null,8,["modelValue"])])])]),_:1}),e[93]||(e[93]=i("br",null,null,-1)),t(f,{style:{width:"calc(20% - 16px)","margin-right":"16px"},label:"零售价",prop:"price"},{default:a(()=>[t(Ve,{style:{width:"100%"},onFocus:e[43]||(e[43]=l=>{l.target.select()}),controls:!1,min:0,precision:2,placeholder:"请输入零售价",modelValue:d.value.price,"onUpdate:modelValue":e[44]||(e[44]=l=>d.value.price=l)},null,8,["modelValue"])]),_:1}),e[94]||(e[94]=i("br",null,null,-1)),t(f,{style:{width:"calc(80%)","margin-right":"0px"},label:"商品卖点",prop:"sale_point"},{default:a(()=>[t(x,{modelValue:d.value.sale_point,"onUpdate:modelValue":e[45]||(e[45]=l=>d.value.sale_point=l),type:"input",autocomplete:"off"},null,8,["modelValue"])]),_:1}),i("div",_t,[e[91]||(e[91]=i("div",{class:"ltitle"},"关联档案",-1)),i("div",vt,[t(x,{modelValue:F.value,"onUpdate:modelValue":e[46]||(e[46]=l=>F.value=l),style:{width:"100%"},placeholder:"商品编码，条码",autocomplete:"off"},null,8,["modelValue"]),t(p,{style:{position:"absolute",right:"0",top:"0","border-radius":"8px"},onClick:e[47]||(e[47]=l=>Fe()),type:"primary"},{default:a(()=>e[90]||(e[90]=[u("新增")])),_:1})])]),i("div",gt,[t(re,{"tooltip-effect":"light",border:"",data:d.value.profile_tuple,style:{width:"100%"}},{default:a(()=>[t(_,{width:"120",label:"商品id"},{default:a(l=>[u(v(l.row.id),1)]),_:1}),t(_,{width:"120",label:"商品编码"},{default:a(l=>[u(v(l.row.goods_code),1)]),_:1}),t(_,{width:"120",label:"商品条码"},{default:a(l=>[u(v(l.row.barcode),1)]),_:1}),t(_,{width:"220",label:"配置数量"},{default:a(l=>[t(Ve,{onChange:se,controls:!1,min:1,precision:0,placeholder:"",modelValue:l.row.quantity,"onUpdate:modelValue":m=>l.row.quantity=m},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(_,{label:"商品名称"},{default:a(l=>[u(v(l.row.name),1)]),_:1}),t(_,{width:"120",label:"操作"},{default:a(l=>[t(f,null,{default:a(()=>[i("div",{onClick:m=>{d.value.profile_tuple.splice(l.$index,1),se()},class:"c-table-ibtn c-btn-del"},e[92]||(e[92]=[i("span",{class:"iconfont icon-shuzhuang-shanchu"},null,-1),u(" 删除 ")]),8,bt)]),_:2},1024)]),_:1})]),_:1},8,["data"])])]),_:1},8,["model"])):w("",!0)]),_:1})]),i("div",yt,[t(p,{type:"primary",onClick:e[49]||(e[49]=l=>je(j.value))},{default:a(()=>e[95]||(e[95]=[u(" 保存 ")])),_:1}),t(p,{plain:"",onClick:e[50]||(e[50]=l=>R.value=!1)},{default:a(()=>e[96]||(e[96]=[u(" 取消 ")])),_:1})])]),_:1},8,["modelValue","title","size"]),t(Me,{"align-center":"",modelValue:q.value,"onUpdate:modelValue":e[59]||(e[59]=l=>q.value=l),title:B.value,width:"600"},{footer:a(()=>[i("div",ht,[t(p,{onClick:e[57]||(e[57]=l=>q.value=!1)},{default:a(()=>e[97]||(e[97]=[u("取消")])),_:1}),t(p,{type:"primary",onClick:e[58]||(e[58]=l=>ge(Z.value))},{default:a(()=>e[98]||(e[98]=[u(" 确定提交 ")])),_:1})])]),default:a(()=>[t(M,{onSubmit:e[55]||(e[55]=z(()=>{},["prevent"])),model:c.value,"label-width":"100",onKeyup:e[56]||(e[56]=Je(l=>ge(Z.value),["native","enter"])),ref_key:"addFormRef",ref:Z},{default:a(()=>[t(f,{label:"名称",rules:[{required:!0,message:"请输入名称",trigger:"blur"}],prop:"shop_name"},{default:a(()=>[t(x,{class:"c-focus-inp",modelValue:c.value.shop_name,"onUpdate:modelValue":e[53]||(e[53]=l=>c.value.shop_name=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),s(o).active==1?(y(),k(f,{key:0,label:"平台",rules:[{required:!0,message:"请选择平台",trigger:"change"}],prop:"platform_id"},{default:a(()=>[t(T,{modelValue:c.value.platform_id,"onUpdate:modelValue":e[54]||(e[54]=l=>c.value.platform_id=l),placeholder:""},{default:a(()=>[(y(!0),$(N,null,Ue(be.value,l=>(y(),k(C,{label:l.name,value:l.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})):w("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}},St=Qe(wt,[["__scopeId","data-v-d7046d32"]]);export{St as default};
