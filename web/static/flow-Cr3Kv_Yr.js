import{y as st,f as Ei,i as mn,ao as Si,j as Ge,G as ia,U as cl,z,R as h,C as dt,J as N,B as s,u as Y,g as Un,l as sa,c as Oe,o as ao,r as q,a2 as aa,h as Et,A as y,Q as be,a6 as Fe,D as it,n as Ot,X as Ci,L as B,aU as da,I as ie,H as ot,E as Me,P as oe,k as pl,af as ra,m as ua,v as pn,al as We,ab as et,aV as Qe,V as ca,aW as Ni,an as dn,M as an,O as G,F as pa,e as fa,a1 as va,ar as zi,K as je,W as Se,S as Ke,aR as ga,aS as ma}from"./vue-CdYMfVVj.js";import{g as Oo}from"./comp-ClzPtuSi.js";import{_ as Mi,u as Ii,l as He,O as ha,T as ya,t as _a,U as wa,V as xa,E as ba,M as ka,W as Dl,i as Tl,X as Va,Y as $a,Z as Ea}from"./index-B6WbZO8q.js";import{v as Sa,i as Ca,b as Na,c as za,d as Al}from"./validator-CP7pvMcK.js";import{E as ye,t as Ma,C as Ia}from"./list-BbxMWpnt.js";import{c as Da,r as Ta}from"./result-CcYZ99eM.js";import{v as Aa}from"./v4-D8aEg3BZ.js";import"./element-GwJlJi_X.js";import"./editor-Dhn2M38E.js";import"./editor.api-_A1huWdg.js";import"./list.vue_vue_type_style_index_1_lang-B8pmpZgU.js";function bo(e){return Ei()?(ao(e),!0):!1}function At(e){return typeof e=="function"?e():Y(e)}const Pa=typeof window<"u"&&typeof document<"u",Oa=e=>typeof e<"u",Ua=Object.prototype.toString,Ba=e=>Ua.call(e)==="[object Object]",Ra=()=>{};function Ha(e,n){function t(...o){return new Promise((l,a)=>{Promise.resolve(e(()=>n.apply(this,o),{fn:n,thisArg:this,args:o})).then(l).catch(a)})}return t}const Di=e=>e();function La(e=Di){const n=q(!0);function t(){n.value=!1}function o(){n.value=!0}const l=(...a)=>{n.value&&e(...a)};return{isActive:fa(n),pause:t,resume:o,eventFilter:l}}function Pl(e,n=!1,t="Timeout"){return new Promise((o,l)=>{setTimeout(n?()=>l(t):o,e)})}function Fa(e,n,t={}){const{eventFilter:o=Di,...l}=t;return Ge(e,Ha(o,n),l)}function sn(e,n,t={}){const{eventFilter:o,...l}=t,{eventFilter:a,pause:r,resume:u,isActive:f}=La(o);return{stop:Fa(e,n,{...l,eventFilter:a}),pause:r,resume:u,isActive:f}}function qa(e,n={}){if(!pl(e))return ra(e);const t=Array.isArray(e.value)?Array.from({length:e.value.length}):{};for(const o in e.value)t[o]=ua(()=>({get(){return e.value[o]},set(l){var a;if((a=At(n.replaceRef))!=null?a:!0)if(Array.isArray(e.value)){const u=[...e.value];u[o]=l,e.value=u}else{const u={...e.value,[o]:l};Object.setPrototypeOf(u,Object.getPrototypeOf(e.value)),e.value=u}else e.value[o]=l}}));return t}function jo(e,n=!1){function t(_,{flush:x="sync",deep:C=!1,timeout:P,throwOnTimeout:T}={}){let I=null;const R=[new Promise(k=>{I=Ge(e,D=>{_(D)!==n&&(I==null||I(),k(D))},{flush:x,deep:C,immediate:!0})})];return P!=null&&R.push(Pl(P,T).then(()=>At(e)).finally(()=>I==null?void 0:I())),Promise.race(R)}function o(_,x){if(!pl(_))return t(D=>D===_,x);const{flush:C="sync",deep:P=!1,timeout:T,throwOnTimeout:I}=x??{};let A=null;const k=[new Promise(D=>{A=Ge([e,_],([K,ge])=>{n!==(K===ge)&&(A==null||A(),D(K))},{flush:C,deep:P,immediate:!0})})];return T!=null&&k.push(Pl(T,I).then(()=>At(e)).finally(()=>(A==null||A(),At(e)))),Promise.race(k)}function l(_){return t(x=>!!x,_)}function a(_){return o(null,_)}function r(_){return o(void 0,_)}function u(_){return t(Number.isNaN,_)}function f(_,x){return t(C=>{const P=Array.from(C);return P.includes(_)||P.includes(At(_))},x)}function v(_){return g(1,_)}function g(_=1,x){let C=-1;return t(()=>(C+=1,C>=_),x)}return Array.isArray(At(e))?{toMatch:t,toContains:f,changed:v,changedTimes:g,get not(){return jo(e,!n)}}:{toMatch:t,toBe:o,toBeTruthy:l,toBeNull:a,toBeNaN:u,toBeUndefined:r,changed:v,changedTimes:g,get not(){return jo(e,!n)}}}function Wo(e){return jo(e)}function Ga(e){var n;const t=At(e);return(n=t==null?void 0:t.$el)!=null?n:t}const Ti=Pa?window:void 0;function Ai(...e){let n,t,o,l;if(typeof e[0]=="string"||Array.isArray(e[0])?([t,o,l]=e,n=Ti):[n,t,o,l]=e,!n)return Ra;Array.isArray(t)||(t=[t]),Array.isArray(o)||(o=[o]);const a=[],r=()=>{a.forEach(g=>g()),a.length=0},u=(g,_,x,C)=>(g.addEventListener(_,x,C),()=>g.removeEventListener(_,x,C)),f=Ge(()=>[Ga(n),At(l)],([g,_])=>{if(r(),!g)return;const x=Ba(_)?{..._}:_;a.push(...t.flatMap(C=>o.map(P=>u(g,C,P,x))))},{immediate:!0,flush:"post"}),v=()=>{f(),r()};return bo(v),v}function Ya(e){return typeof e=="function"?e:typeof e=="string"?n=>n.key===e:Array.isArray(e)?n=>e.includes(n.key):()=>!0}function Ol(...e){let n,t,o={};e.length===3?(n=e[0],t=e[1],o=e[2]):e.length===2?typeof e[1]=="object"?(n=!0,t=e[0],o=e[1]):(n=e[0],t=e[1]):(n=!0,t=e[0]);const{target:l=Ti,eventName:a="keydown",passive:r=!1,dedupe:u=!1}=o,f=Ya(n);return Ai(l,a,g=>{g.repeat&&At(u)||f(g)&&t(g)},r)}function Xa(e){return JSON.parse(JSON.stringify(e))}function Uo(e,n,t,o={}){var l,a,r;const{clone:u=!1,passive:f=!1,eventName:v,deep:g=!1,defaultValue:_,shouldEmit:x}=o,C=Un(),P=t||(C==null?void 0:C.emit)||((l=C==null?void 0:C.$emit)==null?void 0:l.bind(C))||((r=(a=C==null?void 0:C.proxy)==null?void 0:a.$emit)==null?void 0:r.bind(C==null?void 0:C.proxy));let T=v;n||(n="modelValue"),T=T||`update:${n.toString()}`;const I=k=>u?typeof u=="function"?u(k):Xa(k):k,A=()=>Oa(e[n])?I(e[n]):_,R=k=>{x?x(k)&&P(T,k):P(T,k)};if(f){const k=A(),D=q(k);let K=!1;return Ge(()=>e[n],ge=>{K||(K=!0,D.value=I(ge),Ot(()=>K=!1))}),Ge(D,ge=>{!K&&(ge!==e[n]||g)&&R(ge)},{deep:g}),D}else return Oe({get(){return A()},set(k){R(k)}})}var Za={value:()=>{}};function ko(){for(var e=0,n=arguments.length,t={},o;e<n;++e){if(!(o=arguments[e]+"")||o in t||/[\s.]/.test(o))throw new Error("illegal type: "+o);t[o]=[]}return new ro(t)}function ro(e){this._=e}function ja(e,n){return e.trim().split(/^|\s+/).map(function(t){var o="",l=t.indexOf(".");if(l>=0&&(o=t.slice(l+1),t=t.slice(0,l)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:o}})}ro.prototype=ko.prototype={constructor:ro,on:function(e,n){var t=this._,o=ja(e+"",t),l,a=-1,r=o.length;if(arguments.length<2){for(;++a<r;)if((l=(e=o[a]).type)&&(l=Wa(t[l],e.name)))return l;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++a<r;)if(l=(e=o[a]).type)t[l]=Ul(t[l],e.name,n);else if(n==null)for(l in t)t[l]=Ul(t[l],e.name,null);return this},copy:function(){var e={},n=this._;for(var t in n)e[t]=n[t].slice();return new ro(e)},call:function(e,n){if((l=arguments.length-2)>0)for(var t=new Array(l),o=0,l,a;o<l;++o)t[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],o=0,l=a.length;o<l;++o)a[o].value.apply(n,t)},apply:function(e,n,t){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],l=0,a=o.length;l<a;++l)o[l].value.apply(n,t)}};function Wa(e,n){for(var t=0,o=e.length,l;t<o;++t)if((l=e[t]).name===n)return l.value}function Ul(e,n,t){for(var o=0,l=e.length;o<l;++o)if(e[o].name===n){e[o]=Za,e=e.slice(0,o).concat(e.slice(o+1));break}return t!=null&&e.push({name:n,value:t}),e}var Ko="http://www.w3.org/1999/xhtml";const Bl={svg:"http://www.w3.org/2000/svg",xhtml:Ko,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Vo(e){var n=e+="",t=n.indexOf(":");return t>=0&&(n=e.slice(0,t))!=="xmlns"&&(e=e.slice(t+1)),Bl.hasOwnProperty(n)?{space:Bl[n],local:e}:e}function Ka(e){return function(){var n=this.ownerDocument,t=this.namespaceURI;return t===Ko&&n.documentElement.namespaceURI===Ko?n.createElement(e):n.createElementNS(t,e)}}function Ja(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Pi(e){var n=Vo(e);return(n.local?Ja:Ka)(n)}function Qa(){}function fl(e){return e==null?Qa:function(){return this.querySelector(e)}}function ed(e){typeof e!="function"&&(e=fl(e));for(var n=this._groups,t=n.length,o=new Array(t),l=0;l<t;++l)for(var a=n[l],r=a.length,u=o[l]=new Array(r),f,v,g=0;g<r;++g)(f=a[g])&&(v=e.call(f,f.__data__,g,a))&&("__data__"in f&&(v.__data__=f.__data__),u[g]=v);return new xt(o,this._parents)}function td(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function nd(){return[]}function Oi(e){return e==null?nd:function(){return this.querySelectorAll(e)}}function od(e){return function(){return td(e.apply(this,arguments))}}function ld(e){typeof e=="function"?e=od(e):e=Oi(e);for(var n=this._groups,t=n.length,o=[],l=[],a=0;a<t;++a)for(var r=n[a],u=r.length,f,v=0;v<u;++v)(f=r[v])&&(o.push(e.call(f,f.__data__,v,r)),l.push(f));return new xt(o,l)}function Ui(e){return function(){return this.matches(e)}}function Bi(e){return function(n){return n.matches(e)}}var id=Array.prototype.find;function sd(e){return function(){return id.call(this.children,e)}}function ad(){return this.firstElementChild}function dd(e){return this.select(e==null?ad:sd(typeof e=="function"?e:Bi(e)))}var rd=Array.prototype.filter;function ud(){return Array.from(this.children)}function cd(e){return function(){return rd.call(this.children,e)}}function pd(e){return this.selectAll(e==null?ud:cd(typeof e=="function"?e:Bi(e)))}function fd(e){typeof e!="function"&&(e=Ui(e));for(var n=this._groups,t=n.length,o=new Array(t),l=0;l<t;++l)for(var a=n[l],r=a.length,u=o[l]=[],f,v=0;v<r;++v)(f=a[v])&&e.call(f,f.__data__,v,a)&&u.push(f);return new xt(o,this._parents)}function Ri(e){return new Array(e.length)}function vd(){return new xt(this._enter||this._groups.map(Ri),this._parents)}function fo(e,n){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=n}fo.prototype={constructor:fo,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,n){return this._parent.insertBefore(e,n)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function gd(e){return function(){return e}}function md(e,n,t,o,l,a){for(var r=0,u,f=n.length,v=a.length;r<v;++r)(u=n[r])?(u.__data__=a[r],o[r]=u):t[r]=new fo(e,a[r]);for(;r<f;++r)(u=n[r])&&(l[r]=u)}function hd(e,n,t,o,l,a,r){var u,f,v=new Map,g=n.length,_=a.length,x=new Array(g),C;for(u=0;u<g;++u)(f=n[u])&&(x[u]=C=r.call(f,f.__data__,u,n)+"",v.has(C)?l[u]=f:v.set(C,f));for(u=0;u<_;++u)C=r.call(e,a[u],u,a)+"",(f=v.get(C))?(o[u]=f,f.__data__=a[u],v.delete(C)):t[u]=new fo(e,a[u]);for(u=0;u<g;++u)(f=n[u])&&v.get(x[u])===f&&(l[u]=f)}function yd(e){return e.__data__}function _d(e,n){if(!arguments.length)return Array.from(this,yd);var t=n?hd:md,o=this._parents,l=this._groups;typeof e!="function"&&(e=gd(e));for(var a=l.length,r=new Array(a),u=new Array(a),f=new Array(a),v=0;v<a;++v){var g=o[v],_=l[v],x=_.length,C=wd(e.call(g,g&&g.__data__,v,o)),P=C.length,T=u[v]=new Array(P),I=r[v]=new Array(P),A=f[v]=new Array(x);t(g,_,T,I,A,C,n);for(var R=0,k=0,D,K;R<P;++R)if(D=T[R]){for(R>=k&&(k=R+1);!(K=I[k])&&++k<P;);D._next=K||null}}return r=new xt(r,o),r._enter=u,r._exit=f,r}function wd(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function xd(){return new xt(this._exit||this._groups.map(Ri),this._parents)}function bd(e,n,t){var o=this.enter(),l=this,a=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),n!=null&&(l=n(l),l&&(l=l.selection())),t==null?a.remove():t(a),o&&l?o.merge(l).order():l}function kd(e){for(var n=e.selection?e.selection():e,t=this._groups,o=n._groups,l=t.length,a=o.length,r=Math.min(l,a),u=new Array(l),f=0;f<r;++f)for(var v=t[f],g=o[f],_=v.length,x=u[f]=new Array(_),C,P=0;P<_;++P)(C=v[P]||g[P])&&(x[P]=C);for(;f<l;++f)u[f]=t[f];return new xt(u,this._parents)}function Vd(){for(var e=this._groups,n=-1,t=e.length;++n<t;)for(var o=e[n],l=o.length-1,a=o[l],r;--l>=0;)(r=o[l])&&(a&&r.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(r,a),a=r);return this}function $d(e){e||(e=Ed);function n(_,x){return _&&x?e(_.__data__,x.__data__):!_-!x}for(var t=this._groups,o=t.length,l=new Array(o),a=0;a<o;++a){for(var r=t[a],u=r.length,f=l[a]=new Array(u),v,g=0;g<u;++g)(v=r[g])&&(f[g]=v);f.sort(n)}return new xt(l,this._parents).order()}function Ed(e,n){return e<n?-1:e>n?1:e>=n?0:NaN}function Sd(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Cd(){return Array.from(this)}function Nd(){for(var e=this._groups,n=0,t=e.length;n<t;++n)for(var o=e[n],l=0,a=o.length;l<a;++l){var r=o[l];if(r)return r}return null}function zd(){let e=0;for(const n of this)++e;return e}function Md(){return!this.node()}function Id(e){for(var n=this._groups,t=0,o=n.length;t<o;++t)for(var l=n[t],a=0,r=l.length,u;a<r;++a)(u=l[a])&&e.call(u,u.__data__,a,l);return this}function Dd(e){return function(){this.removeAttribute(e)}}function Td(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ad(e,n){return function(){this.setAttribute(e,n)}}function Pd(e,n){return function(){this.setAttributeNS(e.space,e.local,n)}}function Od(e,n){return function(){var t=n.apply(this,arguments);t==null?this.removeAttribute(e):this.setAttribute(e,t)}}function Ud(e,n){return function(){var t=n.apply(this,arguments);t==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}function Bd(e,n){var t=Vo(e);if(arguments.length<2){var o=this.node();return t.local?o.getAttributeNS(t.space,t.local):o.getAttribute(t)}return this.each((n==null?t.local?Td:Dd:typeof n=="function"?t.local?Ud:Od:t.local?Pd:Ad)(t,n))}function Hi(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Rd(e){return function(){this.style.removeProperty(e)}}function Hd(e,n,t){return function(){this.style.setProperty(e,n,t)}}function Ld(e,n,t){return function(){var o=n.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,t)}}function Fd(e,n,t){return arguments.length>1?this.each((n==null?Rd:typeof n=="function"?Ld:Hd)(e,n,t??"")):fn(this.node(),e)}function fn(e,n){return e.style.getPropertyValue(n)||Hi(e).getComputedStyle(e,null).getPropertyValue(n)}function qd(e){return function(){delete this[e]}}function Gd(e,n){return function(){this[e]=n}}function Yd(e,n){return function(){var t=n.apply(this,arguments);t==null?delete this[e]:this[e]=t}}function Xd(e,n){return arguments.length>1?this.each((n==null?qd:typeof n=="function"?Yd:Gd)(e,n)):this.node()[e]}function Li(e){return e.trim().split(/^|\s+/)}function vl(e){return e.classList||new Fi(e)}function Fi(e){this._node=e,this._names=Li(e.getAttribute("class")||"")}Fi.prototype={add:function(e){var n=this._names.indexOf(e);n<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var n=this._names.indexOf(e);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function qi(e,n){for(var t=vl(e),o=-1,l=n.length;++o<l;)t.add(n[o])}function Gi(e,n){for(var t=vl(e),o=-1,l=n.length;++o<l;)t.remove(n[o])}function Zd(e){return function(){qi(this,e)}}function jd(e){return function(){Gi(this,e)}}function Wd(e,n){return function(){(n.apply(this,arguments)?qi:Gi)(this,e)}}function Kd(e,n){var t=Li(e+"");if(arguments.length<2){for(var o=vl(this.node()),l=-1,a=t.length;++l<a;)if(!o.contains(t[l]))return!1;return!0}return this.each((typeof n=="function"?Wd:n?Zd:jd)(t,n))}function Jd(){this.textContent=""}function Qd(e){return function(){this.textContent=e}}function er(e){return function(){var n=e.apply(this,arguments);this.textContent=n??""}}function tr(e){return arguments.length?this.each(e==null?Jd:(typeof e=="function"?er:Qd)(e)):this.node().textContent}function nr(){this.innerHTML=""}function or(e){return function(){this.innerHTML=e}}function lr(e){return function(){var n=e.apply(this,arguments);this.innerHTML=n??""}}function ir(e){return arguments.length?this.each(e==null?nr:(typeof e=="function"?lr:or)(e)):this.node().innerHTML}function sr(){this.nextSibling&&this.parentNode.appendChild(this)}function ar(){return this.each(sr)}function dr(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function rr(){return this.each(dr)}function ur(e){var n=typeof e=="function"?e:Pi(e);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function cr(){return null}function pr(e,n){var t=typeof e=="function"?e:Pi(e),o=n==null?cr:typeof n=="function"?n:fl(n);return this.select(function(){return this.insertBefore(t.apply(this,arguments),o.apply(this,arguments)||null)})}function fr(){var e=this.parentNode;e&&e.removeChild(this)}function vr(){return this.each(fr)}function gr(){var e=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function mr(){var e=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function hr(e){return this.select(e?mr:gr)}function yr(e){return arguments.length?this.property("__data__",e):this.node().__data__}function _r(e){return function(n){e.call(this,n,this.__data__)}}function wr(e){return e.trim().split(/^|\s+/).map(function(n){var t="",o=n.indexOf(".");return o>=0&&(t=n.slice(o+1),n=n.slice(0,o)),{type:n,name:t}})}function xr(e){return function(){var n=this.__on;if(n){for(var t=0,o=-1,l=n.length,a;t<l;++t)a=n[t],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):n[++o]=a;++o?n.length=o:delete this.__on}}}function br(e,n,t){return function(){var o=this.__on,l,a=_r(n);if(o){for(var r=0,u=o.length;r<u;++r)if((l=o[r]).type===e.type&&l.name===e.name){this.removeEventListener(l.type,l.listener,l.options),this.addEventListener(l.type,l.listener=a,l.options=t),l.value=n;return}}this.addEventListener(e.type,a,t),l={type:e.type,name:e.name,value:n,listener:a,options:t},o?o.push(l):this.__on=[l]}}function kr(e,n,t){var o=wr(e+""),l,a=o.length,r;if(arguments.length<2){var u=this.node().__on;if(u){for(var f=0,v=u.length,g;f<v;++f)for(l=0,g=u[f];l<a;++l)if((r=o[l]).type===g.type&&r.name===g.name)return g.value}return}for(u=n?br:xr,l=0;l<a;++l)this.each(u(o[l],n,t));return this}function Yi(e,n,t){var o=Hi(e),l=o.CustomEvent;typeof l=="function"?l=new l(n,t):(l=o.document.createEvent("Event"),t?(l.initEvent(n,t.bubbles,t.cancelable),l.detail=t.detail):l.initEvent(n,!1,!1)),e.dispatchEvent(l)}function Vr(e,n){return function(){return Yi(this,e,n)}}function $r(e,n){return function(){return Yi(this,e,n.apply(this,arguments))}}function Er(e,n){return this.each((typeof n=="function"?$r:Vr)(e,n))}function*Sr(){for(var e=this._groups,n=0,t=e.length;n<t;++n)for(var o=e[n],l=0,a=o.length,r;l<a;++l)(r=o[l])&&(yield r)}var Xi=[null];function xt(e,n){this._groups=e,this._parents=n}function Bn(){return new xt([[document.documentElement]],Xi)}function Cr(){return this}xt.prototype=Bn.prototype={constructor:xt,select:ed,selectAll:ld,selectChild:dd,selectChildren:pd,filter:fd,data:_d,enter:vd,exit:xd,join:bd,merge:kd,selection:Cr,order:Vd,sort:$d,call:Sd,nodes:Cd,node:Nd,size:zd,empty:Md,each:Id,attr:Bd,style:Fd,property:Xd,classed:Kd,text:tr,html:ir,raise:ar,lower:rr,append:ur,insert:pr,remove:vr,clone:hr,datum:yr,on:kr,dispatch:Er,[Symbol.iterator]:Sr};function Vt(e){return typeof e=="string"?new xt([[document.querySelector(e)]],[document.documentElement]):new xt([[e]],Xi)}function Nr(e){let n;for(;n=e.sourceEvent;)e=n;return e}function Ct(e,n){if(e=Nr(e),n===void 0&&(n=e.currentTarget),n){var t=n.ownerSVGElement||n;if(t.createSVGPoint){var o=t.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(n.getScreenCTM().inverse()),[o.x,o.y]}if(n.getBoundingClientRect){var l=n.getBoundingClientRect();return[e.clientX-l.left-n.clientLeft,e.clientY-l.top-n.clientTop]}}return[e.pageX,e.pageY]}const zr={passive:!1},Mn={capture:!0,passive:!1};function Bo(e){e.stopImmediatePropagation()}function rn(e){e.preventDefault(),e.stopImmediatePropagation()}function Zi(e){var n=e.document.documentElement,t=Vt(e).on("dragstart.drag",rn,Mn);"onselectstart"in n?t.on("selectstart.drag",rn,Mn):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function ji(e,n){var t=e.document.documentElement,o=Vt(e).on("dragstart.drag",null);n&&(o.on("click.drag",rn,Mn),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in t?o.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const Jn=e=>()=>e;function Jo(e,{sourceEvent:n,subject:t,target:o,identifier:l,active:a,x:r,y:u,dx:f,dy:v,dispatch:g}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:l,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:r,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:f,enumerable:!0,configurable:!0},dy:{value:v,enumerable:!0,configurable:!0},_:{value:g}})}Jo.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Mr(e){return!e.ctrlKey&&!e.button}function Ir(){return this.parentNode}function Dr(e,n){return n??{x:e.x,y:e.y}}function Tr(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ar(){var e=Mr,n=Ir,t=Dr,o=Tr,l={},a=ko("start","drag","end"),r=0,u,f,v,g,_=0;function x(D){D.on("mousedown.drag",C).filter(o).on("touchstart.drag",I).on("touchmove.drag",A,zr).on("touchend.drag touchcancel.drag",R).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function C(D,K){if(!(g||!e.call(this,D,K))){var ge=k(this,n.call(this,D,K),D,K,"mouse");ge&&(Vt(D.view).on("mousemove.drag",P,Mn).on("mouseup.drag",T,Mn),Zi(D.view),Bo(D),v=!1,u=D.clientX,f=D.clientY,ge("start",D))}}function P(D){if(rn(D),!v){var K=D.clientX-u,ge=D.clientY-f;v=K*K+ge*ge>_}l.mouse("drag",D)}function T(D){Vt(D.view).on("mousemove.drag mouseup.drag",null),ji(D.view,v),rn(D),l.mouse("end",D)}function I(D,K){if(e.call(this,D,K)){var ge=D.changedTouches,ae=n.call(this,D,K),de=ge.length,ve,Q;for(ve=0;ve<de;++ve)(Q=k(this,ae,D,K,ge[ve].identifier,ge[ve]))&&(Bo(D),Q("start",D,ge[ve]))}}function A(D){var K=D.changedTouches,ge=K.length,ae,de;for(ae=0;ae<ge;++ae)(de=l[K[ae].identifier])&&(rn(D),de("drag",D,K[ae]))}function R(D){var K=D.changedTouches,ge=K.length,ae,de;for(g&&clearTimeout(g),g=setTimeout(function(){g=null},500),ae=0;ae<ge;++ae)(de=l[K[ae].identifier])&&(Bo(D),de("end",D,K[ae]))}function k(D,K,ge,ae,de,ve){var Q=a.copy(),le=Ct(ve||ge,K),O,Ee,E;if((E=t.call(D,new Jo("beforestart",{sourceEvent:ge,target:x,identifier:de,active:r,x:le[0],y:le[1],dx:0,dy:0,dispatch:Q}),ae))!=null)return O=E.x-le[0]||0,Ee=E.y-le[1]||0,function F(b,U,j){var te=le,ne;switch(b){case"start":l[de]=F,ne=r++;break;case"end":delete l[de],--r;case"drag":le=Ct(j||U,K),ne=r;break}Q.call(b,D,new Jo(b,{sourceEvent:U,subject:E,target:x,identifier:de,active:ne,x:le[0]+O,y:le[1]+Ee,dx:le[0]-te[0],dy:le[1]-te[1],dispatch:Q}),ae)}}return x.filter=function(D){return arguments.length?(e=typeof D=="function"?D:Jn(!!D),x):e},x.container=function(D){return arguments.length?(n=typeof D=="function"?D:Jn(D),x):n},x.subject=function(D){return arguments.length?(t=typeof D=="function"?D:Jn(D),x):t},x.touchable=function(D){return arguments.length?(o=typeof D=="function"?D:Jn(!!D),x):o},x.on=function(){var D=a.on.apply(a,arguments);return D===a?x:D},x.clickDistance=function(D){return arguments.length?(_=(D=+D)*D,x):Math.sqrt(_)},x}function gl(e,n,t){e.prototype=n.prototype=t,t.constructor=e}function Wi(e,n){var t=Object.create(e.prototype);for(var o in n)t[o]=n[o];return t}function Rn(){}var In=.7,vo=1/In,un="\\s*([+-]?\\d+)\\s*",Dn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",zt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Pr=/^#([0-9a-f]{3,8})$/,Or=new RegExp(`^rgb\\(${un},${un},${un}\\)$`),Ur=new RegExp(`^rgb\\(${zt},${zt},${zt}\\)$`),Br=new RegExp(`^rgba\\(${un},${un},${un},${Dn}\\)$`),Rr=new RegExp(`^rgba\\(${zt},${zt},${zt},${Dn}\\)$`),Hr=new RegExp(`^hsl\\(${Dn},${zt},${zt}\\)$`),Lr=new RegExp(`^hsla\\(${Dn},${zt},${zt},${Dn}\\)$`),Rl={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};gl(Rn,Tn,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Hl,formatHex:Hl,formatHex8:Fr,formatHsl:qr,formatRgb:Ll,toString:Ll});function Hl(){return this.rgb().formatHex()}function Fr(){return this.rgb().formatHex8()}function qr(){return Ki(this).formatHsl()}function Ll(){return this.rgb().formatRgb()}function Tn(e){var n,t;return e=(e+"").trim().toLowerCase(),(n=Pr.exec(e))?(t=n[1].length,n=parseInt(n[1],16),t===6?Fl(n):t===3?new _t(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):t===8?Qn(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):t===4?Qn(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=Or.exec(e))?new _t(n[1],n[2],n[3],1):(n=Ur.exec(e))?new _t(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=Br.exec(e))?Qn(n[1],n[2],n[3],n[4]):(n=Rr.exec(e))?Qn(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=Hr.exec(e))?Yl(n[1],n[2]/100,n[3]/100,1):(n=Lr.exec(e))?Yl(n[1],n[2]/100,n[3]/100,n[4]):Rl.hasOwnProperty(e)?Fl(Rl[e]):e==="transparent"?new _t(NaN,NaN,NaN,0):null}function Fl(e){return new _t(e>>16&255,e>>8&255,e&255,1)}function Qn(e,n,t,o){return o<=0&&(e=n=t=NaN),new _t(e,n,t,o)}function Gr(e){return e instanceof Rn||(e=Tn(e)),e?(e=e.rgb(),new _t(e.r,e.g,e.b,e.opacity)):new _t}function Qo(e,n,t,o){return arguments.length===1?Gr(e):new _t(e,n,t,o??1)}function _t(e,n,t,o){this.r=+e,this.g=+n,this.b=+t,this.opacity=+o}gl(_t,Qo,Wi(Rn,{brighter(e){return e=e==null?vo:Math.pow(vo,e),new _t(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?In:Math.pow(In,e),new _t(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new _t(Jt(this.r),Jt(this.g),Jt(this.b),go(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ql,formatHex:ql,formatHex8:Yr,formatRgb:Gl,toString:Gl}));function ql(){return`#${Kt(this.r)}${Kt(this.g)}${Kt(this.b)}`}function Yr(){return`#${Kt(this.r)}${Kt(this.g)}${Kt(this.b)}${Kt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Gl(){const e=go(this.opacity);return`${e===1?"rgb(":"rgba("}${Jt(this.r)}, ${Jt(this.g)}, ${Jt(this.b)}${e===1?")":`, ${e})`}`}function go(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Jt(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Kt(e){return e=Jt(e),(e<16?"0":"")+e.toString(16)}function Yl(e,n,t,o){return o<=0?e=n=t=NaN:t<=0||t>=1?e=n=NaN:n<=0&&(e=NaN),new $t(e,n,t,o)}function Ki(e){if(e instanceof $t)return new $t(e.h,e.s,e.l,e.opacity);if(e instanceof Rn||(e=Tn(e)),!e)return new $t;if(e instanceof $t)return e;e=e.rgb();var n=e.r/255,t=e.g/255,o=e.b/255,l=Math.min(n,t,o),a=Math.max(n,t,o),r=NaN,u=a-l,f=(a+l)/2;return u?(n===a?r=(t-o)/u+(t<o)*6:t===a?r=(o-n)/u+2:r=(n-t)/u+4,u/=f<.5?a+l:2-a-l,r*=60):u=f>0&&f<1?0:r,new $t(r,u,f,e.opacity)}function Xr(e,n,t,o){return arguments.length===1?Ki(e):new $t(e,n,t,o??1)}function $t(e,n,t,o){this.h=+e,this.s=+n,this.l=+t,this.opacity=+o}gl($t,Xr,Wi(Rn,{brighter(e){return e=e==null?vo:Math.pow(vo,e),new $t(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?In:Math.pow(In,e),new $t(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,o=t+(t<.5?t:1-t)*n,l=2*t-o;return new _t(Ro(e>=240?e-240:e+120,l,o),Ro(e,l,o),Ro(e<120?e+240:e-120,l,o),this.opacity)},clamp(){return new $t(Xl(this.h),eo(this.s),eo(this.l),go(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=go(this.opacity);return`${e===1?"hsl(":"hsla("}${Xl(this.h)}, ${eo(this.s)*100}%, ${eo(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Xl(e){return e=(e||0)%360,e<0?e+360:e}function eo(e){return Math.max(0,Math.min(1,e||0))}function Ro(e,n,t){return(e<60?n+(t-n)*e/60:e<180?t:e<240?n+(t-n)*(240-e)/60:n)*255}const Ji=e=>()=>e;function Zr(e,n){return function(t){return e+t*n}}function jr(e,n,t){return e=Math.pow(e,t),n=Math.pow(n,t)-e,t=1/t,function(o){return Math.pow(e+o*n,t)}}function Wr(e){return(e=+e)==1?Qi:function(n,t){return t-n?jr(n,t,e):Ji(isNaN(n)?t:n)}}function Qi(e,n){var t=n-e;return t?Zr(e,t):Ji(isNaN(e)?n:e)}const Zl=function e(n){var t=Wr(n);function o(l,a){var r=t((l=Qo(l)).r,(a=Qo(a)).r),u=t(l.g,a.g),f=t(l.b,a.b),v=Qi(l.opacity,a.opacity);return function(g){return l.r=r(g),l.g=u(g),l.b=f(g),l.opacity=v(g),l+""}}return o.gamma=e,o}(1);function qt(e,n){return e=+e,n=+n,function(t){return e*(1-t)+n*t}}var el=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ho=new RegExp(el.source,"g");function Kr(e){return function(){return e}}function Jr(e){return function(n){return e(n)+""}}function Qr(e,n){var t=el.lastIndex=Ho.lastIndex=0,o,l,a,r=-1,u=[],f=[];for(e=e+"",n=n+"";(o=el.exec(e))&&(l=Ho.exec(n));)(a=l.index)>t&&(a=n.slice(t,a),u[r]?u[r]+=a:u[++r]=a),(o=o[0])===(l=l[0])?u[r]?u[r]+=l:u[++r]=l:(u[++r]=null,f.push({i:r,x:qt(o,l)})),t=Ho.lastIndex;return t<n.length&&(a=n.slice(t),u[r]?u[r]+=a:u[++r]=a),u.length<2?f[0]?Jr(f[0].x):Kr(n):(n=f.length,function(v){for(var g=0,_;g<n;++g)u[(_=f[g]).i]=_.x(v);return u.join("")})}var jl=180/Math.PI,tl={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function es(e,n,t,o,l,a){var r,u,f;return(r=Math.sqrt(e*e+n*n))&&(e/=r,n/=r),(f=e*t+n*o)&&(t-=e*f,o-=n*f),(u=Math.sqrt(t*t+o*o))&&(t/=u,o/=u,f/=u),e*o<n*t&&(e=-e,n=-n,f=-f,r=-r),{translateX:l,translateY:a,rotate:Math.atan2(n,e)*jl,skewX:Math.atan(f)*jl,scaleX:r,scaleY:u}}var to;function eu(e){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return n.isIdentity?tl:es(n.a,n.b,n.c,n.d,n.e,n.f)}function tu(e){return e==null||(to||(to=document.createElementNS("http://www.w3.org/2000/svg","g")),to.setAttribute("transform",e),!(e=to.transform.baseVal.consolidate()))?tl:(e=e.matrix,es(e.a,e.b,e.c,e.d,e.e,e.f))}function ts(e,n,t,o){function l(v){return v.length?v.pop()+" ":""}function a(v,g,_,x,C,P){if(v!==_||g!==x){var T=C.push("translate(",null,n,null,t);P.push({i:T-4,x:qt(v,_)},{i:T-2,x:qt(g,x)})}else(_||x)&&C.push("translate("+_+n+x+t)}function r(v,g,_,x){v!==g?(v-g>180?g+=360:g-v>180&&(v+=360),x.push({i:_.push(l(_)+"rotate(",null,o)-2,x:qt(v,g)})):g&&_.push(l(_)+"rotate("+g+o)}function u(v,g,_,x){v!==g?x.push({i:_.push(l(_)+"skewX(",null,o)-2,x:qt(v,g)}):g&&_.push(l(_)+"skewX("+g+o)}function f(v,g,_,x,C,P){if(v!==_||g!==x){var T=C.push(l(C)+"scale(",null,",",null,")");P.push({i:T-4,x:qt(v,_)},{i:T-2,x:qt(g,x)})}else(_!==1||x!==1)&&C.push(l(C)+"scale("+_+","+x+")")}return function(v,g){var _=[],x=[];return v=e(v),g=e(g),a(v.translateX,v.translateY,g.translateX,g.translateY,_,x),r(v.rotate,g.rotate,_,x),u(v.skewX,g.skewX,_,x),f(v.scaleX,v.scaleY,g.scaleX,g.scaleY,_,x),v=g=null,function(C){for(var P=-1,T=x.length,I;++P<T;)_[(I=x[P]).i]=I.x(C);return _.join("")}}}var nu=ts(eu,"px, ","px)","deg)"),ou=ts(tu,", ",")",")"),lu=1e-12;function Wl(e){return((e=Math.exp(e))+1/e)/2}function iu(e){return((e=Math.exp(e))-1/e)/2}function su(e){return((e=Math.exp(2*e))-1)/(e+1)}const au=function e(n,t,o){function l(a,r){var u=a[0],f=a[1],v=a[2],g=r[0],_=r[1],x=r[2],C=g-u,P=_-f,T=C*C+P*P,I,A;if(T<lu)A=Math.log(x/v)/n,I=function(ae){return[u+ae*C,f+ae*P,v*Math.exp(n*ae*A)]};else{var R=Math.sqrt(T),k=(x*x-v*v+o*T)/(2*v*t*R),D=(x*x-v*v-o*T)/(2*x*t*R),K=Math.log(Math.sqrt(k*k+1)-k),ge=Math.log(Math.sqrt(D*D+1)-D);A=(ge-K)/n,I=function(ae){var de=ae*A,ve=Wl(K),Q=v/(t*R)*(ve*su(n*de+K)-iu(K));return[u+Q*C,f+Q*P,v*ve/Wl(n*de+K)]}}return I.duration=A*1e3*n/Math.SQRT2,I}return l.rho=function(a){var r=Math.max(.001,+a),u=r*r,f=u*u;return e(r,u,f)},l}(Math.SQRT2,2,4);var vn=0,En=0,Vn=0,ns=1e3,mo,Sn,ho=0,tn=0,$o=0,An=typeof performance=="object"&&performance.now?performance:Date,os=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ml(){return tn||(os(du),tn=An.now()+$o)}function du(){tn=0}function yo(){this._call=this._time=this._next=null}yo.prototype=ls.prototype={constructor:yo,restart:function(e,n,t){if(typeof e!="function")throw new TypeError("callback is not a function");t=(t==null?ml():+t)+(n==null?0:+n),!this._next&&Sn!==this&&(Sn?Sn._next=this:mo=this,Sn=this),this._call=e,this._time=t,nl()},stop:function(){this._call&&(this._call=null,this._time=1/0,nl())}};function ls(e,n,t){var o=new yo;return o.restart(e,n,t),o}function ru(){ml(),++vn;for(var e=mo,n;e;)(n=tn-e._time)>=0&&e._call.call(void 0,n),e=e._next;--vn}function Kl(){tn=(ho=An.now())+$o,vn=En=0;try{ru()}finally{vn=0,cu(),tn=0}}function uu(){var e=An.now(),n=e-ho;n>ns&&($o-=n,ho=e)}function cu(){for(var e,n=mo,t,o=1/0;n;)n._call?(o>n._time&&(o=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:mo=t);Sn=e,nl(o)}function nl(e){if(!vn){En&&(En=clearTimeout(En));var n=e-tn;n>24?(e<1/0&&(En=setTimeout(Kl,e-An.now()-$o)),Vn&&(Vn=clearInterval(Vn))):(Vn||(ho=An.now(),Vn=setInterval(uu,ns)),vn=1,os(Kl))}}function Jl(e,n,t){var o=new yo;return n=n==null?0:+n,o.restart(l=>{o.stop(),e(l+n)},n,t),o}var pu=ko("start","end","cancel","interrupt"),fu=[],is=0,Ql=1,ol=2,uo=3,ei=4,ll=5,co=6;function Eo(e,n,t,o,l,a){var r=e.__transition;if(!r)e.__transition={};else if(t in r)return;vu(e,t,{name:n,index:o,group:l,on:pu,tween:fu,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:is})}function hl(e,n){var t=St(e,n);if(t.state>is)throw new Error("too late; already scheduled");return t}function Mt(e,n){var t=St(e,n);if(t.state>uo)throw new Error("too late; already running");return t}function St(e,n){var t=e.__transition;if(!t||!(t=t[n]))throw new Error("transition not found");return t}function vu(e,n,t){var o=e.__transition,l;o[n]=t,t.timer=ls(a,0,t.time);function a(v){t.state=Ql,t.timer.restart(r,t.delay,t.time),t.delay<=v&&r(v-t.delay)}function r(v){var g,_,x,C;if(t.state!==Ql)return f();for(g in o)if(C=o[g],C.name===t.name){if(C.state===uo)return Jl(r);C.state===ei?(C.state=co,C.timer.stop(),C.on.call("interrupt",e,e.__data__,C.index,C.group),delete o[g]):+g<n&&(C.state=co,C.timer.stop(),C.on.call("cancel",e,e.__data__,C.index,C.group),delete o[g])}if(Jl(function(){t.state===uo&&(t.state=ei,t.timer.restart(u,t.delay,t.time),u(v))}),t.state=ol,t.on.call("start",e,e.__data__,t.index,t.group),t.state===ol){for(t.state=uo,l=new Array(x=t.tween.length),g=0,_=-1;g<x;++g)(C=t.tween[g].value.call(e,e.__data__,t.index,t.group))&&(l[++_]=C);l.length=_+1}}function u(v){for(var g=v<t.duration?t.ease.call(null,v/t.duration):(t.timer.restart(f),t.state=ll,1),_=-1,x=l.length;++_<x;)l[_].call(e,g);t.state===ll&&(t.on.call("end",e,e.__data__,t.index,t.group),f())}function f(){t.state=co,t.timer.stop(),delete o[n];for(var v in o)return;delete e.__transition}}function po(e,n){var t=e.__transition,o,l,a=!0,r;if(t){n=n==null?null:n+"";for(r in t){if((o=t[r]).name!==n){a=!1;continue}l=o.state>ol&&o.state<ll,o.state=co,o.timer.stop(),o.on.call(l?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete t[r]}a&&delete e.__transition}}function gu(e){return this.each(function(){po(this,e)})}function mu(e,n){var t,o;return function(){var l=Mt(this,e),a=l.tween;if(a!==t){o=t=a;for(var r=0,u=o.length;r<u;++r)if(o[r].name===n){o=o.slice(),o.splice(r,1);break}}l.tween=o}}function hu(e,n,t){var o,l;if(typeof t!="function")throw new Error;return function(){var a=Mt(this,e),r=a.tween;if(r!==o){l=(o=r).slice();for(var u={name:n,value:t},f=0,v=l.length;f<v;++f)if(l[f].name===n){l[f]=u;break}f===v&&l.push(u)}a.tween=l}}function yu(e,n){var t=this._id;if(e+="",arguments.length<2){for(var o=St(this.node(),t).tween,l=0,a=o.length,r;l<a;++l)if((r=o[l]).name===e)return r.value;return null}return this.each((n==null?mu:hu)(t,e,n))}function yl(e,n,t){var o=e._id;return e.each(function(){var l=Mt(this,o);(l.value||(l.value={}))[n]=t.apply(this,arguments)}),function(l){return St(l,o).value[n]}}function ss(e,n){var t;return(typeof n=="number"?qt:n instanceof Tn?Zl:(t=Tn(n))?(n=t,Zl):Qr)(e,n)}function _u(e){return function(){this.removeAttribute(e)}}function wu(e){return function(){this.removeAttributeNS(e.space,e.local)}}function xu(e,n,t){var o,l=t+"",a;return function(){var r=this.getAttribute(e);return r===l?null:r===o?a:a=n(o=r,t)}}function bu(e,n,t){var o,l=t+"",a;return function(){var r=this.getAttributeNS(e.space,e.local);return r===l?null:r===o?a:a=n(o=r,t)}}function ku(e,n,t){var o,l,a;return function(){var r,u=t(this),f;return u==null?void this.removeAttribute(e):(r=this.getAttribute(e),f=u+"",r===f?null:r===o&&f===l?a:(l=f,a=n(o=r,u)))}}function Vu(e,n,t){var o,l,a;return function(){var r,u=t(this),f;return u==null?void this.removeAttributeNS(e.space,e.local):(r=this.getAttributeNS(e.space,e.local),f=u+"",r===f?null:r===o&&f===l?a:(l=f,a=n(o=r,u)))}}function $u(e,n){var t=Vo(e),o=t==="transform"?ou:ss;return this.attrTween(e,typeof n=="function"?(t.local?Vu:ku)(t,o,yl(this,"attr."+e,n)):n==null?(t.local?wu:_u)(t):(t.local?bu:xu)(t,o,n))}function Eu(e,n){return function(t){this.setAttribute(e,n.call(this,t))}}function Su(e,n){return function(t){this.setAttributeNS(e.space,e.local,n.call(this,t))}}function Cu(e,n){var t,o;function l(){var a=n.apply(this,arguments);return a!==o&&(t=(o=a)&&Su(e,a)),t}return l._value=n,l}function Nu(e,n){var t,o;function l(){var a=n.apply(this,arguments);return a!==o&&(t=(o=a)&&Eu(e,a)),t}return l._value=n,l}function zu(e,n){var t="attr."+e;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(n==null)return this.tween(t,null);if(typeof n!="function")throw new Error;var o=Vo(e);return this.tween(t,(o.local?Cu:Nu)(o,n))}function Mu(e,n){return function(){hl(this,e).delay=+n.apply(this,arguments)}}function Iu(e,n){return n=+n,function(){hl(this,e).delay=n}}function Du(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?Mu:Iu)(n,e)):St(this.node(),n).delay}function Tu(e,n){return function(){Mt(this,e).duration=+n.apply(this,arguments)}}function Au(e,n){return n=+n,function(){Mt(this,e).duration=n}}function Pu(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?Tu:Au)(n,e)):St(this.node(),n).duration}function Ou(e,n){if(typeof n!="function")throw new Error;return function(){Mt(this,e).ease=n}}function Uu(e){var n=this._id;return arguments.length?this.each(Ou(n,e)):St(this.node(),n).ease}function Bu(e,n){return function(){var t=n.apply(this,arguments);if(typeof t!="function")throw new Error;Mt(this,e).ease=t}}function Ru(e){if(typeof e!="function")throw new Error;return this.each(Bu(this._id,e))}function Hu(e){typeof e!="function"&&(e=Ui(e));for(var n=this._groups,t=n.length,o=new Array(t),l=0;l<t;++l)for(var a=n[l],r=a.length,u=o[l]=[],f,v=0;v<r;++v)(f=a[v])&&e.call(f,f.__data__,v,a)&&u.push(f);return new Ut(o,this._parents,this._name,this._id)}function Lu(e){if(e._id!==this._id)throw new Error;for(var n=this._groups,t=e._groups,o=n.length,l=t.length,a=Math.min(o,l),r=new Array(o),u=0;u<a;++u)for(var f=n[u],v=t[u],g=f.length,_=r[u]=new Array(g),x,C=0;C<g;++C)(x=f[C]||v[C])&&(_[C]=x);for(;u<o;++u)r[u]=n[u];return new Ut(r,this._parents,this._name,this._id)}function Fu(e){return(e+"").trim().split(/^|\s+/).every(function(n){var t=n.indexOf(".");return t>=0&&(n=n.slice(0,t)),!n||n==="start"})}function qu(e,n,t){var o,l,a=Fu(n)?hl:Mt;return function(){var r=a(this,e),u=r.on;u!==o&&(l=(o=u).copy()).on(n,t),r.on=l}}function Gu(e,n){var t=this._id;return arguments.length<2?St(this.node(),t).on.on(e):this.each(qu(t,e,n))}function Yu(e){return function(){var n=this.parentNode;for(var t in this.__transition)if(+t!==e)return;n&&n.removeChild(this)}}function Xu(){return this.on("end.remove",Yu(this._id))}function Zu(e){var n=this._name,t=this._id;typeof e!="function"&&(e=fl(e));for(var o=this._groups,l=o.length,a=new Array(l),r=0;r<l;++r)for(var u=o[r],f=u.length,v=a[r]=new Array(f),g,_,x=0;x<f;++x)(g=u[x])&&(_=e.call(g,g.__data__,x,u))&&("__data__"in g&&(_.__data__=g.__data__),v[x]=_,Eo(v[x],n,t,x,v,St(g,t)));return new Ut(a,this._parents,n,t)}function ju(e){var n=this._name,t=this._id;typeof e!="function"&&(e=Oi(e));for(var o=this._groups,l=o.length,a=[],r=[],u=0;u<l;++u)for(var f=o[u],v=f.length,g,_=0;_<v;++_)if(g=f[_]){for(var x=e.call(g,g.__data__,_,f),C,P=St(g,t),T=0,I=x.length;T<I;++T)(C=x[T])&&Eo(C,n,t,T,x,P);a.push(x),r.push(g)}return new Ut(a,r,n,t)}var Wu=Bn.prototype.constructor;function Ku(){return new Wu(this._groups,this._parents)}function Ju(e,n){var t,o,l;return function(){var a=fn(this,e),r=(this.style.removeProperty(e),fn(this,e));return a===r?null:a===t&&r===o?l:l=n(t=a,o=r)}}function as(e){return function(){this.style.removeProperty(e)}}function Qu(e,n,t){var o,l=t+"",a;return function(){var r=fn(this,e);return r===l?null:r===o?a:a=n(o=r,t)}}function ec(e,n,t){var o,l,a;return function(){var r=fn(this,e),u=t(this),f=u+"";return u==null&&(f=u=(this.style.removeProperty(e),fn(this,e))),r===f?null:r===o&&f===l?a:(l=f,a=n(o=r,u))}}function tc(e,n){var t,o,l,a="style."+n,r="end."+a,u;return function(){var f=Mt(this,e),v=f.on,g=f.value[a]==null?u||(u=as(n)):void 0;(v!==t||l!==g)&&(o=(t=v).copy()).on(r,l=g),f.on=o}}function nc(e,n,t){var o=(e+="")=="transform"?nu:ss;return n==null?this.styleTween(e,Ju(e,o)).on("end.style."+e,as(e)):typeof n=="function"?this.styleTween(e,ec(e,o,yl(this,"style."+e,n))).each(tc(this._id,e)):this.styleTween(e,Qu(e,o,n),t).on("end.style."+e,null)}function oc(e,n,t){return function(o){this.style.setProperty(e,n.call(this,o),t)}}function lc(e,n,t){var o,l;function a(){var r=n.apply(this,arguments);return r!==l&&(o=(l=r)&&oc(e,r,t)),o}return a._value=n,a}function ic(e,n,t){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(n==null)return this.tween(o,null);if(typeof n!="function")throw new Error;return this.tween(o,lc(e,n,t??""))}function sc(e){return function(){this.textContent=e}}function ac(e){return function(){var n=e(this);this.textContent=n??""}}function dc(e){return this.tween("text",typeof e=="function"?ac(yl(this,"text",e)):sc(e==null?"":e+""))}function rc(e){return function(n){this.textContent=e.call(this,n)}}function uc(e){var n,t;function o(){var l=e.apply(this,arguments);return l!==t&&(n=(t=l)&&rc(l)),n}return o._value=e,o}function cc(e){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,uc(e))}function pc(){for(var e=this._name,n=this._id,t=ds(),o=this._groups,l=o.length,a=0;a<l;++a)for(var r=o[a],u=r.length,f,v=0;v<u;++v)if(f=r[v]){var g=St(f,n);Eo(f,e,t,v,r,{time:g.time+g.delay+g.duration,delay:0,duration:g.duration,ease:g.ease})}return new Ut(o,this._parents,e,t)}function fc(){var e,n,t=this,o=t._id,l=t.size();return new Promise(function(a,r){var u={value:r},f={value:function(){--l===0&&a()}};t.each(function(){var v=Mt(this,o),g=v.on;g!==e&&(n=(e=g).copy(),n._.cancel.push(u),n._.interrupt.push(u),n._.end.push(f)),v.on=n}),l===0&&a()})}var vc=0;function Ut(e,n,t,o){this._groups=e,this._parents=n,this._name=t,this._id=o}function ds(){return++vc}var Tt=Bn.prototype;Ut.prototype={constructor:Ut,select:Zu,selectAll:ju,selectChild:Tt.selectChild,selectChildren:Tt.selectChildren,filter:Hu,merge:Lu,selection:Ku,transition:pc,call:Tt.call,nodes:Tt.nodes,node:Tt.node,size:Tt.size,empty:Tt.empty,each:Tt.each,on:Gu,attr:$u,attrTween:zu,style:nc,styleTween:ic,text:dc,textTween:cc,remove:Xu,tween:yu,delay:Du,duration:Pu,ease:Uu,easeVarying:Ru,end:fc,[Symbol.iterator]:Tt[Symbol.iterator]};function gc(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var mc={time:null,delay:0,duration:250,ease:gc};function hc(e,n){for(var t;!(t=e.__transition)||!(t=t[n]);)if(!(e=e.parentNode))throw new Error(`transition ${n} not found`);return t}function yc(e){var n,t;e instanceof Ut?(n=e._id,e=e._name):(n=ds(),(t=mc).time=ml(),e=e==null?null:e+"");for(var o=this._groups,l=o.length,a=0;a<l;++a)for(var r=o[a],u=r.length,f,v=0;v<u;++v)(f=r[v])&&Eo(f,e,n,v,r,t||hc(f,n));return new Ut(o,this._parents,e,n)}Bn.prototype.interrupt=gu;Bn.prototype.transition=yc;const no=e=>()=>e;function _c(e,{sourceEvent:n,target:t,transform:o,dispatch:l}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:l}})}function Pt(e,n,t){this.k=e,this.x=n,this.y=t}Pt.prototype={constructor:Pt,scale:function(e){return e===1?this:new Pt(this.k*e,this.x,this.y)},translate:function(e,n){return e===0&n===0?this:new Pt(this.k,this.x+this.k*e,this.y+this.k*n)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var gn=new Pt(1,0,0);Pt.prototype;function Lo(e){e.stopImmediatePropagation()}function $n(e){e.preventDefault(),e.stopImmediatePropagation()}function wc(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function xc(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function ti(){return this.__zoom||gn}function bc(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function kc(){return navigator.maxTouchPoints||"ontouchstart"in this}function Vc(e,n,t){var o=e.invertX(n[0][0])-t[0][0],l=e.invertX(n[1][0])-t[1][0],a=e.invertY(n[0][1])-t[0][1],r=e.invertY(n[1][1])-t[1][1];return e.translate(l>o?(o+l)/2:Math.min(0,o)||Math.max(0,l),r>a?(a+r)/2:Math.min(0,a)||Math.max(0,r))}function $c(){var e=wc,n=xc,t=Vc,o=bc,l=kc,a=[0,1/0],r=[[-1/0,-1/0],[1/0,1/0]],u=250,f=au,v=ko("start","zoom","end"),g,_,x,C=500,P=150,T=0,I=10;function A(E){E.property("__zoom",ti).on("wheel.zoom",de,{passive:!1}).on("mousedown.zoom",ve).on("dblclick.zoom",Q).filter(l).on("touchstart.zoom",le).on("touchmove.zoom",O).on("touchend.zoom touchcancel.zoom",Ee).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}A.transform=function(E,F,b,U){var j=E.selection?E.selection():E;j.property("__zoom",ti),E!==j?K(E,F,b,U):j.interrupt().each(function(){ge(this,arguments).event(U).start().zoom(null,typeof F=="function"?F.apply(this,arguments):F).end()})},A.scaleBy=function(E,F,b,U){A.scaleTo(E,function(){var j=this.__zoom.k,te=typeof F=="function"?F.apply(this,arguments):F;return j*te},b,U)},A.scaleTo=function(E,F,b,U){A.transform(E,function(){var j=n.apply(this,arguments),te=this.__zoom,ne=b==null?D(j):typeof b=="function"?b.apply(this,arguments):b,pe=te.invert(ne),Ve=typeof F=="function"?F.apply(this,arguments):F;return t(k(R(te,Ve),ne,pe),j,r)},b,U)},A.translateBy=function(E,F,b,U){A.transform(E,function(){return t(this.__zoom.translate(typeof F=="function"?F.apply(this,arguments):F,typeof b=="function"?b.apply(this,arguments):b),n.apply(this,arguments),r)},null,U)},A.translateTo=function(E,F,b,U,j){A.transform(E,function(){var te=n.apply(this,arguments),ne=this.__zoom,pe=U==null?D(te):typeof U=="function"?U.apply(this,arguments):U;return t(gn.translate(pe[0],pe[1]).scale(ne.k).translate(typeof F=="function"?-F.apply(this,arguments):-F,typeof b=="function"?-b.apply(this,arguments):-b),te,r)},U,j)};function R(E,F){return F=Math.max(a[0],Math.min(a[1],F)),F===E.k?E:new Pt(F,E.x,E.y)}function k(E,F,b){var U=F[0]-b[0]*E.k,j=F[1]-b[1]*E.k;return U===E.x&&j===E.y?E:new Pt(E.k,U,j)}function D(E){return[(+E[0][0]+ +E[1][0])/2,(+E[0][1]+ +E[1][1])/2]}function K(E,F,b,U){E.on("start.zoom",function(){ge(this,arguments).event(U).start()}).on("interrupt.zoom end.zoom",function(){ge(this,arguments).event(U).end()}).tween("zoom",function(){var j=this,te=arguments,ne=ge(j,te).event(U),pe=n.apply(j,te),Ve=b==null?D(pe):typeof b=="function"?b.apply(j,te):b,re=Math.max(pe[1][0]-pe[0][0],pe[1][1]-pe[0][1]),se=j.__zoom,ke=typeof F=="function"?F.apply(j,te):F,Ue=f(se.invert(Ve).concat(re/se.k),ke.invert(Ve).concat(re/ke.k));return function(Ae){if(Ae===1)Ae=ke;else{var Le=Ue(Ae),Ie=re/Le[2];Ae=new Pt(Ie,Ve[0]-Le[0]*Ie,Ve[1]-Le[1]*Ie)}ne.zoom(null,Ae)}})}function ge(E,F,b){return!b&&E.__zooming||new ae(E,F)}function ae(E,F){this.that=E,this.args=F,this.active=0,this.sourceEvent=null,this.extent=n.apply(E,F),this.taps=0}ae.prototype={event:function(E){return E&&(this.sourceEvent=E),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(E,F){return this.mouse&&E!=="mouse"&&(this.mouse[1]=F.invert(this.mouse[0])),this.touch0&&E!=="touch"&&(this.touch0[1]=F.invert(this.touch0[0])),this.touch1&&E!=="touch"&&(this.touch1[1]=F.invert(this.touch1[0])),this.that.__zoom=F,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(E){var F=Vt(this.that).datum();v.call(E,this.that,new _c(E,{sourceEvent:this.sourceEvent,target:A,transform:this.that.__zoom,dispatch:v}),F)}};function de(E,...F){if(!e.apply(this,arguments))return;var b=ge(this,F).event(E),U=this.__zoom,j=Math.max(a[0],Math.min(a[1],U.k*Math.pow(2,o.apply(this,arguments)))),te=Ct(E);if(b.wheel)(b.mouse[0][0]!==te[0]||b.mouse[0][1]!==te[1])&&(b.mouse[1]=U.invert(b.mouse[0]=te)),clearTimeout(b.wheel);else{if(U.k===j)return;b.mouse=[te,U.invert(te)],po(this),b.start()}$n(E),b.wheel=setTimeout(ne,P),b.zoom("mouse",t(k(R(U,j),b.mouse[0],b.mouse[1]),b.extent,r));function ne(){b.wheel=null,b.end()}}function ve(E,...F){if(x||!e.apply(this,arguments))return;var b=E.currentTarget,U=ge(this,F,!0).event(E),j=Vt(E.view).on("mousemove.zoom",Ve,!0).on("mouseup.zoom",re,!0),te=Ct(E,b),ne=E.clientX,pe=E.clientY;Zi(E.view),Lo(E),U.mouse=[te,this.__zoom.invert(te)],po(this),U.start();function Ve(se){if($n(se),!U.moved){var ke=se.clientX-ne,Ue=se.clientY-pe;U.moved=ke*ke+Ue*Ue>T}U.event(se).zoom("mouse",t(k(U.that.__zoom,U.mouse[0]=Ct(se,b),U.mouse[1]),U.extent,r))}function re(se){j.on("mousemove.zoom mouseup.zoom",null),ji(se.view,U.moved),$n(se),U.event(se).end()}}function Q(E,...F){if(e.apply(this,arguments)){var b=this.__zoom,U=Ct(E.changedTouches?E.changedTouches[0]:E,this),j=b.invert(U),te=b.k*(E.shiftKey?.5:2),ne=t(k(R(b,te),U,j),n.apply(this,F),r);$n(E),u>0?Vt(this).transition().duration(u).call(K,ne,U,E):Vt(this).call(A.transform,ne,U,E)}}function le(E,...F){if(e.apply(this,arguments)){var b=E.touches,U=b.length,j=ge(this,F,E.changedTouches.length===U).event(E),te,ne,pe,Ve;for(Lo(E),ne=0;ne<U;++ne)pe=b[ne],Ve=Ct(pe,this),Ve=[Ve,this.__zoom.invert(Ve),pe.identifier],j.touch0?!j.touch1&&j.touch0[2]!==Ve[2]&&(j.touch1=Ve,j.taps=0):(j.touch0=Ve,te=!0,j.taps=1+!!g);g&&(g=clearTimeout(g)),te&&(j.taps<2&&(_=Ve[0],g=setTimeout(function(){g=null},C)),po(this),j.start())}}function O(E,...F){if(this.__zooming){var b=ge(this,F).event(E),U=E.changedTouches,j=U.length,te,ne,pe,Ve;for($n(E),te=0;te<j;++te)ne=U[te],pe=Ct(ne,this),b.touch0&&b.touch0[2]===ne.identifier?b.touch0[0]=pe:b.touch1&&b.touch1[2]===ne.identifier&&(b.touch1[0]=pe);if(ne=b.that.__zoom,b.touch1){var re=b.touch0[0],se=b.touch0[1],ke=b.touch1[0],Ue=b.touch1[1],Ae=(Ae=ke[0]-re[0])*Ae+(Ae=ke[1]-re[1])*Ae,Le=(Le=Ue[0]-se[0])*Le+(Le=Ue[1]-se[1])*Le;ne=R(ne,Math.sqrt(Ae/Le)),pe=[(re[0]+ke[0])/2,(re[1]+ke[1])/2],Ve=[(se[0]+Ue[0])/2,(se[1]+Ue[1])/2]}else if(b.touch0)pe=b.touch0[0],Ve=b.touch0[1];else return;b.zoom("touch",t(k(ne,pe,Ve),b.extent,r))}}function Ee(E,...F){if(this.__zooming){var b=ge(this,F).event(E),U=E.changedTouches,j=U.length,te,ne;for(Lo(E),x&&clearTimeout(x),x=setTimeout(function(){x=null},C),te=0;te<j;++te)ne=U[te],b.touch0&&b.touch0[2]===ne.identifier?delete b.touch0:b.touch1&&b.touch1[2]===ne.identifier&&delete b.touch1;if(b.touch1&&!b.touch0&&(b.touch0=b.touch1,delete b.touch1),b.touch0)b.touch0[1]=this.__zoom.invert(b.touch0[0]);else if(b.end(),b.taps===2&&(ne=Ct(ne,this),Math.hypot(_[0]-ne[0],_[1]-ne[1])<I)){var pe=Vt(this).on("dblclick.zoom");pe&&pe.apply(this,arguments)}}}return A.wheelDelta=function(E){return arguments.length?(o=typeof E=="function"?E:no(+E),A):o},A.filter=function(E){return arguments.length?(e=typeof E=="function"?E:no(!!E),A):e},A.touchable=function(E){return arguments.length?(l=typeof E=="function"?E:no(!!E),A):l},A.extent=function(E){return arguments.length?(n=typeof E=="function"?E:no([[+E[0][0],+E[0][1]],[+E[1][0],+E[1][1]]]),A):n},A.scaleExtent=function(E){return arguments.length?(a[0]=+E[0],a[1]=+E[1],A):[a[0],a[1]]},A.translateExtent=function(E){return arguments.length?(r[0][0]=+E[0][0],r[1][0]=+E[1][0],r[0][1]=+E[0][1],r[1][1]=+E[1][1],A):[[r[0][0],r[0][1]],[r[1][0],r[1][1]]]},A.constrain=function(E){return arguments.length?(t=E,A):t},A.duration=function(E){return arguments.length?(u=+E,A):u},A.interpolate=function(E){return arguments.length?(f=E,A):f},A.on=function(){var E=v.on.apply(v,arguments);return E===v?A:E},A.clickDistance=function(E){return arguments.length?(T=(E=+E)*E,A):Math.sqrt(T)},A.tapDistance=function(E){return arguments.length?(I=+E,A):I},A}var $e=(e=>(e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom",e))($e||{}),_l=(e=>(e.Partial="partial",e.Full="full",e))(_l||{}),jt=(e=>(e.Bezier="default",e.SimpleBezier="simple-bezier",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e))(jt||{}),Xt=(e=>(e.Strict="strict",e.Loose="loose",e))(Xt||{}),Pn=(e=>(e.Arrow="arrow",e.ArrowClosed="arrowclosed",e))(Pn||{}),Nn=(e=>(e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal",e))(Nn||{}),rs=(e=>(e.TopLeft="top-left",e.TopCenter="top-center",e.TopRight="top-right",e.BottomLeft="bottom-left",e.BottomCenter="bottom-center",e.BottomRight="bottom-right",e))(rs||{});function il(e){var n,t;const o=((t=(n=e.composedPath)==null?void 0:n.call(e))==null?void 0:t[0])||e.target,l=typeof(o==null?void 0:o.hasAttribute)=="function"?o.hasAttribute("contenteditable"):!1,a=typeof(o==null?void 0:o.closest)=="function"?o.closest(".nokey"):null;return["INPUT","SELECT","TEXTAREA"].includes(o==null?void 0:o.nodeName)||l||!!a}function Ec(e){return e.ctrlKey||e.metaKey||e.shiftKey}function ni(e,n,t,o){const l=n.split("+").map(a=>a.trim().toLowerCase());return l.length===1?e.toLowerCase()===n.toLowerCase():(o?t.delete(e.toLowerCase()):t.add(e.toLowerCase()),l.every((a,r)=>t.has(a)&&Array.from(t.values())[r]===l[r]))}function Sc(e,n){return t=>{if(!t.code&&!t.key)return!1;const o=Cc(t.code,e);return Array.isArray(e)?e.some(l=>ni(t[o],l,n,t.type==="keyup")):ni(t[o],e,n,t.type==="keyup")}}function Cc(e,n){return typeof n=="string"?e===n?"code":"key":n.includes(e)?"code":"key"}function zn(e,n){const t=ot(()=>Qe(n==null?void 0:n.actInsideInputWithModifier)??!1),o=ot(()=>Qe(n==null?void 0:n.target)??window),l=q(Qe(e)===!0);let a=!1;const r=new Set;let u=v(Qe(e));Ge(()=>Qe(e),(g,_)=>{typeof _=="boolean"&&typeof g!="boolean"&&f(),u=v(g)},{immediate:!0}),Et(()=>{Ai(window,["blur","contextmenu"],f)}),Ol((...g)=>u(...g),g=>{a=Ec(g),!((!a||a&&!t.value)&&il(g))&&(g.preventDefault(),l.value=!0)},{eventName:"keydown",target:o}),Ol((...g)=>u(...g),g=>{if(l.value){if((!a||a&&!t.value)&&il(g))return;f()}},{eventName:"keyup",target:o});function f(){a=!1,r.clear(),l.value=!1}function v(g){return g===null?(f(),()=>!1):typeof g=="boolean"?(f(),l.value=g,()=>!1):Array.isArray(g)||typeof g=="string"?Sc(g,r):g}return l}const us="vue-flow__node-desc",cs="vue-flow__edge-desc",Nc="vue-flow__aria-live",ps=["Enter"," ","Escape"],cn={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};function sl(e){return{...e.computedPosition||{x:0,y:0},width:e.dimensions.width||0,height:e.dimensions.height||0}}function al(e,n){const t=Math.max(0,Math.min(e.x+e.width,n.x+n.width)-Math.max(e.x,n.x)),o=Math.max(0,Math.min(e.y+e.height,n.y+n.height)-Math.max(e.y,n.y));return Math.ceil(t*o)}function So(e){return{width:e.offsetWidth,height:e.offsetHeight}}function nn(e,n=0,t=1){return Math.min(Math.max(e,n),t)}function fs(e,n){return{x:nn(e.x,n[0][0],n[1][0]),y:nn(e.y,n[0][1],n[1][1])}}function oi(e){const n=e.getRootNode();return"elementFromPoint"in n?n:window.document}function Zt(e){return e&&typeof e=="object"&&"id"in e&&"source"in e&&"target"in e}function Qt(e){return e&&typeof e=="object"&&"id"in e&&"position"in e&&!Zt(e)}function Cn(e){return Qt(e)&&"computedPosition"in e}function oo(e){return!Number.isNaN(e)&&Number.isFinite(e)}function zc(e){return oo(e.width)&&oo(e.height)&&oo(e.x)&&oo(e.y)}function Mc(e,n,t){const o={id:e.id.toString(),type:e.type??"default",dimensions:dn({width:0,height:0}),computedPosition:dn({z:0,...e.position}),handleBounds:{source:[],target:[]},draggable:void 0,selectable:void 0,connectable:void 0,focusable:void 0,selected:!1,dragging:!1,resizing:!1,initialized:!1,isParent:!1,position:{x:0,y:0},data:ut(e.data)?e.data:{},events:dn(ut(e.events)?e.events:{})};return Object.assign(n??o,e,{id:e.id.toString(),parentNode:t})}function vs(e,n,t){var o,l;const a={id:e.id.toString(),type:e.type??(n==null?void 0:n.type)??"default",source:e.source.toString(),target:e.target.toString(),sourceHandle:(o=e.sourceHandle)==null?void 0:o.toString(),targetHandle:(l=e.targetHandle)==null?void 0:l.toString(),updatable:e.updatable??(t==null?void 0:t.updatable),selectable:e.selectable??(t==null?void 0:t.selectable),focusable:e.focusable??(t==null?void 0:t.focusable),data:ut(e.data)?e.data:{},events:dn(ut(e.events)?e.events:{}),label:e.label??"",interactionWidth:e.interactionWidth??(t==null?void 0:t.interactionWidth),...t??{}};return Object.assign(n??a,e,{id:e.id.toString()})}function gs(e,n,t,o){const l=typeof e=="string"?e:e.id,a=new Set,r=o==="source"?"target":"source";for(const u of t)u[r]===l&&a.add(u[o]);return n.filter(u=>a.has(u.id))}function Ic(...e){if(e.length===3){const[a,r,u]=e;return gs(a,r,u,"target")}const[n,t]=e,o=typeof n=="string"?n:n.id;return t.filter(a=>Zt(a)&&a.source===o).map(a=>t.find(r=>Qt(r)&&r.id===a.target))}function Dc(...e){if(e.length===3){const[a,r,u]=e;return gs(a,r,u,"source")}const[n,t]=e,o=typeof n=="string"?n:n.id;return t.filter(a=>Zt(a)&&a.target===o).map(a=>t.find(r=>Qt(r)&&r.id===a.source))}function ms({source:e,sourceHandle:n,target:t,targetHandle:o}){return`vueflow__edge-${e}${n??""}-${t}${o??""}`}function Tc(e,n){return n.some(t=>Zt(t)&&t.source===e.source&&t.target===e.target&&(t.sourceHandle===e.sourceHandle||!t.sourceHandle&&!e.sourceHandle)&&(t.targetHandle===e.targetHandle||!t.targetHandle&&!e.targetHandle))}function hs({x:e,y:n},{x:t,y:o,zoom:l}){return{x:e*l+t,y:n*l+o}}function _o({x:e,y:n},{x:t,y:o,zoom:l},a=!1,[r,u]=[1,1]){const f={x:(e-t)/l,y:(n-o)/l};return a?{x:r*Math.round(f.x/r),y:u*Math.round(f.y/u)}:f}function Ac(e,n){return{x:Math.min(e.x,n.x),y:Math.min(e.y,n.y),x2:Math.max(e.x2,n.x2),y2:Math.max(e.y2,n.y2)}}function ys({x:e,y:n,width:t,height:o}){return{x:e,y:n,x2:e+t,y2:n+o}}function Pc({x:e,y:n,x2:t,y2:o}){return{x:e,y:n,width:t-e,height:o-n}}function _s(e){let n={x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,x2:Number.NEGATIVE_INFINITY,y2:Number.NEGATIVE_INFINITY};for(let t=0;t<e.length;t++){const o=e[t];n=Ac(n,ys({...o.computedPosition,...o.dimensions}))}return Pc(n)}function ws(e,n,t={x:0,y:0,zoom:1},o=!1,l=!1){const a={..._o(n,t),width:n.width/t.zoom,height:n.height/t.zoom},r=[];for(const u of e){const{dimensions:f,selectable:v=!0,hidden:g=!1}=u,_=f.width??u.width??null,x=f.height??u.height??null;if(l&&!v||g)continue;const C=al(a,sl(u)),P=_===null||x===null,T=o&&C>0,I=(_??0)*(x??0);(P||T||C>=I||u.dragging)&&r.push(u)}return r}function xs(e,n){const t=new Set;if(typeof e=="string")t.add(e);else if(e.length>=1)for(const o of e)t.add(o.id);return n.filter(o=>t.has(o.source)||t.has(o.target))}function li(e,n,t,o,l,a=.1,r={x:0,y:0}){const u=n/(e.width*(1+a)),f=t/(e.height*(1+a)),v=Math.min(u,f),g=nn(v,o,l),_=e.x+e.width/2,x=e.y+e.height/2,C=n/2-_*g+(r.x??0),P=t/2-x*g+(r.y??0);return{x:C,y:P,zoom:g}}function Oc(e,n){return{x:n.x+e.x,y:n.y+e.y,z:(e.z>n.z?e.z:n.z)+1}}function bs(e,n){if(!e.parentNode)return!1;const t=n(e.parentNode);return t?t.selected?!0:bs(t,n):!1}function On(e,n){return typeof e>"u"?"":typeof e=="string"?e:`${n?`${n}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`}function ii(e,n,t){return e<n?nn(Math.abs(e-n),1,n)/n:e>t?-nn(Math.abs(e-t),1,n)/n:0}function ks(e,n,t=15,o=40){const l=ii(e.x,o,n.width-o)*t,a=ii(e.y,o,n.height-o)*t;return[l,a]}function Fo(e,n){if(n){const t=e.position.x+e.dimensions.width-n.dimensions.width,o=e.position.y+e.dimensions.height-n.dimensions.height;if(t>0||o>0||e.position.x<0||e.position.y<0){let l={};if(typeof n.style=="function"?l={...n.style(n)}:n.style&&(l={...n.style}),l.width=l.width??`${n.dimensions.width}px`,l.height=l.height??`${n.dimensions.height}px`,t>0)if(typeof l.width=="string"){const a=Number(l.width.replace("px",""));l.width=`${a+t}px`}else l.width+=t;if(o>0)if(typeof l.height=="string"){const a=Number(l.height.replace("px",""));l.height=`${a+o}px`}else l.height+=o;if(e.position.x<0){const a=Math.abs(e.position.x);if(n.position.x=n.position.x-a,typeof l.width=="string"){const r=Number(l.width.replace("px",""));l.width=`${r+a}px`}else l.width+=a;e.position.x=0}if(e.position.y<0){const a=Math.abs(e.position.y);if(n.position.y=n.position.y-a,typeof l.height=="string"){const r=Number(l.height.replace("px",""));l.height=`${r+a}px`}else l.height+=a;e.position.y=0}n.dimensions.width=Number(l.width.toString().replace("px","")),n.dimensions.height=Number(l.height.toString().replace("px","")),typeof n.style=="function"?n.style=a=>{const r=n.style;return{...r(a),...l}}:n.style={...n.style,...l}}}}function si(e,n){var t,o;const l=e.filter(r=>r.type==="add"||r.type==="remove");for(const r of l)if(r.type==="add")n.findIndex(f=>f.id===r.item.id)===-1&&n.push(r.item);else if(r.type==="remove"){const u=n.findIndex(f=>f.id===r.id);u!==-1&&n.splice(u,1)}const a=n.map(r=>r.id);for(const r of n)for(const u of e)if(u.id===r.id)switch(u.type){case"select":r.selected=u.selected;break;case"position":if(Cn(r)&&(typeof u.position<"u"&&(r.position=u.position),typeof u.dragging<"u"&&(r.dragging=u.dragging),r.expandParent&&r.parentNode)){const f=n[a.indexOf(r.parentNode)];f&&Cn(f)&&Fo(r,f)}break;case"dimensions":if(Cn(r)&&(typeof u.dimensions<"u"&&(r.dimensions=u.dimensions),typeof u.updateStyle<"u"&&u.updateStyle&&(r.style={...r.style||{},width:`${(t=u.dimensions)==null?void 0:t.width}px`,height:`${(o=u.dimensions)==null?void 0:o.height}px`}),typeof u.resizing<"u"&&(r.resizing=u.resizing),r.expandParent&&r.parentNode)){const f=n[a.indexOf(r.parentNode)];f&&Cn(f)&&(!!f.dimensions.width&&!!f.dimensions.height?Fo(r,f):Ot(()=>{Fo(r,f)}))}break}return n}function Ft(e,n){return{id:e,type:"select",selected:n}}function ai(e){return{item:e,type:"add"}}function di(e){return{id:e,type:"remove"}}function ri(e,n,t,o,l){return{id:e,source:n,target:t,sourceHandle:o||null,targetHandle:l||null,type:"remove"}}function Gt(e,n=new Set,t=!1){const o=[];for(const[l,a]of e){const r=n.has(l);!(a.selected===void 0&&!r)&&a.selected!==r&&(t&&(a.selected=r),o.push(Ft(a.id,r)))}return o}function ce(e){const n=new Set;let t=!1;const o=()=>n.size>0;e&&(t=!0,n.add(e));const l=u=>{n.delete(u)};return{on:u=>{e&&t&&n.delete(e),n.add(u);const f=()=>{l(u),e&&t&&n.add(e)};return bo(f),{off:f}},off:l,trigger:u=>Promise.all(Array.from(n).map(f=>f(u))),hasListeners:o,fns:n}}function ui(e,n,t){let o=e;do{if(o&&o.matches(n))return!0;if(o===t)return!1;o=o.parentElement}while(o);return!1}function Uc(e,n,t,o,l){var a,r;const u=[];for(const f of e)(f.selected||f.id===l)&&(!f.parentNode||!bs(f,o))&&(f.draggable||n&&typeof f.draggable>"u")&&u.push(dn({id:f.id,position:f.position||{x:0,y:0},distance:{x:t.x-((a=f.computedPosition)==null?void 0:a.x)||0,y:t.y-((r=f.computedPosition)==null?void 0:r.y)||0},from:f.computedPosition,extent:f.extent,parentNode:f.parentNode,dimensions:f.dimensions,expandParent:f.expandParent}));return u}function qo({id:e,dragItems:n,findNode:t}){const o=[];for(const l of n){const a=t(l.id);a&&o.push(a)}return[e?o.find(l=>l.id===e):o[0],o]}function Vs(e){if(Array.isArray(e))switch(e.length){case 1:return[e[0],e[0],e[0],e[0]];case 2:return[e[0],e[1],e[0],e[1]];case 3:return[e[0],e[1],e[2],e[1]];case 4:return e;default:return[0,0,0,0]}return[e,e,e,e]}function Bc(e,n,t){const[o,l,a,r]=typeof e!="string"?Vs(e.padding):[0,0,0,0];return t&&typeof t.computedPosition.x<"u"&&typeof t.computedPosition.y<"u"&&typeof t.dimensions.width<"u"&&typeof t.dimensions.height<"u"?[[t.computedPosition.x+r,t.computedPosition.y+o],[t.computedPosition.x+t.dimensions.width-l,t.computedPosition.y+t.dimensions.height-a]]:!1}function Rc(e,n,t,o){let l=e.extent||t;if((l==="parent"||!Array.isArray(l)&&(l==null?void 0:l.range)==="parent")&&!e.expandParent)if(e.parentNode&&o&&e.dimensions.width&&e.dimensions.height){const a=Bc(l,e,o);a&&(l=a)}else n(new pt(ct.NODE_EXTENT_INVALID,e.id)),l=t;else if(Array.isArray(l)){const a=(o==null?void 0:o.computedPosition.x)||0,r=(o==null?void 0:o.computedPosition.y)||0;l=[[l[0][0]+a,l[0][1]+r],[l[1][0]+a,l[1][1]+r]]}else if(l!=="parent"&&(l!=null&&l.range)&&Array.isArray(l.range)){const[a,r,u,f]=Vs(l.padding),v=(o==null?void 0:o.computedPosition.x)||0,g=(o==null?void 0:o.computedPosition.y)||0;l=[[l.range[0][0]+v+f,l.range[0][1]+g+a],[l.range[1][0]+v-r,l.range[1][1]+g-u]]}return l==="parent"?[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]]:l}function Hc({width:e,height:n},t){return[t[0],[t[1][0]-(e||0),t[1][1]-(n||0)]]}function wl(e,n,t,o,l){const a=Hc(e.dimensions,Rc(e,t,o,l)),r=fs(n,a);return{position:{x:r.x-((l==null?void 0:l.computedPosition.x)||0),y:r.y-((l==null?void 0:l.computedPosition.y)||0)},computedPosition:r}}function wo(e,n,t=$e.Left){const o=((n==null?void 0:n.x)??0)+e.computedPosition.x,l=((n==null?void 0:n.y)??0)+e.computedPosition.y,{width:a,height:r}=n??qc(e);switch((n==null?void 0:n.position)??t){case $e.Top:return{x:o+a/2,y:l};case $e.Right:return{x:o+a,y:l+r/2};case $e.Bottom:return{x:o+a/2,y:l+r};case $e.Left:return{x:o,y:l+r/2}}}function ci(e=[],n){return e.length&&(n?e.find(t=>t.id===n):e[0])||null}function Lc({sourcePos:e,targetPos:n,sourceWidth:t,sourceHeight:o,targetWidth:l,targetHeight:a,width:r,height:u,viewport:f}){const v={x:Math.min(e.x,n.x),y:Math.min(e.y,n.y),x2:Math.max(e.x+t,n.x+l),y2:Math.max(e.y+o,n.y+a)};v.x===v.x2&&(v.x2+=1),v.y===v.y2&&(v.y2+=1);const g=ys({x:(0-f.x)/f.zoom,y:(0-f.y)/f.zoom,width:r/f.zoom,height:u/f.zoom}),_=Math.max(0,Math.min(g.x2,v.x2)-Math.max(g.x,v.x)),x=Math.max(0,Math.min(g.y2,v.y2)-Math.max(g.y,v.y));return Math.ceil(_*x)>0}function Fc(e,n,t=!1){const o=typeof e.zIndex=="number";let l=o?e.zIndex:0;const a=n(e.source),r=n(e.target);return!a||!r?0:(t&&(l=o?e.zIndex:Math.max(a.computedPosition.z||0,r.computedPosition.z||0)),l)}var ct=(e=>(e.MISSING_STYLES="MISSING_STYLES",e.MISSING_VIEWPORT_DIMENSIONS="MISSING_VIEWPORT_DIMENSIONS",e.NODE_INVALID="NODE_INVALID",e.NODE_NOT_FOUND="NODE_NOT_FOUND",e.NODE_MISSING_PARENT="NODE_MISSING_PARENT",e.NODE_TYPE_MISSING="NODE_TYPE_MISSING",e.NODE_EXTENT_INVALID="NODE_EXTENT_INVALID",e.EDGE_INVALID="EDGE_INVALID",e.EDGE_NOT_FOUND="EDGE_NOT_FOUND",e.EDGE_SOURCE_MISSING="EDGE_SOURCE_MISSING",e.EDGE_TARGET_MISSING="EDGE_TARGET_MISSING",e.EDGE_TYPE_MISSING="EDGE_TYPE_MISSING",e.EDGE_SOURCE_TARGET_SAME="EDGE_SOURCE_TARGET_SAME",e.EDGE_SOURCE_TARGET_MISSING="EDGE_SOURCE_TARGET_MISSING",e.EDGE_ORPHANED="EDGE_ORPHANED",e.USEVUEFLOW_OPTIONS="USEVUEFLOW_OPTIONS",e))(ct||{});const pi={MISSING_STYLES:()=>"It seems that you haven't loaded the necessary styles. Please import '@vue-flow/core/dist/style.css' to ensure that the graph is rendered correctly",MISSING_VIEWPORT_DIMENSIONS:()=>"The Vue Flow parent container needs a width and a height to render the graph",NODE_INVALID:e=>`Node is invalid
Node: ${e}`,NODE_NOT_FOUND:e=>`Node not found
Node: ${e}`,NODE_MISSING_PARENT:(e,n)=>`Node is missing a parent
Node: ${e}
Parent: ${n}`,NODE_TYPE_MISSING:e=>`Node type is missing
Type: ${e}`,NODE_EXTENT_INVALID:e=>`Only child nodes can use a parent extent
Node: ${e}`,EDGE_INVALID:e=>`An edge needs a source and a target
Edge: ${e}`,EDGE_SOURCE_MISSING:(e,n)=>`Edge source is missing
Edge: ${e} 
Source: ${n}`,EDGE_TARGET_MISSING:(e,n)=>`Edge target is missing
Edge: ${e} 
Target: ${n}`,EDGE_TYPE_MISSING:e=>`Edge type is missing
Type: ${e}`,EDGE_SOURCE_TARGET_SAME:(e,n,t)=>`Edge source and target are the same
Edge: ${e} 
Source: ${n} 
Target: ${t}`,EDGE_SOURCE_TARGET_MISSING:(e,n,t)=>`Edge source or target is missing
Edge: ${e} 
Source: ${n} 
Target: ${t}`,EDGE_ORPHANED:e=>`Edge was orphaned (suddenly missing source or target) and has been removed
Edge: ${e}`,EDGE_NOT_FOUND:e=>`Edge not found
Edge: ${e}`,USEVUEFLOW_OPTIONS:()=>"The options parameter is deprecated and will be removed in the next major version. Please use the id parameter instead"};class pt extends Error{constructor(n,...t){var o;super((o=pi[n])==null?void 0:o.call(pi,...t)),this.name="VueFlowError",this.code=n,this.args=t}}function xl(e){return"clientX"in e}function Yt(e,n){var t,o;const l=xl(e),a=l?e.clientX:(t=e.touches)==null?void 0:t[0].clientX,r=l?e.clientY:(o=e.touches)==null?void 0:o[0].clientY;return{x:a-((n==null?void 0:n.left)??0),y:r-((n==null?void 0:n.top)??0)}}const xo=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function qc(e){var n,t;return{width:((n=e.dimensions)==null?void 0:n.width)??e.width??0,height:((t=e.dimensions)==null?void 0:t.height)??e.height??0}}function $s(){return{handleDomNode:null,isValid:!1,connection:{source:"",target:"",sourceHandle:null,targetHandle:null},endHandle:null}}function Go(e){e==null||e.classList.remove("valid","connecting","vue-flow__handle-valid","vue-flow__handle-connecting")}function fi(e,n,t,o){const l=[];for(const a of n[t]||[])if(`${e.id}-${a.id}-${t}`!==o){const{x:r,y:u}=wo(e,a);l.push({id:a.id||null,type:t,nodeId:e.id,x:r,y:u})}return l}function Gc(e,n,t,o,l,a){const{x:r,y:u}=Yt(e),v=n.elementsFromPoint(r,u).find(P=>P.classList.contains("vue-flow__handle"));if(v){const P=v.getAttribute("data-nodeid");if(P){const T=bl(void 0,v),I=v.getAttribute("data-handleid"),A=a({nodeId:P,id:I,type:T});if(A){const R=l.find(k=>k.nodeId===P&&k.type===T&&k.id===I);return{handle:{id:I,type:T,nodeId:P,x:(R==null?void 0:R.x)||t.x,y:(R==null?void 0:R.y)||t.y},validHandleResult:A}}}}let g=[],_=Number.POSITIVE_INFINITY;for(const P of l){const T=Math.sqrt((P.x-t.x)**2+(P.y-t.y)**2);if(T<=o){const I=a(P);T<=_&&(T<_?g=[{handle:P,validHandleResult:I}]:T===_&&g.push({handle:P,validHandleResult:I}),_=T)}}if(!g.length)return{handle:null,validHandleResult:$s()};if(g.length===1)return g[0];const x=g.some(({validHandleResult:P})=>P.isValid),C=g.some(({handle:P})=>P.type==="target");return g.find(({handle:P,validHandleResult:T})=>C?P.type==="target":x?T.isValid:!0)||g[0]}function vi(e,n,t,o,l,a,r,u,f,v,g){const _=a==="target",x=u.querySelector(`.vue-flow__handle[data-id="${n==null?void 0:n.nodeId}-${n==null?void 0:n.id}-${n==null?void 0:n.type}"]`),{x:C,y:P}=Yt(e),T=u.elementFromPoint(C,P),I=T!=null&&T.classList.contains("vue-flow__handle")?T:x,A=$s();if(I){A.handleDomNode=I;const R=bl(void 0,I),k=I.getAttribute("data-nodeid"),D=I.getAttribute("data-handleid"),K=I.classList.contains("connectable"),ge=I.classList.contains("connectableend"),ae={source:_?k:o,sourceHandle:_?D:l,target:_?o:k,targetHandle:_?l:D};A.connection=ae,K&&ge&&(t===Xt.Strict?_&&R==="source"||!_&&R==="target":k!==o||D!==l)&&(A.isValid=r(ae,{edges:f,nodes:v,sourceNode:g(ae.source),targetNode:g(ae.target)}),A.endHandle={nodeId:k,handleId:D,type:R,position:A.isValid?I.getAttribute("data-handlepos"):null})}return A}function Yc({nodes:e,nodeId:n,handleId:t,handleType:o}){const l=[];for(let a=0;a<e.length;a++){const r=e[a],{handleBounds:u}=r;let f=[],v=[];u&&(f=fi(r,u,"source",`${n}-${t}-${o}`),v=fi(r,u,"target",`${n}-${t}-${o}`)),l.push(...f,...v)}return l}function bl(e,n){return e||(n!=null&&n.classList.contains("target")?"target":n!=null&&n.classList.contains("source")?"source":null)}function Xc(e,n){let t=null;return n?t="valid":e&&!n&&(t="invalid"),t}const Zc=["production","prod"];function Co(e,...n){Es()&&console.warn(`[Vue Flow]: ${e}`,...n)}function Es(){return!Zc.includes("production")}function gi(e,n,t,o){const l=n.querySelectorAll(`.vue-flow__handle${e}`);return Array.from(l).map(r=>{const u=r.getBoundingClientRect();return{id:r.getAttribute("data-handleid"),position:r.getAttribute("data-handlepos"),x:(u.left-t.left)/o,y:(u.top-t.top)/o,...So(r)}})}function dl(e,n,t,o,l,a=!1,r){l.value=!1,e.selected?(a||e.selected&&n)&&(o([e]),Ot(()=>{r.blur()})):t([e])}function ut(e){return typeof Y(e)<"u"}function jc(e,n,t,o){if(!e||!e.source||!e.target)return t(new pt(ct.EDGE_INVALID,(e==null?void 0:e.id)??"[ID UNKNOWN]")),!1;let l;return Zt(e)?l=e:l={...e,id:ms(e)},l=vs(l,void 0,o),Tc(l,n)?!1:l}function Wc(e,n,t,o,l,a){if(!n.source||!n.target)return a(new pt(ct.EDGE_INVALID,e.id)),!1;const r=o(e.id);if(!r)return a(new pt(ct.EDGE_NOT_FOUND,e.id)),!1;const{id:u,...f}=e,v={...f,id:l?ms(n):u,source:n.source,target:n.target,sourceHandle:n.sourceHandle,targetHandle:n.targetHandle};return t.splice(t.indexOf(r),1,v),v}function mi(e,n,t){const o={},l=[];for(let a=0;a<e.length;++a){const r=e[a];if(!Qt(r)){t(new pt(ct.NODE_INVALID,r==null?void 0:r.id)||`[ID UNKNOWN|INDEX ${a}]`);continue}const u=Mc(r,n(r.id),r.parentNode);r.parentNode&&(o[r.parentNode]=!0),l[a]=u}for(const a of l){const r=n(a.parentNode)||l.find(u=>u.id===a.parentNode);a.parentNode&&!r&&t(new pt(ct.NODE_MISSING_PARENT,a.id,a.parentNode)),(a.parentNode||o[a.id])&&(o[a.id]&&(a.isParent=!0),r&&(r.isParent=!0))}return l}function hi(e,n){e.clear();for(const t of n){const{id:o,source:l,target:a,sourceHandle:r=null,targetHandle:u=null}=t,f=`${l}-source-${r}`,v=`${a}-target-${u}`,g=e.get(f)||new Map,_=e.get(v)||new Map,x=dn({edgeId:o,source:l,target:a,sourceHandle:r,targetHandle:u});e.set(f,g.set(`${a}-${u}`,x)),e.set(v,_.set(`${l}-${r}`,x))}}function yi(e,n,t,o,l,a,r,u){const f=[];for(const v of e){const g=Zt(v)?v:jc(v,u,l,a);if(!g)continue;const _=t(g.source),x=t(g.target);if(!_||!x){l(new pt(ct.EDGE_SOURCE_TARGET_MISSING,g.id,g.source,g.target));continue}if(!_){l(new pt(ct.EDGE_SOURCE_MISSING,g.id,g.source));continue}if(!x){l(new pt(ct.EDGE_TARGET_MISSING,g.id,g.target));continue}if(n&&!n(g,{edges:u,nodes:r,sourceNode:_,targetNode:x})){l(new pt(ct.EDGE_INVALID,g.id));continue}const C=o(g.id);f.push({...vs(g,C,a),sourceNode:_,targetNode:x})}return f}const _i=Symbol("vueFlow"),Ss=Symbol("nodeId"),Cs=Symbol("nodeRef"),Kc=Symbol("edgeId"),Jc=Symbol("edgeRef"),No=Symbol("slots");function Ns(e){const{vueFlowRef:n,snapToGrid:t,snapGrid:o,noDragClassName:l,nodes:a,nodeExtent:r,nodeDragThreshold:u,viewport:f,autoPanOnNodeDrag:v,autoPanSpeed:g,nodesDraggable:_,panBy:x,findNode:C,multiSelectionActive:P,nodesSelectionActive:T,selectNodesOnDrag:I,removeSelectedElements:A,addSelectedNodes:R,updateNodePositions:k,emits:D}=tt(),{onStart:K,onDrag:ge,onStop:ae,onClick:de,el:ve,disabled:Q,id:le,selectable:O,dragHandle:Ee}=e,E=q(!1);let F=[],b,U=null,j={x:void 0,y:void 0},te={x:0,y:0},ne=null,pe=!1,Ve=0,re=!1;const se=tp(),ke=({x:ue,y:we})=>{j={x:ue,y:we};let Ce=!1;if(F=F.map(V=>{const w={x:ue-V.distance.x,y:we-V.distance.y};t.value&&(w.x=o.value[0]*Math.round(w.x/o.value[0]),w.y=o.value[1]*Math.round(w.y/o.value[1]));const{computedPosition:p}=wl(V,w,D.error,r.value,V.parentNode?C(V.parentNode):void 0);return Ce=Ce||V.position.x!==p.x||V.position.y!==p.y,V.position=p,V}),!!Ce&&(k(F,!0,!0),E.value=!0,ne)){const[V,w]=qo({id:le,dragItems:F,findNode:C});ge({event:ne,node:V,nodes:w})}},Ue=()=>{if(!U)return;const[ue,we]=ks(te,U,g.value);if(ue!==0||we!==0){const Ce={x:(j.x??0)-ue/f.value.zoom,y:(j.y??0)-we/f.value.zoom};x({x:ue,y:we})&&ke(Ce)}Ve=requestAnimationFrame(Ue)},Ae=(ue,we)=>{pe=!0;const Ce=C(le);!I.value&&!P.value&&Ce&&(Ce.selected||A()),Ce&&Qe(O)&&I.value&&dl(Ce,P.value,R,A,T,!1,we);const V=se(ue);if(j=V,F=Uc(a.value,_.value,V,C,le),F.length){const[w,p]=qo({id:le,dragItems:F,findNode:C});K({event:ue.sourceEvent,node:w,nodes:p})}},Le=(ue,we)=>{var Ce;ue.sourceEvent.type==="touchmove"&&ue.sourceEvent.touches.length>1||(u.value===0&&Ae(ue,we),j=se(ue),U=((Ce=n.value)==null?void 0:Ce.getBoundingClientRect())||null,te=Yt(ue.sourceEvent,U))},Ie=(ue,we)=>{const Ce=se(ue);if(!re&&pe&&v.value&&(re=!0,Ue()),!pe){const V=Ce.xSnapped-(j.x??0),w=Ce.ySnapped-(j.y??0);Math.sqrt(V*V+w*w)>u.value&&Ae(ue,we)}(j.x!==Ce.xSnapped||j.y!==Ce.ySnapped)&&F.length&&pe&&(ne=ue.sourceEvent,te=Yt(ue.sourceEvent,U),ke(Ce))},Te=ue=>{if(!pe&&!E.value&&!P.value){const we=se(ue),Ce=we.xSnapped-(j.x??0),V=we.ySnapped-(j.y??0),w=Math.sqrt(Ce*Ce+V*V);w!==0&&w<=u.value&&(de==null||de(ue.sourceEvent));return}if(E.value=!1,re=!1,pe=!1,j={x:void 0,y:void 0},cancelAnimationFrame(Ve),F.length){k(F,!1,!1);const[we,Ce]=qo({id:le,dragItems:F,findNode:C});ae({event:ue.sourceEvent,node:we,nodes:Ce})}};return Ge([()=>Qe(Q),ve],([ue,we],Ce,V)=>{if(we){const w=Vt(we);ue||(b=Ar().on("start",p=>Le(p,we)).on("drag",p=>Ie(p,we)).on("end",p=>Te(p)).filter(p=>{const $=p.target,M=Qe(Ee);return!p.button&&(!l.value||!ui($,`.${l.value}`,we)&&(!M||ui($,M,we)))}),w.call(b)),V(()=>{w.on(".drag",null),b&&(b.on("start",null),b.on("drag",null),b.on("end",null))})}}),E}function Qc(){return{doubleClick:ce(),click:ce(),mouseEnter:ce(),mouseMove:ce(),mouseLeave:ce(),contextMenu:ce(),updateStart:ce(),update:ce(),updateEnd:ce()}}function ep(e,n){const t=Qc();return t.doubleClick.on(o=>{var l,a;n.edgeDoubleClick(o),(a=(l=e.events)==null?void 0:l.doubleClick)==null||a.call(l,o)}),t.click.on(o=>{var l,a;n.edgeClick(o),(a=(l=e.events)==null?void 0:l.click)==null||a.call(l,o)}),t.mouseEnter.on(o=>{var l,a;n.edgeMouseEnter(o),(a=(l=e.events)==null?void 0:l.mouseEnter)==null||a.call(l,o)}),t.mouseMove.on(o=>{var l,a;n.edgeMouseMove(o),(a=(l=e.events)==null?void 0:l.mouseMove)==null||a.call(l,o)}),t.mouseLeave.on(o=>{var l,a;n.edgeMouseLeave(o),(a=(l=e.events)==null?void 0:l.mouseLeave)==null||a.call(l,o)}),t.contextMenu.on(o=>{var l,a;n.edgeContextMenu(o),(a=(l=e.events)==null?void 0:l.contextMenu)==null||a.call(l,o)}),t.updateStart.on(o=>{var l,a;n.edgeUpdateStart(o),(a=(l=e.events)==null?void 0:l.updateStart)==null||a.call(l,o)}),t.update.on(o=>{var l,a;n.edgeUpdate(o),(a=(l=e.events)==null?void 0:l.update)==null||a.call(l,o)}),t.updateEnd.on(o=>{var l,a;n.edgeUpdateEnd(o),(a=(l=e.events)==null?void 0:l.updateEnd)==null||a.call(l,o)}),Object.entries(t).reduce((o,[l,a])=>(o.emit[l]=a.trigger,o.on[l]=a.on,o),{emit:{},on:{}})}function tp(){const{viewport:e,snapGrid:n,snapToGrid:t}=tt();return({sourceEvent:o})=>{const l=o.touches?o.touches[0].clientX:o.clientX,a=o.touches?o.touches[0].clientY:o.clientY,r={x:(l-e.value.x)/e.value.zoom,y:(a-e.value.y)/e.value.zoom};return{xSnapped:t.value?n.value[0]*Math.round(r.x/n.value[0]):r.x,ySnapped:t.value?n.value[1]*Math.round(r.y/n.value[1]):r.y,...r}}}function lo(){return!0}function zs({handleId:e,nodeId:n,type:t,isValidConnection:o,edgeUpdaterType:l,onEdgeUpdate:a,onEdgeUpdateEnd:r}){const{vueFlowRef:u,connectionMode:f,connectionRadius:v,connectOnClick:g,connectionClickStartHandle:_,nodesConnectable:x,autoPanOnConnect:C,autoPanSpeed:P,findNode:T,panBy:I,startConnection:A,updateConnection:R,endConnection:k,emits:D,viewport:K,edges:ge,nodes:ae,isValidConnection:de}=tt();let ve=null,Q=!1,le=null,O=null;function Ee(F){var b;const U=Qe(t)==="target",j=xl(F),te=oi(F.target);if(j&&F.button===0||!j){let ne=function(p){we=Yt(p,Te);const{handle:$,validHandleResult:M}=Gc(p,te,_o(we,K.value,!1,[1,1]),v.value,V,fe=>vi(p,fe,f.value,Qe(n),Qe(e),U?"target":"source",re,te,ge.value,ae.value,T));if(se=$,Ce||(w(),Ce=!0),ve=M.connection,Q=M.isValid,le=M.handleDomNode,!(Q&&se&&(O!=null&&O.endHandle)&&M.endHandle&&O.endHandle.type===M.endHandle.type&&O.endHandle.nodeId===M.endHandle.nodeId&&O.endHandle.handleId===M.endHandle.handleId)){if(R(se&&Q?hs({x:se.x,y:se.y},K.value):we,M.endHandle,Xc(!!se,Q)),O=M,!se&&!Q&&!le)return Go(ue);ve&&ve.source!==ve.target&&le&&(Go(ue),ue=le,le.classList.add("connecting","vue-flow__handle-connecting"),le.classList.toggle("valid",Q),le.classList.toggle("vue-flow__handle-valid",Q))}},pe=function(p){(se||le)&&ve&&Q&&(a?a(p,ve):D.connect(ve)),D.connectEnd(p),l&&(r==null||r(p)),Go(ue),cancelAnimationFrame(ke),k(p),Ce=!1,Q=!1,ve=null,le=null,te.removeEventListener("mousemove",ne),te.removeEventListener("mouseup",pe),te.removeEventListener("touchmove",ne),te.removeEventListener("touchend",pe)};const Ve=T(Qe(n));let re=Qe(o)||de.value||lo;!re&&Ve&&(re=(U?Ve.isValidSourcePos:Ve.isValidTargetPos)||lo);let se,ke=0;const{x:Ue,y:Ae}=Yt(F),Le=te==null?void 0:te.elementFromPoint(Ue,Ae),Ie=bl(Qe(l),Le),Te=(b=u.value)==null?void 0:b.getBoundingClientRect();if(!Te||!Ie)return;let ue,we=Yt(F,Te),Ce=!1;const V=Yc({nodes:ae.value,nodeId:Qe(n),handleId:Qe(e),handleType:Ie}),w=()=>{if(!C.value)return;const[p,$]=ks(we,Te,P.value);I({x:p,y:$}),ke=requestAnimationFrame(w)};A({nodeId:Qe(n),handleId:Qe(e),type:Ie,position:(Le==null?void 0:Le.getAttribute("data-handlepos"))||$e.Top},{x:Ue-Te.left,y:Ae-Te.top}),D.connectStart({event:F,nodeId:Qe(n),handleId:Qe(e),handleType:Ie}),te.addEventListener("mousemove",ne),te.addEventListener("mouseup",pe),te.addEventListener("touchmove",ne),te.addEventListener("touchend",pe)}}function E(F){if(!g.value)return;const b=Qe(t)==="target";if(!_.value)D.clickConnectStart({event:F,nodeId:Qe(n),handleId:Qe(e)}),A({nodeId:Qe(n),type:Qe(t),handleId:Qe(e)},void 0,!0);else{let U=Qe(o)||de.value||lo;const j=T(Qe(n));if(!U&&j&&(U=(b?j.isValidSourcePos:j.isValidTargetPos)||lo),j&&(typeof j.connectable>"u"?x.value:j.connectable)===!1)return;const te=oi(F.target),{connection:ne,isValid:pe}=vi(F,{nodeId:Qe(n),id:Qe(e),type:Qe(t)},f.value,_.value.nodeId,_.value.handleId||null,_.value.type,U,te,ge.value,ae.value,T),Ve=ne.source===ne.target;pe&&!Ve&&D.connect(ne),D.clickConnectEnd(F),k(F,!0)}}return{handlePointerDown:Ee,handleClick:E}}function np(){return mn(Ss,"")}function Ms(e){const n=e??np()??"",t=mn(Cs,q(null)),{findNode:o,edges:l,emits:a}=tt(),r=o(n);return r||a.error(new pt(ct.NODE_NOT_FOUND,n)),{id:n,nodeEl:t,node:r,parentNode:Oe(()=>o(r.parentNode)),connectedEdges:Oe(()=>xs([r],l.value))}}function op(){return{doubleClick:ce(),click:ce(),mouseEnter:ce(),mouseMove:ce(),mouseLeave:ce(),contextMenu:ce(),dragStart:ce(),drag:ce(),dragStop:ce()}}function lp(e,n){const t=op();return t.doubleClick.on(o=>{var l,a;n.nodeDoubleClick(o),(a=(l=e.events)==null?void 0:l.doubleClick)==null||a.call(l,o)}),t.click.on(o=>{var l,a;n.nodeClick(o),(a=(l=e.events)==null?void 0:l.click)==null||a.call(l,o)}),t.mouseEnter.on(o=>{var l,a;n.nodeMouseEnter(o),(a=(l=e.events)==null?void 0:l.mouseEnter)==null||a.call(l,o)}),t.mouseMove.on(o=>{var l,a;n.nodeMouseMove(o),(a=(l=e.events)==null?void 0:l.mouseMove)==null||a.call(l,o)}),t.mouseLeave.on(o=>{var l,a;n.nodeMouseLeave(o),(a=(l=e.events)==null?void 0:l.mouseLeave)==null||a.call(l,o)}),t.contextMenu.on(o=>{var l,a;n.nodeContextMenu(o),(a=(l=e.events)==null?void 0:l.contextMenu)==null||a.call(l,o)}),t.dragStart.on(o=>{var l,a;n.nodeDragStart(o),(a=(l=e.events)==null?void 0:l.dragStart)==null||a.call(l,o)}),t.drag.on(o=>{var l,a;n.nodeDrag(o),(a=(l=e.events)==null?void 0:l.drag)==null||a.call(l,o)}),t.dragStop.on(o=>{var l,a;n.nodeDragStop(o),(a=(l=e.events)==null?void 0:l.dragStop)==null||a.call(l,o)}),Object.entries(t).reduce((o,[l,a])=>(o.emit[l]=a.trigger,o.on[l]=a.on,o),{emit:{},on:{}})}function Is(){const{getSelectedNodes:e,nodeExtent:n,updateNodePositions:t,findNode:o,snapGrid:l,snapToGrid:a,nodesDraggable:r,emits:u}=tt();return(f,v=!1)=>{const g=a.value?l.value[0]:5,_=a.value?l.value[1]:5,x=v?4:1,C=f.x*g*x,P=f.y*_*x,T=[];for(const I of e.value)if(I.draggable||r&&typeof I.draggable>"u"){const A={x:I.computedPosition.x+C,y:I.computedPosition.y+P},{computedPosition:R}=wl(I,A,u.error,n.value,I.parentNode?o(I.parentNode):void 0);T.push({id:I.id,position:R,from:I.position,distance:{x:f.x,y:f.y},dimensions:I.dimensions})}t(T,!0,!1)}}const Yo=.1;function Lt(){return Co("Viewport not initialized yet."),Promise.resolve(!1)}const ip={zoomIn:Lt,zoomOut:Lt,zoomTo:Lt,fitView:Lt,setCenter:Lt,fitBounds:Lt,project:e=>e,screenToFlowCoordinate:e=>e,flowToScreenCoordinate:e=>e,setViewport:Lt,setTransform:Lt,getViewport:()=>({x:0,y:0,zoom:1}),getTransform:()=>({x:0,y:0,zoom:1}),viewportInitialized:!1};function sp(e){function n(o,l){return new Promise(a=>{e.d3Selection&&e.d3Zoom?e.d3Zoom.scaleBy(Xo(e.d3Selection,l,()=>{a(!0)}),o):a(!1)})}function t(o,l,a,r){return new Promise(u=>{const{x:f,y:v}=fs({x:-o,y:-l},e.translateExtent),g=gn.translate(-f,-v).scale(a);e.d3Selection&&e.d3Zoom?e.d3Zoom.transform(Xo(e.d3Selection,r,()=>{u(!0)}),g):u(!1)})}return Oe(()=>e.d3Zoom&&e.d3Selection&&e.dimensions.width&&e.dimensions.height?{viewportInitialized:!0,zoomIn:l=>n(1.2,l==null?void 0:l.duration),zoomOut:l=>n(1/1.2,l==null?void 0:l.duration),zoomTo:(l,a)=>new Promise(r=>{e.d3Selection&&e.d3Zoom?e.d3Zoom.scaleTo(Xo(e.d3Selection,a==null?void 0:a.duration,()=>{r(!0)}),l):r(!1)}),setViewport:(l,a)=>t(l.x,l.y,l.zoom,a==null?void 0:a.duration),setTransform:(l,a)=>t(l.x,l.y,l.zoom,a==null?void 0:a.duration),getViewport:()=>({x:e.viewport.x,y:e.viewport.y,zoom:e.viewport.zoom}),getTransform:()=>({x:e.viewport.x,y:e.viewport.y,zoom:e.viewport.zoom}),fitView:(l={padding:Yo,includeHiddenNodes:!1,duration:0})=>{var a,r;const u=[];for(const x of e.nodes)x.dimensions.width&&x.dimensions.height&&((l==null?void 0:l.includeHiddenNodes)||!x.hidden)&&(!((a=l.nodes)!=null&&a.length)||(r=l.nodes)!=null&&r.length&&l.nodes.includes(x.id))&&u.push(x);if(!u.length)return Promise.resolve(!1);const f=_s(u),{x:v,y:g,zoom:_}=li(f,e.dimensions.width,e.dimensions.height,l.minZoom??e.minZoom,l.maxZoom??e.maxZoom,l.padding??Yo,l.offset);return t(v,g,_,l==null?void 0:l.duration)},setCenter:(l,a,r)=>{const u=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:e.maxZoom,f=e.dimensions.width/2-l*u,v=e.dimensions.height/2-a*u;return t(f,v,u,r==null?void 0:r.duration)},fitBounds:(l,a={padding:Yo})=>{const{x:r,y:u,zoom:f}=li(l,e.dimensions.width,e.dimensions.height,e.minZoom,e.maxZoom,a.padding);return t(r,u,f,a==null?void 0:a.duration)},project:l=>_o(l,e.viewport,e.snapToGrid,e.snapGrid),screenToFlowCoordinate:l=>{if(e.vueFlowRef){const{x:a,y:r}=e.vueFlowRef.getBoundingClientRect(),u={x:l.x-a,y:l.y-r};return _o(u,e.viewport,e.snapToGrid,e.snapGrid)}return{x:0,y:0}},flowToScreenCoordinate:l=>{if(e.vueFlowRef){const{x:a,y:r}=e.vueFlowRef.getBoundingClientRect(),u={x:l.x+a,y:l.y+r};return hs(u,e.viewport)}return{x:0,y:0}}}:ip)}function Xo(e,n=0,t){return e.transition().duration(n).on("end",t)}function ap(e,n,t){const o=Si(!0);return o.run(()=>{const l=()=>{o.run(()=>{let T,I,A=!!(t.nodes.value.length||t.edges.value.length);T=sn([e.modelValue,()=>{var R,k;return(k=(R=e.modelValue)==null?void 0:R.value)==null?void 0:k.length}],([R])=>{R&&Array.isArray(R)&&(I==null||I.pause(),t.setElements(R),!I&&!A&&R.length?A=!0:I==null||I.resume())}),I=sn([t.nodes,t.edges,()=>t.edges.value.length,()=>t.nodes.value.length],([R,k])=>{var D;(D=e.modelValue)!=null&&D.value&&Array.isArray(e.modelValue.value)&&(T==null||T.pause(),e.modelValue.value=[...R,...k],Ot(()=>{T==null||T.resume()}))},{immediate:A}),ao(()=>{T==null||T.stop(),I==null||I.stop()})})},a=()=>{o.run(()=>{let T,I,A=!!t.nodes.value.length;T=sn([e.nodes,()=>{var R,k;return(k=(R=e.nodes)==null?void 0:R.value)==null?void 0:k.length}],([R])=>{R&&Array.isArray(R)&&(I==null||I.pause(),t.setNodes(R),!I&&!A&&R.length?A=!0:I==null||I.resume())}),I=sn([t.nodes,()=>t.nodes.value.length],([R])=>{var k;(k=e.nodes)!=null&&k.value&&Array.isArray(e.nodes.value)&&(T==null||T.pause(),e.nodes.value=[...R],Ot(()=>{T==null||T.resume()}))},{immediate:A}),ao(()=>{T==null||T.stop(),I==null||I.stop()})})},r=()=>{o.run(()=>{let T,I,A=!!t.edges.value.length;T=sn([e.edges,()=>{var R,k;return(k=(R=e.edges)==null?void 0:R.value)==null?void 0:k.length}],([R])=>{R&&Array.isArray(R)&&(I==null||I.pause(),t.setEdges(R),!I&&!A&&R.length?A=!0:I==null||I.resume())}),I=sn([t.edges,()=>t.edges.value.length],([R])=>{var k;(k=e.edges)!=null&&k.value&&Array.isArray(e.edges.value)&&(T==null||T.pause(),e.edges.value=[...R],Ot(()=>{T==null||T.resume()}))},{immediate:A}),ao(()=>{T==null||T.stop(),I==null||I.stop()})})},u=()=>{o.run(()=>{Ge(()=>n.maxZoom,()=>{n.maxZoom&&ut(n.maxZoom)&&t.setMaxZoom(n.maxZoom)},{immediate:!0})})},f=()=>{o.run(()=>{Ge(()=>n.minZoom,()=>{n.minZoom&&ut(n.minZoom)&&t.setMinZoom(n.minZoom)},{immediate:!0})})},v=()=>{o.run(()=>{Ge(()=>n.translateExtent,()=>{n.translateExtent&&ut(n.translateExtent)&&t.setTranslateExtent(n.translateExtent)},{immediate:!0})})},g=()=>{o.run(()=>{Ge(()=>n.nodeExtent,()=>{n.nodeExtent&&ut(n.nodeExtent)&&t.setNodeExtent(n.nodeExtent)},{immediate:!0})})},_=()=>{o.run(()=>{Ge(()=>n.applyDefault,()=>{ut(n.applyDefault)&&(t.applyDefault.value=n.applyDefault)},{immediate:!0})})},x=()=>{o.run(()=>{const T=async I=>{let A=I;typeof n.autoConnect=="function"&&(A=await n.autoConnect(I)),A!==!1&&t.addEdges([A])};Ge(()=>n.autoConnect,()=>{ut(n.autoConnect)&&(t.autoConnect.value=n.autoConnect)},{immediate:!0}),Ge(t.autoConnect,(I,A,R)=>{I?t.onConnect(T):t.hooks.value.connect.off(T),R(()=>{t.hooks.value.connect.off(T)})},{immediate:!0})})},C=()=>{const T=["id","modelValue","translateExtent","nodeExtent","edges","nodes","maxZoom","minZoom","applyDefault","autoConnect"];for(const I of Object.keys(n)){const A=I;if(!T.includes(A)){const R=ot(()=>n[A]),k=t[A];pl(k)&&o.run(()=>{Ge(R,D=>{ut(D)&&(k.value=D)},{immediate:!0})})}}};(()=>{l(),a(),r(),f(),u(),v(),g(),_(),x(),C()})()}),()=>o.stop()}function dp(){return{edgesChange:ce(),nodesChange:ce(),nodeDoubleClick:ce(),nodeClick:ce(),nodeMouseEnter:ce(),nodeMouseMove:ce(),nodeMouseLeave:ce(),nodeContextMenu:ce(),nodeDragStart:ce(),nodeDrag:ce(),nodeDragStop:ce(),nodesInitialized:ce(),miniMapNodeClick:ce(),miniMapNodeDoubleClick:ce(),miniMapNodeMouseEnter:ce(),miniMapNodeMouseMove:ce(),miniMapNodeMouseLeave:ce(),connect:ce(),connectStart:ce(),connectEnd:ce(),clickConnectStart:ce(),clickConnectEnd:ce(),paneReady:ce(),init:ce(),move:ce(),moveStart:ce(),moveEnd:ce(),selectionDragStart:ce(),selectionDrag:ce(),selectionDragStop:ce(),selectionContextMenu:ce(),selectionStart:ce(),selectionEnd:ce(),viewportChangeStart:ce(),viewportChange:ce(),viewportChangeEnd:ce(),paneScroll:ce(),paneClick:ce(),paneContextMenu:ce(),paneMouseEnter:ce(),paneMouseMove:ce(),paneMouseLeave:ce(),edgeContextMenu:ce(),edgeMouseEnter:ce(),edgeMouseMove:ce(),edgeMouseLeave:ce(),edgeDoubleClick:ce(),edgeClick:ce(),edgeUpdateStart:ce(),edgeUpdate:ce(),edgeUpdateEnd:ce(),updateNodeInternals:ce(),error:ce(e=>Co(e.message))}}function rp(e,n){aa(()=>{for(const[t,o]of Object.entries(n.value)){const l=a=>{e(t,a)};o.fns.add(l),bo(()=>{o.off(l)})}})}function Ds(){return{vueFlowRef:null,viewportRef:null,nodes:[],edges:[],connectionLookup:new Map,nodeTypes:{},edgeTypes:{},initialized:!1,dimensions:{width:0,height:0},viewport:{x:0,y:0,zoom:1},d3Zoom:null,d3Selection:null,d3ZoomHandler:null,minZoom:.5,maxZoom:2,translateExtent:[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],nodeExtent:[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],selectionMode:_l.Full,paneDragging:!1,preventScrolling:!0,zoomOnScroll:!0,zoomOnPinch:!0,zoomOnDoubleClick:!0,panOnScroll:!1,panOnScrollSpeed:.5,panOnScrollMode:Nn.Free,paneClickDistance:0,panOnDrag:!0,edgeUpdaterRadius:10,onlyRenderVisibleElements:!1,defaultViewport:{x:0,y:0,zoom:1},nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,defaultMarkerColor:"#b1b1b7",connectionLineStyle:{},connectionLineType:null,connectionLineOptions:{type:jt.Bezier,style:{}},connectionMode:Xt.Loose,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectionPosition:{x:Number.NaN,y:Number.NaN},connectionRadius:20,connectOnClick:!0,connectionStatus:null,isValidConnection:null,snapGrid:[15,15],snapToGrid:!1,edgesUpdatable:!1,edgesFocusable:!0,nodesFocusable:!0,nodesConnectable:!0,nodesDraggable:!0,nodeDragThreshold:1,elementsSelectable:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,selectionKeyCode:"Shift",multiSelectionKeyCode:xo()?"Meta":"Control",zoomActivationKeyCode:xo()?"Meta":"Control",deleteKeyCode:"Backspace",panActivationKeyCode:"Space",hooks:dp(),applyDefault:!0,autoConnect:!1,fitViewOnInit:!1,fitViewOnInitDone:!1,noDragClassName:"nodrag",noWheelClassName:"nowheel",noPanClassName:"nopan",defaultEdgeOptions:void 0,elevateEdgesOnSelect:!1,elevateNodesOnSelect:!0,autoPanOnNodeDrag:!0,autoPanOnConnect:!0,autoPanSpeed:15,disableKeyboardA11y:!1,ariaLiveMessage:""}}const up=["id","vueFlowRef","viewportRef","initialized","modelValue","nodes","edges","maxZoom","minZoom","translateExtent","hooks","defaultEdgeOptions"];function cp(e,n,t){const o=sp(e),l=V=>{const w=V??[];e.hooks.updateNodeInternals.trigger(w)},a=V=>Dc(V,e.nodes,e.edges),r=V=>Ic(V,e.nodes,e.edges),u=V=>xs(V,e.edges),f=({id:V,type:w,nodeId:p})=>{var $;return Array.from((($=e.connectionLookup.get(`${p}-${w}-${V??null}`))==null?void 0:$.values())??[])},v=V=>{if(V)return n.value.get(V)},g=V=>{if(V)return t.value.get(V)},_=(V,w,p)=>{var $,M;const fe=[];for(const _e of V){const Ne={id:_e.id,type:"position",dragging:p,from:_e.from};if(w&&(Ne.position=_e.position,_e.parentNode)){const De=v(_e.parentNode);Ne.position={x:Ne.position.x-((($=De==null?void 0:De.computedPosition)==null?void 0:$.x)??0),y:Ne.position.y-(((M=De==null?void 0:De.computedPosition)==null?void 0:M.y)??0)}}fe.push(Ne)}fe!=null&&fe.length&&e.hooks.nodesChange.trigger(fe)},x=V=>{if(!e.vueFlowRef)return;const w=e.vueFlowRef.querySelector(".vue-flow__transformationpane");if(!w)return;const p=window.getComputedStyle(w),{m22:$}=new window.DOMMatrixReadOnly(p.transform),M=[];for(let fe=0;fe<V.length;++fe){const _e=V[fe],Ne=v(_e.id);if(Ne){const De=So(_e.nodeElement);if(!!(De.width&&De.height&&(Ne.dimensions.width!==De.width||Ne.dimensions.height!==De.height||_e.forceUpdate))){const Re=_e.nodeElement.getBoundingClientRect();Ne.dimensions=De,Ne.handleBounds.source=gi(".source",_e.nodeElement,Re,$),Ne.handleBounds.target=gi(".target",_e.nodeElement,Re,$),M.push({id:Ne.id,type:"dimensions",dimensions:De})}}}!e.fitViewOnInitDone&&e.fitViewOnInit&&o.value.fitView().then(()=>{e.fitViewOnInitDone=!0}),M.length&&e.hooks.nodesChange.trigger(M)},C=(V,w)=>{const p=new Set,$=new Set;for(const _e of V)Qt(_e)?p.add(_e.id):Zt(_e)&&$.add(_e.id);const M=Gt(n.value,p,!0),fe=Gt(t.value,$);if(e.multiSelectionActive){for(const _e of p)M.push(Ft(_e,w));for(const _e of $)fe.push(Ft(_e,w))}M.length&&e.hooks.nodesChange.trigger(M),fe.length&&e.hooks.edgesChange.trigger(fe)},P=V=>{if(e.multiSelectionActive){const w=V.map(p=>Ft(p.id,!0));e.hooks.nodesChange.trigger(w);return}e.hooks.nodesChange.trigger(Gt(n.value,new Set(V.map(w=>w.id)),!0)),e.hooks.edgesChange.trigger(Gt(t.value))},T=V=>{if(e.multiSelectionActive){const w=V.map(p=>Ft(p.id,!0));e.hooks.edgesChange.trigger(w);return}e.hooks.edgesChange.trigger(Gt(t.value,new Set(V.map(w=>w.id)))),e.hooks.nodesChange.trigger(Gt(n.value,new Set,!0))},I=V=>{C(V,!0)},A=V=>{const p=(V||e.nodes).map($=>($.selected=!1,Ft($.id,!1)));e.hooks.nodesChange.trigger(p)},R=V=>{const p=(V||e.edges).map($=>($.selected=!1,Ft($.id,!1)));e.hooks.edgesChange.trigger(p)},k=V=>{if(!V||!V.length)return C([],!1);const w=V.reduce((p,$)=>{const M=Ft($.id,!1);return Qt($)?p.nodes.push(M):p.edges.push(M),p},{nodes:[],edges:[]});w.nodes.length&&e.hooks.nodesChange.trigger(w.nodes),w.edges.length&&e.hooks.edgesChange.trigger(w.edges)},D=V=>{var w;(w=e.d3Zoom)==null||w.scaleExtent([V,e.maxZoom]),e.minZoom=V},K=V=>{var w;(w=e.d3Zoom)==null||w.scaleExtent([e.minZoom,V]),e.maxZoom=V},ge=V=>{var w;(w=e.d3Zoom)==null||w.translateExtent(V),e.translateExtent=V},ae=V=>{e.nodeExtent=V,l()},de=V=>{var w;(w=e.d3Zoom)==null||w.clickDistance(V)},ve=V=>{e.nodesDraggable=V,e.nodesConnectable=V,e.elementsSelectable=V},Q=V=>{const w=V instanceof Function?V(e.nodes):V;!e.initialized&&!w.length||(e.nodes=mi(w,v,e.hooks.error.trigger))},le=V=>{const w=V instanceof Function?V(e.edges):V;if(!e.initialized&&!w.length)return;const p=yi(w,e.isValidConnection,v,g,e.hooks.error.trigger,e.defaultEdgeOptions,e.nodes,e.edges);hi(e.connectionLookup,p),e.edges=p},O=V=>{const w=V instanceof Function?V([...e.nodes,...e.edges]):V;!e.initialized&&!w.length||(Q(w.filter(Qt)),le(w.filter(Zt)))},Ee=V=>{let w=V instanceof Function?V(e.nodes):V;w=Array.isArray(w)?w:[w];const p=mi(w,v,e.hooks.error.trigger),$=[];for(const M of p)$.push(ai(M));$.length&&e.hooks.nodesChange.trigger($)},E=V=>{let w=V instanceof Function?V(e.edges):V;w=Array.isArray(w)?w:[w];const p=yi(w,e.isValidConnection,v,g,e.hooks.error.trigger,e.defaultEdgeOptions,e.nodes,e.edges),$=[];for(const M of p)$.push(ai(M));$.length&&e.hooks.edgesChange.trigger($)},F=(V,w=!0,p=!1)=>{const $=V instanceof Function?V(e.nodes):V,M=Array.isArray($)?$:[$],fe=[],_e=[];function Ne(Be){const Re=u(Be);for(const Je of Re)(!ut(Je.deletable)||Je.deletable)&&_e.push(ri(Je.id,Je.source,Je.target,Je.sourceHandle,Je.targetHandle))}function De(Be){const Re=[];for(const Je of e.nodes)Je.parentNode===Be&&Re.push(Je);if(Re.length){for(const Je of Re)fe.push(di(Je.id));w&&Ne(Re);for(const Je of Re)De(Je.id)}}for(const Be of M){const Re=typeof Be=="string"?v(Be):Be;Re&&(ut(Re.deletable)&&!Re.deletable||(fe.push(di(Re.id)),w&&Ne([Re]),p&&De(Re.id)))}_e.length&&e.hooks.edgesChange.trigger(_e),fe.length&&e.hooks.nodesChange.trigger(fe)},b=V=>{const w=V instanceof Function?V(e.edges):V,p=Array.isArray(w)?w:[w],$=[];for(const M of p){const fe=typeof M=="string"?g(M):M;fe&&(ut(fe.deletable)&&!fe.deletable||$.push(ri(typeof M=="string"?M:M.id,fe.source,fe.target,fe.sourceHandle,fe.targetHandle)))}e.hooks.edgesChange.trigger($)},U=(V,w,p=!0)=>Wc(V,w,e.edges,g,p,e.hooks.error.trigger),j=(V,w,p={replace:!1})=>{const $=g(V);if(!$)return;const M=typeof w=="function"?w($):w;$.data=p.replace?M:{...$.data,...M}},te=V=>si(V,e.nodes),ne=V=>{const w=si(V,e.edges);return hi(e.connectionLookup,w),w},pe=(V,w,p={replace:!1})=>{const $=v(V);if(!$)return;const M=typeof w=="function"?w($):w;p.replace?e.nodes.splice(e.nodes.indexOf($),1,M):Object.assign($,M)},Ve=(V,w,p={replace:!1})=>{const $=v(V);if(!$)return;const M=typeof w=="function"?w($):w;$.data=p.replace?M:{...$.data,...M}},re=(V,w,p=!1)=>{p?e.connectionClickStartHandle=V:e.connectionStartHandle=V,e.connectionEndHandle=null,e.connectionStatus=null,w&&(e.connectionPosition=w)},se=(V,w=null,p=null)=>{e.connectionStartHandle&&(e.connectionPosition=V,e.connectionEndHandle=w,e.connectionStatus=p)},ke=(V,w)=>{e.connectionPosition={x:Number.NaN,y:Number.NaN},e.connectionEndHandle=null,e.connectionStatus=null,w?e.connectionClickStartHandle=null:e.connectionStartHandle=null},Ue=V=>{const w=zc(V),p=w?null:Cn(V)?V:v(V.id);return!w&&!p?[null,null,w]:[w?V:sl(p),p,w]},Ae=(V,w=!0,p=e.nodes)=>{const[$,M,fe]=Ue(V);if(!$)return[];const _e=[];for(const Ne of p||e.nodes){if(!fe&&(Ne.id===M.id||!Ne.computedPosition))continue;const De=sl(Ne),Be=al(De,$);(w&&Be>0||Be>=Number($.width)*Number($.height))&&_e.push(Ne)}return _e},Le=(V,w,p=!0)=>{const[$]=Ue(V);if(!$)return!1;const M=al($,w);return p&&M>0||M>=Number($.width)*Number($.height)},Ie=V=>{const{viewport:w,dimensions:p,d3Zoom:$,d3Selection:M,translateExtent:fe}=e;if(!$||!M||!V.x&&!V.y)return!1;const _e=gn.translate(w.x+V.x,w.y+V.y).scale(w.zoom),Ne=[[0,0],[p.width,p.height]],De=$.constrain()(_e,Ne,fe),Be=e.viewport.x!==De.x||e.viewport.y!==De.y||e.viewport.zoom!==De.k;return $.transform(M,De),Be},Te=V=>{const w=V instanceof Function?V(e):V,p=["d3Zoom","d3Selection","d3ZoomHandler","viewportRef","vueFlowRef","dimensions","hooks"];ut(w.defaultEdgeOptions)&&(e.defaultEdgeOptions=w.defaultEdgeOptions);const $=w.modelValue||w.nodes||w.edges?[]:void 0;$&&(w.modelValue&&$.push(...w.modelValue),w.nodes&&$.push(...w.nodes),w.edges&&$.push(...w.edges),O($));const M=()=>{ut(w.maxZoom)&&K(w.maxZoom),ut(w.minZoom)&&D(w.minZoom),ut(w.translateExtent)&&ge(w.translateExtent)};for(const fe of Object.keys(w)){const _e=fe,Ne=w[_e];![...up,...p].includes(_e)&&ut(Ne)&&(e[_e]=Ne)}Wo(()=>e.d3Zoom).not.toBeNull().then(M),e.initialized||(e.initialized=!0)};return{updateNodePositions:_,updateNodeDimensions:x,setElements:O,setNodes:Q,setEdges:le,addNodes:Ee,addEdges:E,removeNodes:F,removeEdges:b,findNode:v,findEdge:g,updateEdge:U,updateEdgeData:j,updateNode:pe,updateNodeData:Ve,applyEdgeChanges:ne,applyNodeChanges:te,addSelectedElements:I,addSelectedNodes:P,addSelectedEdges:T,setMinZoom:D,setMaxZoom:K,setTranslateExtent:ge,setNodeExtent:ae,setPaneClickDistance:de,removeSelectedElements:k,removeSelectedNodes:A,removeSelectedEdges:R,startConnection:re,updateConnection:se,endConnection:ke,setInteractive:ve,setState:Te,getIntersectingNodes:Ae,getIncomers:a,getOutgoers:r,getConnectedEdges:u,getHandleConnections:f,isNodeIntersecting:Le,panBy:Ie,fitView:V=>o.value.fitView(V),zoomIn:V=>o.value.zoomIn(V),zoomOut:V=>o.value.zoomOut(V),zoomTo:(V,w)=>o.value.zoomTo(V,w),setViewport:(V,w)=>o.value.setViewport(V,w),setTransform:(V,w)=>o.value.setTransform(V,w),getViewport:()=>o.value.getViewport(),getTransform:()=>o.value.getTransform(),setCenter:(V,w,p)=>o.value.setCenter(V,w,p),fitBounds:(V,w)=>o.value.fitBounds(V,w),project:V=>o.value.project(V),screenToFlowCoordinate:V=>o.value.screenToFlowCoordinate(V),flowToScreenCoordinate:V=>o.value.flowToScreenCoordinate(V),toObject:()=>{const V=[],w=[];for(const p of e.nodes){const{computedPosition:$,handleBounds:M,selected:fe,dimensions:_e,isParent:Ne,resizing:De,dragging:Be,events:Re,...Je}=p;V.push(Je)}for(const p of e.edges){const{selected:$,sourceNode:M,targetNode:fe,events:_e,...Ne}=p;w.push(Ne)}return JSON.parse(JSON.stringify({nodes:V,edges:w,position:[e.viewport.x,e.viewport.y],zoom:e.viewport.zoom,viewport:e.viewport}))},fromObject:V=>new Promise(w=>{const{nodes:p,edges:$,position:M,zoom:fe,viewport:_e}=V;if(p&&Q(p),$&&le($),_e!=null&&_e.x&&(_e!=null&&_e.y)||M){const Ne=(_e==null?void 0:_e.x)||M[0],De=(_e==null?void 0:_e.y)||M[1],Be=(_e==null?void 0:_e.zoom)||fe||e.viewport.zoom;return Wo(()=>o.value.viewportInitialized).toBe(!0).then(()=>{o.value.setViewport({x:Ne,y:De,zoom:Be}).then(()=>{w(!0)})})}else w(!0)}),updateNodeInternals:l,viewportHelper:o,$reset:()=>{const V=Ds();if(e.edges=[],e.nodes=[],e.d3Zoom&&e.d3Selection){const w=gn.translate(V.defaultViewport.x??0,V.defaultViewport.y??0).scale(nn(V.defaultViewport.zoom??1,V.minZoom,V.maxZoom)),p=e.viewportRef.getBoundingClientRect(),$=[[0,0],[p.width,p.height]],M=e.d3Zoom.constrain()(w,$,V.translateExtent);e.d3Zoom.transform(e.d3Selection,M)}Te(V)},$destroy:()=>{}}}const pp=["data-id","data-handleid","data-nodeid","data-handlepos"],fp={name:"Handle",compatConfig:{MODE:3}},en=st({...fp,props:{id:{default:null},type:{},position:{default:()=>$e.Top},isValidConnection:{type:Function},connectable:{type:[Boolean,Number,String,Function],default:void 0},connectableStart:{type:Boolean,default:!0},connectableEnd:{type:Boolean,default:!0}},setup(e,{expose:n}){const t=Ni(e,["position","connectable","connectableStart","connectableEnd","id"]),o=ot(()=>t.type??"source"),l=ot(()=>t.isValidConnection??null),{connectionStartHandle:a,connectionClickStartHandle:r,connectionEndHandle:u,vueFlowRef:f,nodesConnectable:v,noDragClassName:g,noPanClassName:_}=tt(),{id:x,node:C,nodeEl:P,connectedEdges:T}=Ms(),I=q(),A=ot(()=>typeof e.connectableStart<"u"?e.connectableStart:!0),R=ot(()=>typeof e.connectableEnd<"u"?e.connectableEnd:!0),k=ot(()=>{var Q,le,O,Ee,E,F;return((Q=a.value)==null?void 0:Q.nodeId)===x&&((le=a.value)==null?void 0:le.handleId)===e.id&&((O=a.value)==null?void 0:O.type)===o.value||((Ee=u.value)==null?void 0:Ee.nodeId)===x&&((E=u.value)==null?void 0:E.handleId)===e.id&&((F=u.value)==null?void 0:F.type)===o.value}),D=ot(()=>{var Q,le,O;return((Q=r.value)==null?void 0:Q.nodeId)===x&&((le=r.value)==null?void 0:le.handleId)===e.id&&((O=r.value)==null?void 0:O.type)===o.value}),{handlePointerDown:K,handleClick:ge}=zs({nodeId:x,handleId:e.id,isValidConnection:l,type:o}),ae=Oe(()=>typeof e.connectable=="string"&&e.connectable==="single"?!T.value.some(Q=>{const le=Q[`${o.value}Handle`];return Q[o.value]!==x?!1:le?le===e.id:!0}):typeof e.connectable=="number"?T.value.filter(Q=>{const le=Q[`${o.value}Handle`];return Q[o.value]!==x?!1:le?le===e.id:!0}).length<e.connectable:typeof e.connectable=="function"?e.connectable(C,T.value):ut(e.connectable)?e.connectable:v.value);Et(()=>{var Q;if(!C.dimensions.width||!C.dimensions.height)return;const le=(Q=C.handleBounds[o.value])==null?void 0:Q.find(j=>j.id===e.id);if(!f.value||le)return;const O=f.value.querySelector(".vue-flow__transformationpane");if(!P.value||!I.value||!O||!e.id)return;const Ee=P.value.getBoundingClientRect(),E=I.value.getBoundingClientRect(),F=window.getComputedStyle(O),{m22:b}=new window.DOMMatrixReadOnly(F.transform),U={id:e.id,position:e.position,x:(E.left-Ee.left)/b,y:(E.top-Ee.top)/b,...So(I.value)};C.handleBounds[o.value]=[...C.handleBounds[o.value]??[],U]}),cl(()=>{const Q=C.handleBounds[o.value];Q&&(C.handleBounds[o.value]=Q.filter(le=>le.id!==e.id))});function de(Q){const le=xl(Q);ae.value&&A.value&&(le&&Q.button===0||!le)&&K(Q)}function ve(Q){!x||!r.value&&!A.value||ae.value&&ge(Q)}return n({handleClick:ge,handlePointerDown:K,onClick:ve,onPointerDown:de}),(Q,le)=>(y(),z("div",{ref_key:"handle",ref:I,"data-id":`${Y(x)}-${e.id}-${o.value}`,"data-handleid":e.id,"data-nodeid":Y(x),"data-handlepos":Q.position,class:Me(["vue-flow__handle",[`vue-flow__handle-${Q.position}`,`vue-flow__handle-${e.id}`,Y(g),Y(_),o.value,{connectable:ae.value,connecting:D.value,connectablestart:A.value,connectableend:R.value,connectionindicator:ae.value&&(A.value&&!k.value||R.value&&k.value)}]]),onMousedown:de,onTouchstartPassive:de,onClick:ve},[dt(Q.$slots,"default",{id:Q.id})],42,pp))}}),zo=function({sourcePosition:e=$e.Bottom,targetPosition:n=$e.Top,label:t,connectable:o=!0,isValidTargetPos:l,isValidSourcePos:a,data:r}){const u=r.label||t;return[et(en,{type:"target",position:n,connectable:o,isValidConnection:l}),typeof u!="string"&&u?et(u):et("div",{innerHTML:u}),et(en,{type:"source",position:e,connectable:o,isValidConnection:a})]};zo.props=["sourcePosition","targetPosition","label","isValidTargetPos","isValidSourcePos","connectable","data"];zo.inheritAttrs=!1;zo.compatConfig={MODE:3};const vp=zo,Mo=function({targetPosition:e=$e.Top,label:n,connectable:t=!0,isValidTargetPos:o,data:l}){const a=l.label||n;return[et(en,{type:"target",position:e,connectable:t,isValidConnection:o}),typeof a!="string"&&a?et(a):et("div",{innerHTML:a})]};Mo.props=["targetPosition","label","isValidTargetPos","connectable","data"];Mo.inheritAttrs=!1;Mo.compatConfig={MODE:3};const gp=Mo,Io=function({sourcePosition:e=$e.Bottom,label:n,connectable:t=!0,isValidSourcePos:o,data:l}){const a=l.label||n;return[typeof a!="string"&&a?et(a):et("div",{innerHTML:a}),et(en,{type:"source",position:e,connectable:t,isValidConnection:o})]};Io.props=["sourcePosition","label","isValidSourcePos","connectable","data"];Io.inheritAttrs=!1;Io.compatConfig={MODE:3};const mp=Io,hp=["transform"],yp=["width","height","x","y","rx","ry"],_p=["y"],wp={name:"EdgeText",compatConfig:{MODE:3}},xp=st({...wp,props:{x:{},y:{},label:{},labelStyle:{default:()=>({})},labelShowBg:{type:Boolean,default:!0},labelBgStyle:{default:()=>({})},labelBgPadding:{default:()=>[2,4]},labelBgBorderRadius:{default:2}},setup(e){const n=q({x:0,y:0,width:0,height:0}),t=q(null),o=Oe(()=>`translate(${e.x-n.value.width/2} ${e.y-n.value.height/2})`);Et(l),Ge([()=>e.x,()=>e.y,t,()=>e.label],l);function l(){if(!t.value)return;const a=t.value.getBBox();(a.width!==n.value.width||a.height!==n.value.height)&&(n.value=a)}return(a,r)=>(y(),z("g",{transform:o.value,class:"vue-flow__edge-textwrapper"},[a.labelShowBg?(y(),z("rect",{key:0,class:"vue-flow__edge-textbg",width:`${n.value.width+2*a.labelBgPadding[0]}px`,height:`${n.value.height+2*a.labelBgPadding[1]}px`,x:-a.labelBgPadding[0],y:-a.labelBgPadding[1],style:it(a.labelBgStyle),rx:a.labelBgBorderRadius,ry:a.labelBgBorderRadius},null,12,yp)):B("",!0),s("text",pa(a.$attrs,{ref_key:"el",ref:t,class:"vue-flow__edge-text",y:n.value.height/2,dy:"0.3em",style:a.labelStyle}),[dt(a.$slots,"default",{},()=>[typeof a.label!="string"?(y(),ie(an(a.label),{key:0})):(y(),z(be,{key:1},[G(oe(a.label),1)],64))])],16,_p)],8,hp))}}),bp=["id","d","marker-end","marker-start"],kp=["d","stroke-width"],Vp={name:"BaseEdge",inheritAttrs:!1,compatConfig:{MODE:3}},Hn=st({...Vp,props:{id:{},labelX:{},labelY:{},path:{},label:{},markerStart:{},markerEnd:{},interactionWidth:{default:20},style:{},labelStyle:{},labelShowBg:{type:Boolean,default:!0},labelBgStyle:{},labelBgPadding:{},labelBgBorderRadius:{}},setup(e,{expose:n}){const t=Ni(e,["interactionWidth","labelShowBg"]),o=q(null),l=q(null),a=q(null),r=ca();return n({pathEl:o,interactionEl:l,labelEl:a}),(u,f)=>(y(),z(be,null,[s("path",{id:u.id,ref_key:"pathEl",ref:o,d:u.path,style:it(t.style),class:Me(["vue-flow__edge-path",Y(r).class]),"marker-end":u.markerEnd,"marker-start":u.markerStart},null,14,bp),u.interactionWidth?(y(),z("path",{key:0,ref_key:"interactionEl",ref:l,fill:"none",d:u.path,"stroke-width":u.interactionWidth,"stroke-opacity":0,class:"vue-flow__edge-interaction"},null,8,kp)):B("",!0),u.label&&u.labelX&&u.labelY?(y(),ie(xp,{key:1,ref_key:"labelEl",ref:a,x:u.labelX,y:u.labelY,label:u.label,"label-show-bg":u.labelShowBg,"label-bg-style":u.labelBgStyle,"label-bg-padding":u.labelBgPadding,"label-bg-border-radius":u.labelBgBorderRadius,"label-style":u.labelStyle},null,8,["x","y","label","label-show-bg","label-bg-style","label-bg-padding","label-bg-border-radius","label-style"])):B("",!0)],64))}});function Ts({sourceX:e,sourceY:n,targetX:t,targetY:o}){const l=Math.abs(t-e)/2,a=t<e?t+l:t-l,r=Math.abs(o-n)/2,u=o<n?o+r:o-r;return[a,u,l,r]}function As({sourceX:e,sourceY:n,targetX:t,targetY:o,sourceControlX:l,sourceControlY:a,targetControlX:r,targetControlY:u}){const f=e*.125+l*.375+r*.375+t*.125,v=n*.125+a*.375+u*.375+o*.125,g=Math.abs(f-e),_=Math.abs(v-n);return[f,v,g,_]}function io(e,n){return e>=0?.5*e:n*25*Math.sqrt(-e)}function wi({pos:e,x1:n,y1:t,x2:o,y2:l,c:a}){let r,u;switch(e){case $e.Left:r=n-io(n-o,a),u=t;break;case $e.Right:r=n+io(o-n,a),u=t;break;case $e.Top:r=n,u=t-io(t-l,a);break;case $e.Bottom:r=n,u=t+io(l-t,a);break}return[r,u]}function kl(e){const{sourceX:n,sourceY:t,sourcePosition:o=$e.Bottom,targetX:l,targetY:a,targetPosition:r=$e.Top,curvature:u=.25}=e,[f,v]=wi({pos:o,x1:n,y1:t,x2:l,y2:a,c:u}),[g,_]=wi({pos:r,x1:l,y1:a,x2:n,y2:t,c:u}),[x,C,P,T]=As({sourceX:n,sourceY:t,targetX:l,targetY:a,sourceControlX:f,sourceControlY:v,targetControlX:g,targetControlY:_});return[`M${n},${t} C${f},${v} ${g},${_} ${l},${a}`,x,C,P,T]}function xi({pos:e,x1:n,y1:t,x2:o,y2:l}){let a,r;switch(e){case $e.Left:case $e.Right:a=.5*(n+o),r=t;break;case $e.Top:case $e.Bottom:a=n,r=.5*(t+l);break}return[a,r]}function Ps(e){const{sourceX:n,sourceY:t,sourcePosition:o=$e.Bottom,targetX:l,targetY:a,targetPosition:r=$e.Top}=e,[u,f]=xi({pos:o,x1:n,y1:t,x2:l,y2:a}),[v,g]=xi({pos:r,x1:l,y1:a,x2:n,y2:t}),[_,x,C,P]=As({sourceX:n,sourceY:t,targetX:l,targetY:a,sourceControlX:u,sourceControlY:f,targetControlX:v,targetControlY:g});return[`M${n},${t} C${u},${f} ${v},${g} ${l},${a}`,_,x,C,P]}const bi={[$e.Left]:{x:-1,y:0},[$e.Right]:{x:1,y:0},[$e.Top]:{x:0,y:-1},[$e.Bottom]:{x:0,y:1}};function $p({source:e,sourcePosition:n=$e.Bottom,target:t}){return n===$e.Left||n===$e.Right?e.x<t.x?{x:1,y:0}:{x:-1,y:0}:e.y<t.y?{x:0,y:1}:{x:0,y:-1}}function ki(e,n){return Math.sqrt((n.x-e.x)**2+(n.y-e.y)**2)}function Ep({source:e,sourcePosition:n=$e.Bottom,target:t,targetPosition:o=$e.Top,center:l,offset:a}){const r=bi[n],u=bi[o],f={x:e.x+r.x*a,y:e.y+r.y*a},v={x:t.x+u.x*a,y:t.y+u.y*a},g=$p({source:f,sourcePosition:n,target:v}),_=g.x!==0?"x":"y",x=g[_];let C,P,T;const I={x:0,y:0},A={x:0,y:0},[R,k,D,K]=Ts({sourceX:e.x,sourceY:e.y,targetX:t.x,targetY:t.y});if(r[_]*u[_]===-1){P=l.x??R,T=l.y??k;const ae=[{x:P,y:f.y},{x:P,y:v.y}],de=[{x:f.x,y:T},{x:v.x,y:T}];r[_]===x?C=_==="x"?ae:de:C=_==="x"?de:ae}else{const ae=[{x:f.x,y:v.y}],de=[{x:v.x,y:f.y}];if(_==="x"?C=r.x===x?de:ae:C=r.y===x?ae:de,n===o){const Ee=Math.abs(e[_]-t[_]);if(Ee<=a){const E=Math.min(a-1,a-Ee);r[_]===x?I[_]=(f[_]>e[_]?-1:1)*E:A[_]=(v[_]>t[_]?-1:1)*E}}if(n!==o){const Ee=_==="x"?"y":"x",E=r[_]===u[Ee],F=f[Ee]>v[Ee],b=f[Ee]<v[Ee];(r[_]===1&&(!E&&F||E&&b)||r[_]!==1&&(!E&&b||E&&F))&&(C=_==="x"?ae:de)}const ve={x:f.x+I.x,y:f.y+I.y},Q={x:v.x+A.x,y:v.y+A.y},le=Math.max(Math.abs(ve.x-C[0].x),Math.abs(Q.x-C[0].x)),O=Math.max(Math.abs(ve.y-C[0].y),Math.abs(Q.y-C[0].y));le>=O?(P=(ve.x+Q.x)/2,T=C[0].y):(P=C[0].x,T=(ve.y+Q.y)/2)}return[[e,{x:f.x+I.x,y:f.y+I.y},...C,{x:v.x+A.x,y:v.y+A.y},t],P,T,D,K]}function Sp(e,n,t,o){const l=Math.min(ki(e,n)/2,ki(n,t)/2,o),{x:a,y:r}=n;if(e.x===a&&a===t.x||e.y===r&&r===t.y)return`L${a} ${r}`;if(e.y===r){const v=e.x<t.x?-1:1,g=e.y<t.y?1:-1;return`L ${a+l*v},${r}Q ${a},${r} ${a},${r+l*g}`}const u=e.x<t.x?1:-1,f=e.y<t.y?-1:1;return`L ${a},${r+l*f}Q ${a},${r} ${a+l*u},${r}`}function rl(e){const{sourceX:n,sourceY:t,sourcePosition:o=$e.Bottom,targetX:l,targetY:a,targetPosition:r=$e.Top,borderRadius:u=5,centerX:f,centerY:v,offset:g=20}=e,[_,x,C,P,T]=Ep({source:{x:n,y:t},sourcePosition:o,target:{x:l,y:a},targetPosition:r,center:{x:f,y:v},offset:g});return[_.reduce((A,R,k)=>{let D;return k>0&&k<_.length-1?D=Sp(_[k-1],R,_[k+1],u):D=`${k===0?"M":"L"}${R.x} ${R.y}`,A+=D,A},""),x,C,P,T]}function Cp(e){const{sourceX:n,sourceY:t,targetX:o,targetY:l}=e,[a,r,u,f]=Ts({sourceX:n,sourceY:t,targetX:o,targetY:l});return[`M ${n},${t}L ${o},${l}`,a,r,u,f]}const Np=st({name:"StraightEdge",props:["label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"],compatConfig:{MODE:3},setup(e,{attrs:n}){return()=>{const[t,o,l]=Cp(e);return et(Hn,{path:t,labelX:o,labelY:l,...n,...e})}}}),zp=Np,Mp=st({name:"SmoothStepEdge",props:["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","borderRadius","markerEnd","markerStart","interactionWidth","offset"],compatConfig:{MODE:3},setup(e,{attrs:n}){return()=>{const[t,o,l]=rl({...e,sourcePosition:e.sourcePosition??$e.Bottom,targetPosition:e.targetPosition??$e.Top});return et(Hn,{path:t,labelX:o,labelY:l,...n,...e})}}}),Os=Mp,Ip=st({name:"StepEdge",props:["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"],setup(e,{attrs:n}){return()=>et(Os,{...e,...n,borderRadius:0})}}),Dp=Ip,Tp=st({name:"BezierEdge",props:["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","curvature","markerEnd","markerStart","interactionWidth"],compatConfig:{MODE:3},setup(e,{attrs:n}){return()=>{const[t,o,l]=kl({...e,sourcePosition:e.sourcePosition??$e.Bottom,targetPosition:e.targetPosition??$e.Top});return et(Hn,{path:t,labelX:o,labelY:l,...n,...e})}}}),Ap=Tp,Pp=st({name:"SimpleBezierEdge",props:["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"],compatConfig:{MODE:3},setup(e,{attrs:n}){return()=>{const[t,o,l]=Ps({...e,sourcePosition:e.sourcePosition??$e.Bottom,targetPosition:e.targetPosition??$e.Top});return et(Hn,{path:t,labelX:o,labelY:l,...n,...e})}}}),Op=Pp,Up={input:mp,default:vp,output:gp},Bp={default:Ap,straight:zp,step:Dp,smoothstep:Os,simplebezier:Op};function Rp(e,n,t){const o=Oe(()=>T=>n.value.get(T)),l=Oe(()=>T=>t.value.get(T)),a=Oe(()=>{const T={...Bp,...e.edgeTypes},I=Object.keys(T);for(const A of e.edges)A.type&&!I.includes(A.type)&&(T[A.type]=A.type);return T}),r=Oe(()=>{const T={...Up,...e.nodeTypes},I=Object.keys(T);for(const A of e.nodes)A.type&&!I.includes(A.type)&&(T[A.type]=A.type);return T}),u=Oe(()=>e.onlyRenderVisibleElements?ws(e.nodes,{x:0,y:0,width:e.dimensions.width,height:e.dimensions.height},e.viewport,!0):e.nodes),f=Oe(()=>{if(e.onlyRenderVisibleElements){const T=[];for(const I of e.edges){const A=n.value.get(I.source),R=n.value.get(I.target);Lc({sourcePos:A.computedPosition||{x:0,y:0},targetPos:R.computedPosition||{x:0,y:0},sourceWidth:A.dimensions.width,sourceHeight:A.dimensions.height,targetWidth:R.dimensions.width,targetHeight:R.dimensions.height,width:e.dimensions.width,height:e.dimensions.height,viewport:e.viewport})&&T.push(I)}return T}return e.edges}),v=Oe(()=>[...u.value,...f.value]),g=Oe(()=>{const T=[];for(const I of e.nodes)I.selected&&T.push(I);return T}),_=Oe(()=>{const T=[];for(const I of e.edges)I.selected&&T.push(I);return T}),x=Oe(()=>[...g.value,..._.value]),C=Oe(()=>{const T=[];for(const I of e.nodes)I.dimensions.width&&I.dimensions.height&&I.handleBounds!==void 0&&T.push(I);return T}),P=Oe(()=>u.value.length>0&&C.value.length===u.value.length);return{getNode:o,getEdge:l,getElements:v,getEdgeTypes:a,getNodeTypes:r,getEdges:f,getNodes:u,getSelectedElements:x,getSelectedNodes:g,getSelectedEdges:_,getNodesInitialized:C,areNodesInitialized:P}}class Wt{constructor(){this.currentId=0,this.flows=new Map}static getInstance(){var n;const t=(n=Un())==null?void 0:n.appContext.app,o=(t==null?void 0:t.config.globalProperties.$vueFlowStorage)??Wt.instance;return Wt.instance=o??new Wt,t&&(t.config.globalProperties.$vueFlowStorage=Wt.instance),Wt.instance}set(n,t){return this.flows.set(n,t)}get(n){return this.flows.get(n)}remove(n){return this.flows.delete(n)}create(n,t){const o=Ds(),l=sa(o),a={};for(const[x,C]of Object.entries(l.hooks)){const P=`on${x.charAt(0).toUpperCase()+x.slice(1)}`;a[P]=C.on}const r={};for(const[x,C]of Object.entries(l.hooks))r[x]=C.trigger;const u=Oe(()=>{const x=new Map;for(const C of l.nodes)x.set(C.id,C);return x}),f=Oe(()=>{const x=new Map;for(const C of l.edges)x.set(C.id,C);return x}),v=Rp(l,u,f),g=cp(l,u,f);g.setState({...l,...t});const _={...a,...v,...g,...qa(l),nodeLookup:u,edgeLookup:f,emits:r,id:n,vueFlowVersion:"1.41.2",$destroy:()=>{this.remove(n)}};return this.set(n,_),_}getId(){return`vue-flow-${this.currentId++}`}}function tt(e){const n=Wt.getInstance(),t=Ei(),o=typeof e=="object",l=o?e:{id:e},a=l.id,r=a??(t==null?void 0:t.vueFlowId);let u;if(t){const f=mn(_i,null);typeof f<"u"&&f!==null&&(!r||f.id===r)&&(u=f)}if(u||r&&(u=n.get(r)),!u||r&&u.id!==r){const f=a??n.getId(),v=n.create(f,l);u=v,(t??Si(!0)).run(()=>{Ge(v.applyDefault,(_,x,C)=>{const P=I=>{v.applyNodeChanges(I)},T=I=>{v.applyEdgeChanges(I)};_?(v.onNodesChange(P),v.onEdgesChange(T)):(v.hooks.value.nodesChange.off(P),v.hooks.value.edgesChange.off(T)),C(()=>{v.hooks.value.nodesChange.off(P),v.hooks.value.edgesChange.off(T)})},{immediate:!0}),bo(()=>{if(u){const _=n.get(u.id);_?_.$destroy():Co(`No store instance found for id ${u.id} in storage.`)}})})}else o&&u.setState(l);if(t&&(pn(_i,u),t.vueFlowId=u.id),o){const f=Un();(f==null?void 0:f.type.name)!=="VueFlow"&&u.emits.error(new pt(ct.USEVUEFLOW_OPTIONS))}return u}function Hp(e){const{emits:n,dimensions:t}=tt();let o;Et(()=>{const l=e.value,a=()=>{if(!l)return;const r=So(l);(r.width===0||r.height===0)&&n.error(new pt(ct.MISSING_VIEWPORT_DIMENSIONS)),t.value={width:r.width||500,height:r.height||500}};a(),window.addEventListener("resize",a),l&&(o=new ResizeObserver(()=>a()),o.observe(l)),Ci(()=>{window.removeEventListener("resize",a),o&&l&&o.unobserve(l)})})}const Lp={name:"UserSelection",compatConfig:{MODE:3}},Fp=st({...Lp,props:{userSelectionRect:{}},setup(e){return(n,t)=>(y(),z("div",{class:"vue-flow__selection vue-flow__container",style:it({width:`${n.userSelectionRect.width}px`,height:`${n.userSelectionRect.height}px`,transform:`translate(${n.userSelectionRect.x}px, ${n.userSelectionRect.y}px)`})},null,4))}}),qp=["tabIndex"],Gp={name:"NodesSelection",compatConfig:{MODE:3}},Yp=st({...Gp,setup(e){const{emits:n,viewport:t,getSelectedNodes:o,noPanClassName:l,disableKeyboardA11y:a,userSelectionActive:r}=tt(),u=Is(),f=q(null),v=Ns({el:f,onStart(P){n.selectionDragStart(P)},onDrag(P){n.selectionDrag(P)},onStop(P){n.selectionDragStop(P)}});Et(()=>{var P;a.value||(P=f.value)==null||P.focus({preventScroll:!0})});const g=Oe(()=>_s(o.value)),_=Oe(()=>({width:`${g.value.width}px`,height:`${g.value.height}px`,top:`${g.value.y}px`,left:`${g.value.x}px`}));function x(P){n.selectionContextMenu({event:P,nodes:o.value})}function C(P){a||cn[P.key]&&u({x:cn[P.key].x,y:cn[P.key].y},P.shiftKey)}return(P,T)=>!Y(r)&&g.value.width&&g.value.height?(y(),z("div",{key:0,class:Me(["vue-flow__nodesselection vue-flow__container",Y(l)]),style:it({transform:`translate(${Y(t).x}px,${Y(t).y}px) scale(${Y(t).zoom})`})},[s("div",{ref_key:"el",ref:f,class:Me([{dragging:Y(v)},"vue-flow__nodesselection-rect"]),style:it(_.value),tabIndex:Y(a)?void 0:-1,onContextmenu:x,onKeydown:C},null,46,qp)],6)):B("",!0)}});function Xp(e,n){return{x:e.clientX-n.left,y:e.clientY-n.top}}const Zp={name:"Pane",compatConfig:{MODE:3}},jp=st({...Zp,props:{isSelecting:{type:Boolean},selectionKeyPressed:{type:Boolean}},setup(e){const{vueFlowRef:n,nodes:t,viewport:o,emits:l,userSelectionActive:a,removeSelectedElements:r,panOnDrag:u,userSelectionRect:f,elementsSelectable:v,nodesSelectionActive:g,getSelectedEdges:_,getSelectedNodes:x,removeNodes:C,removeEdges:P,selectionMode:T,deleteKeyCode:I,multiSelectionKeyCode:A,multiSelectionActive:R,edgeLookup:k,nodeLookup:D}=tt(),K=q(null),ge=q(0),ae=q(0),de=q(),ve=q(new Map),Q=ot(()=>v.value&&(e.isSelecting||a.value));let le=!1,O=!1;const Ee=zn(I,{actInsideInputWithModifier:!1}),E=zn(A);Ge(Ee,re=>{re&&(C(x.value),P(_.value),g.value=!1)}),Ge(E,re=>{R.value=re});function F(re,se){return ke=>{ke.target===se&&(re==null||re(ke))}}function b(){a.value=!1,f.value=null,ge.value=0,ae.value=0}function U(re){if(le){le=!1;return}l.paneClick(re),r(),g.value=!1}function j(re){var se;if(Array.isArray(u.value)&&((se=u.value)!=null&&se.includes(2))){re.preventDefault();return}l.paneContextMenu(re)}function te(re){l.paneScroll(re)}function ne(re){var se,ke,Ue,Ae,Le;if(de.value=(se=n.value)==null?void 0:se.getBoundingClientRect(),!v.value||!e.isSelecting||re.button!==0||re.target!==K.value||!de.value)return;(Ue=(ke=re.target)==null?void 0:ke.setPointerCapture)==null||Ue.call(ke,re.pointerId);const{x:Ie,y:Te}=Xp(re,de.value);O=!0,le=!1,ve.value=new Map;for(const[ue,we]of k.value)ve.value.set(we.source,((Ae=ve.value.get(we.source))==null?void 0:Ae.add(ue))||new Set([ue])),ve.value.set(we.target,((Le=ve.value.get(we.target))==null?void 0:Le.add(ue))||new Set([ue]));r(),f.value={width:0,height:0,startX:Ie,startY:Te,x:Ie,y:Te},l.selectionStart(re)}function pe(re){if(!de.value||!f.value)return;le=!0;const{x:se,y:ke}=Yt(re,de.value),{startX:Ue=0,startY:Ae=0}=f.value,Le={startX:Ue,startY:Ae,x:se<Ue?se:Ue,y:ke<Ae?ke:Ae,width:Math.abs(se-Ue),height:Math.abs(ke-Ae)},Ie=ws(t.value,Le,o.value,T.value===_l.Partial,!0),Te=new Set,ue=new Set;for(const we of Ie){ue.add(we.id);const Ce=ve.value.get(we.id);if(Ce)for(const V of Ce)Te.add(V)}if(ge.value!==ue.size){ge.value=ue.size;const we=Gt(D.value,ue,!0);l.nodesChange(we)}if(ae.value!==Te.size){ae.value=Te.size;const we=Gt(k.value,Te);l.edgesChange(we)}f.value=Le,a.value=!0,g.value=!1}function Ve(re){var se;re.button!==0||!O||((se=re.target)==null||se.releasePointerCapture(re.pointerId),!a.value&&f.value&&re.target===K.value&&U(re),ge.value>0&&(g.value=!0),b(),l.selectionEnd(re),e.selectionKeyPressed&&(le=!1),O=!1)}return(re,se)=>(y(),z("div",{ref_key:"container",ref:K,class:Me(["vue-flow__pane vue-flow__container",{selection:re.isSelecting}]),onClick:se[0]||(se[0]=ke=>Q.value?void 0:F(U,K.value)(ke)),onContextmenu:se[1]||(se[1]=ke=>F(j,K.value)(ke)),onWheelPassive:se[2]||(se[2]=ke=>F(te,K.value)(ke)),onPointerenter:se[3]||(se[3]=ke=>Q.value?void 0:Y(l).paneMouseEnter(ke)),onPointerdown:se[4]||(se[4]=ke=>Q.value?ne(ke):Y(l).paneMouseMove(ke)),onPointermove:se[5]||(se[5]=ke=>Q.value?pe(ke):Y(l).paneMouseMove(ke)),onPointerup:se[6]||(se[6]=ke=>Q.value?Ve(ke):void 0),onPointerleave:se[7]||(se[7]=ke=>Y(l).paneMouseLeave(ke))},[dt(re.$slots,"default"),Y(a)&&Y(f)?(y(),ie(Fp,{key:0,"user-selection-rect":Y(f)},null,8,["user-selection-rect"])):B("",!0),Y(g)&&Y(x).length?(y(),ie(Yp,{key:1})):B("",!0)],34))}}),Wp={name:"Transform",compatConfig:{MODE:3}},Kp=st({...Wp,setup(e){const{viewport:n,fitViewOnInit:t,fitViewOnInitDone:o}=tt(),l=Oe(()=>t.value?!o.value:!1),a=Oe(()=>`translate(${n.value.x}px,${n.value.y}px) scale(${n.value.zoom})`);return(r,u)=>(y(),z("div",{class:"vue-flow__transformationpane vue-flow__container",style:it({transform:a.value,opacity:l.value?0:void 0})},[dt(r.$slots,"default")],4))}}),Jp={name:"Viewport",compatConfig:{MODE:3}},Qp=st({...Jp,setup(e){const{minZoom:n,maxZoom:t,defaultViewport:o,translateExtent:l,zoomActivationKeyCode:a,selectionKeyCode:r,panActivationKeyCode:u,panOnScroll:f,panOnScrollMode:v,panOnScrollSpeed:g,panOnDrag:_,zoomOnDoubleClick:x,zoomOnPinch:C,zoomOnScroll:P,preventScrolling:T,noWheelClassName:I,noPanClassName:A,emits:R,connectionStartHandle:k,userSelectionActive:D,paneDragging:K,d3Zoom:ge,d3Selection:ae,d3ZoomHandler:de,viewport:ve,viewportRef:Q,paneClickDistance:le}=tt();Hp(Q);const O=q(!1),Ee=q(!1);let E=null,F=!1,b=0,U={x:0,y:0,zoom:0};const j=zn(u),te=zn(r),ne=zn(a),pe=ot(()=>!te.value&&(j.value||_.value)),Ve=ot(()=>j.value||f.value),re=ot(()=>te.value||r.value===!0&&pe.value!==!0);Et(()=>{if(!Q.value){Co("Viewport element is missing");return}const Ie=Q.value,Te=Ie.getBoundingClientRect(),ue=$c().clickDistance(le.value).scaleExtent([n.value,t.value]).translateExtent(l.value),we=Vt(Ie).call(ue),Ce=we.on("wheel.zoom"),V=gn.translate(o.value.x??0,o.value.y??0).scale(nn(o.value.zoom??1,n.value,t.value)),w=[[0,0],[Te.width,Te.height]],p=ue.constrain()(V,w,l.value);ue.transform(we,p),ue.wheelDelta(ke),ge.value=ue,ae.value=we,de.value=Ce,ve.value={x:p.x,y:p.y,zoom:p.k},ue.on("start",$=>{var M;if(!$.sourceEvent)return null;b=$.sourceEvent.button,O.value=!0;const fe=Ae($.transform);((M=$.sourceEvent)==null?void 0:M.type)==="mousedown"&&(K.value=!0),U=fe,R.viewportChangeStart(fe),R.moveStart({event:$,flowTransform:fe})}),ue.on("end",$=>{if(!$.sourceEvent)return null;if(O.value=!1,K.value=!1,se(pe.value,b??0)&&!F&&R.paneContextMenu($.sourceEvent),F=!1,Ue(U,$.transform)){const M=Ae($.transform);U=M,R.viewportChangeEnd(M),R.moveEnd({event:$,flowTransform:M})}}),ue.filter($=>{var M,fe,_e;const Ne=ne.value||P.value,De=C.value&&$.ctrlKey,Be=$.button;if((pe.value===!0||Array.isArray(pe.value)&&pe.value.includes(1))&&Be===1&&$.type==="mousedown"&&((M=$.target)!=null&&M.closest(".vue-flow__node")||(fe=$.target)!=null&&fe.closest(".vue-flow__edge")))return!0;if(!pe.value&&!Ne&&!Ve.value&&!x.value&&!C.value||D.value||!x.value&&$.type==="dblclick"||Le($,I.value)&&$.type==="wheel"||Le($,A.value)&&($.type!=="wheel"||Ve.value&&$.type==="wheel"&&!ne.value)||!C.value&&$.ctrlKey&&$.type==="wheel"||!Ne&&!Ve.value&&!De&&$.type==="wheel")return!1;if(!C&&$.type==="touchstart"&&((_e=$.touches)==null?void 0:_e.length)>1)return $.preventDefault(),!1;if(!pe.value&&($.type==="mousedown"||$.type==="touchstart")||Array.isArray(pe.value)&&!pe.value.includes(Be)&&($.type==="mousedown"||$.type==="touchstart"))return!1;const Re=Array.isArray(pe.value)&&pe.value.includes(Be)||!Be||Be<=1;return(!$.ctrlKey||$.type==="wheel")&&Re}),Ge([D,pe],()=>{D.value&&!O.value?ue.on("zoom",null):D.value||ue.on("zoom",$=>{ve.value={x:$.transform.x,y:$.transform.y,zoom:$.transform.k};const M=Ae($.transform);F=se(pe.value,b??0),R.viewportChange(M),R.move({event:$,flowTransform:M})})},{immediate:!0}),Ge([D,Ve,v,ne,C,T,I],()=>{Ve.value&&!ne.value&&!D.value?we.on("wheel.zoom",$=>{if(Le($,I.value))return!1;const M=ne.value||P.value,fe=C.value&&$.ctrlKey;if(!(!T.value||Ve.value||M||fe))return!1;$.preventDefault(),$.stopImmediatePropagation();const Ne=we.property("__zoom").k||1,De=xo();if($.ctrlKey&&C.value&&De){const It=Ct($),ht=ke($),ft=Ne*2**ht;ue.scaleTo(we,ft,It,$);return}const Be=$.deltaMode===1?20:1;let Re=v.value===Nn.Vertical?0:$.deltaX*Be,Je=v.value===Nn.Horizontal?0:$.deltaY*Be;!De&&$.shiftKey&&v.value!==Nn.Vertical&&!Re&&Je&&(Re=Je,Je=0),ue.translateBy(we,-(Re/Ne)*g.value,-(Je/Ne)*g.value);const gt=Ae(we.property("__zoom"));E&&clearTimeout(E),Ee.value?(R.move({event:$,flowTransform:gt}),R.viewportChange(gt),E=setTimeout(()=>{R.moveEnd({event:$,flowTransform:gt}),R.viewportChangeEnd(gt),Ee.value=!1},150)):(Ee.value=!0,R.moveStart({event:$,flowTransform:gt}),R.viewportChangeStart(gt))},{passive:!1}):typeof Ce<"u"&&we.on("wheel.zoom",function($,M){const fe=!T.value&&$.type==="wheel"&&!$.ctrlKey,_e=ne.value||P.value,Ne=C.value&&$.ctrlKey;if(!_e&&!f.value&&!Ne&&$.type==="wheel"||fe||Le($,I.value))return null;$.preventDefault(),Ce.call(this,$,M)},{passive:!1})},{immediate:!0})});function se(Ie,Te){return Te===2&&Array.isArray(Ie)&&Ie.includes(2)}function ke(Ie){const Te=Ie.ctrlKey&&xo()?10:1;return-Ie.deltaY*(Ie.deltaMode===1?.05:Ie.deltaMode?1:.002)*Te}function Ue(Ie,Te){return Ie.x!==Te.x&&!Number.isNaN(Te.x)||Ie.y!==Te.y&&!Number.isNaN(Te.y)||Ie.zoom!==Te.k&&!Number.isNaN(Te.k)}function Ae(Ie){return{x:Ie.x,y:Ie.y,zoom:Ie.k}}function Le(Ie,Te){return Ie.target.closest(`.${Te}`)}return(Ie,Te)=>(y(),z("div",{ref_key:"viewportRef",ref:Q,class:"vue-flow__viewport vue-flow__container"},[h(jp,{"is-selecting":re.value,"selection-key-pressed":Y(te),class:Me({connecting:!!Y(k),dragging:Y(K),draggable:Y(_)===!0||Array.isArray(Y(_))&&Y(_).includes(0)})},{default:N(()=>[h(Kp,null,{default:N(()=>[dt(Ie.$slots,"default")]),_:3})]),_:3},8,["is-selecting","selection-key-pressed","class"])],512))}}),ef=["id"],tf=["id"],nf=["id"],of={name:"A11yDescriptions",compatConfig:{MODE:3}},lf=st({...of,setup(e){const{id:n,disableKeyboardA11y:t,ariaLiveMessage:o}=tt();return(l,a)=>(y(),z(be,null,[s("div",{id:`${Y(us)}-${Y(n)}`,style:{display:"none"}}," Press enter or space to select a node. "+oe(Y(t)?"":"You can then use the arrow keys to move the node around.")+" You can then use the arrow keys to move the node around, press delete to remove it and press escape to cancel. ",9,ef),s("div",{id:`${Y(cs)}-${Y(n)}`,style:{display:"none"}}," Press enter or space to select an edge. You can then press delete to remove it or press escape to cancel. ",8,tf),Y(t)?B("",!0):(y(),z("div",{key:0,id:`${Y(Nc)}-${Y(n)}`,"aria-live":"assertive","aria-atomic":"true",style:{position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)","clip-path":"inset(100%)"}},oe(Y(o)),9,nf))],64))}});function sf(){const e=tt();Ge(()=>e.viewportHelper.value.viewportInitialized,n=>{n&&setTimeout(()=>{e.emits.init(e),e.emits.paneReady(e)},1)})}function af(e,n,t){return t===$e.Left?e-n:t===$e.Right?e+n:e}function df(e,n,t){return t===$e.Top?e-n:t===$e.Bottom?e+n:e}const Vl=function({radius:e=10,centerX:n=0,centerY:t=0,position:o=$e.Top,type:l}){return et("circle",{class:`vue-flow__edgeupdater vue-flow__edgeupdater-${l}`,cx:af(n,e,o),cy:df(t,e,o),r:e,stroke:"transparent",fill:"transparent"})};Vl.props=["radius","centerX","centerY","position","type"];Vl.compatConfig={MODE:3};const Vi=Vl,rf=st({name:"Edge",compatConfig:{MODE:3},props:["id"],setup(e){const{id:n,addSelectedEdges:t,connectionMode:o,edgeUpdaterRadius:l,emits:a,nodesSelectionActive:r,noPanClassName:u,getEdgeTypes:f,removeSelectedEdges:v,findEdge:g,findNode:_,isValidConnection:x,multiSelectionActive:C,disableKeyboardA11y:P,elementsSelectable:T,edgesUpdatable:I,edgesFocusable:A,hooks:R}=tt(),k=Oe(()=>g(e.id)),{emit:D,on:K}=ep(k.value,a),ge=mn(No),ae=Un(),de=q(!1),ve=q(!1),Q=q(""),le=q(null),O=q("source"),Ee=q(null),E=ot(()=>typeof k.value.selectable>"u"?T.value:k.value.selectable),F=ot(()=>typeof k.value.updatable>"u"?I.value:k.value.updatable),b=ot(()=>typeof k.value.focusable>"u"?A.value:k.value.focusable);pn(Kc,e.id),pn(Jc,Ee);const U=Oe(()=>k.value.class instanceof Function?k.value.class(k.value):k.value.class),j=Oe(()=>k.value.style instanceof Function?k.value.style(k.value):k.value.style),te=Oe(()=>{const w=k.value.type||"default",p=ge==null?void 0:ge[`edge-${w}`];if(p)return p;let $=k.value.template??f.value[w];if(typeof $=="string"&&ae){const M=Object.keys(ae.appContext.components);M&&M.includes(w)&&($=We(w,!1))}return $&&typeof $!="string"?$:(a.error(new pt(ct.EDGE_TYPE_MISSING,$)),!1)}),{handlePointerDown:ne}=zs({nodeId:Q,handleId:le,type:O,isValidConnection:x,edgeUpdaterType:O,onEdgeUpdate:re,onEdgeUpdateEnd:se});return()=>{const w=_(k.value.source),p=_(k.value.target),$="pathOptions"in k.value?k.value.pathOptions:{};if(!w&&!p)return a.error(new pt(ct.EDGE_SOURCE_TARGET_MISSING,k.value.id,k.value.source,k.value.target)),null;if(!w)return a.error(new pt(ct.EDGE_SOURCE_MISSING,k.value.id,k.value.source)),null;if(!p)return a.error(new pt(ct.EDGE_TARGET_MISSING,k.value.id,k.value.target)),null;if(!k.value||k.value.hidden||w.hidden||p.hidden)return null;let M;o.value===Xt.Strict?M=w.handleBounds.source:M=[...w.handleBounds.source||[],...w.handleBounds.target||[]];const fe=ci(M,k.value.sourceHandle);let _e;o.value===Xt.Strict?_e=p.handleBounds.target:_e=[...p.handleBounds.target||[],...p.handleBounds.source||[]];const Ne=ci(_e,k.value.targetHandle),De=(fe==null?void 0:fe.position)||$e.Bottom,Be=(Ne==null?void 0:Ne.position)||$e.Top,{x:Re,y:Je}=wo(w,fe,De),{x:gt,y:It}=wo(p,Ne,Be);return k.value.sourceX=Re,k.value.sourceY=Je,k.value.targetX=gt,k.value.targetY=It,et("g",{ref:Ee,key:e.id,"data-id":e.id,class:["vue-flow__edge",`vue-flow__edge-${te.value===!1?"default":k.value.type||"default"}`,u.value,U.value,{updating:de.value,selected:k.value.selected,animated:k.value.animated,inactive:!E.value&&!R.value.edgeClick.hasListeners()}],onClick:Ue,onContextmenu:Ae,onDblclick:Le,onMouseenter:Ie,onMousemove:Te,onMouseleave:ue,onKeyDown:b.value?V:void 0,tabIndex:b.value?0:void 0,"aria-label":k.value.ariaLabel===null?void 0:k.value.ariaLabel||`Edge from ${k.value.source} to ${k.value.target}`,"aria-describedby":b.value?`${cs}-${n}`:void 0,role:b.value?"button":"img"},[ve.value?null:et(te.value===!1?f.value.default:te.value,{id:e.id,sourceNode:w,targetNode:p,source:k.value.source,target:k.value.target,type:k.value.type,updatable:F.value,selected:k.value.selected,animated:k.value.animated,label:k.value.label,labelStyle:k.value.labelStyle,labelShowBg:k.value.labelShowBg,labelBgStyle:k.value.labelBgStyle,labelBgPadding:k.value.labelBgPadding,labelBgBorderRadius:k.value.labelBgBorderRadius,data:k.value.data,events:{...k.value.events,...K},style:j.value,markerStart:`url('#${On(k.value.markerStart,n)}')`,markerEnd:`url('#${On(k.value.markerEnd,n)}')`,sourcePosition:De,targetPosition:Be,sourceX:Re,sourceY:Je,targetX:gt,targetY:It,sourceHandleId:k.value.sourceHandle,targetHandleId:k.value.targetHandle,interactionWidth:k.value.interactionWidth,...$}),[F.value==="source"||F.value===!0?[et("g",{onMousedown:we,onMouseenter:pe,onMouseout:Ve},et(Vi,{position:De,centerX:Re,centerY:Je,radius:l.value,type:"source","data-type":"source"}))]:null,F.value==="target"||F.value===!0?[et("g",{onMousedown:Ce,onMouseenter:pe,onMouseout:Ve},et(Vi,{position:Be,centerX:gt,centerY:It,radius:l.value,type:"target","data-type":"target"}))]:null]])};function pe(){de.value=!0}function Ve(){de.value=!1}function re(w,p){D.update({event:w,edge:k.value,connection:p})}function se(w){D.updateEnd({event:w,edge:k.value}),ve.value=!1}function ke(w,p){w.button===0&&(ve.value=!0,Q.value=p?k.value.target:k.value.source,le.value=(p?k.value.targetHandle:k.value.sourceHandle)??"",O.value=p?"target":"source",D.updateStart({event:w,edge:k.value}),ne(w))}function Ue(w){var p;const $={event:w,edge:k.value};E.value&&(r.value=!1,k.value.selected&&C.value?(v([k.value]),(p=Ee.value)==null||p.blur()):t([k.value])),D.click($)}function Ae(w){D.contextMenu({event:w,edge:k.value})}function Le(w){D.doubleClick({event:w,edge:k.value})}function Ie(w){D.mouseEnter({event:w,edge:k.value})}function Te(w){D.mouseMove({event:w,edge:k.value})}function ue(w){D.mouseLeave({event:w,edge:k.value})}function we(w){ke(w,!0)}function Ce(w){ke(w,!1)}function V(w){var p;!P.value&&ps.includes(w.key)&&E.value&&(w.key==="Escape"?((p=Ee.value)==null||p.blur(),v([g(e.id)])):t([g(e.id)]))}}}),uf=rf,cf={[$e.Left]:$e.Right,[$e.Right]:$e.Left,[$e.Top]:$e.Bottom,[$e.Bottom]:$e.Top},pf=st({name:"ConnectionLine",compatConfig:{MODE:3},setup(){var e;const{id:n,connectionMode:t,connectionStartHandle:o,connectionEndHandle:l,connectionPosition:a,connectionLineType:r,connectionLineStyle:u,connectionLineOptions:f,connectionStatus:v,viewport:g,findNode:_}=tt(),x=(e=mn(No))==null?void 0:e["connection-line"],C=Oe(()=>{var R;return _((R=o.value)==null?void 0:R.nodeId)}),P=Oe(()=>{var R;return _((R=l.value)==null?void 0:R.nodeId)??null}),T=Oe(()=>({x:(a.value.x-g.value.x)/g.value.zoom,y:(a.value.y-g.value.y)/g.value.zoom})),I=Oe(()=>f.value.markerStart?`url(#${On(f.value.markerStart,n)})`:""),A=Oe(()=>f.value.markerEnd?`url(#${On(f.value.markerEnd,n)})`:"");return()=>{var R,k,D,K;if(!C.value||!o.value)return null;const ge=o.value.handleId,ae=o.value.type,de=C.value.handleBounds;let ve=de==null?void 0:de[ae];if(t.value===Xt.Loose&&(ve=ve||(de==null?void 0:de[ae==="source"?"target":"source"])),!ve)return null;const Q=(ge?ve.find(te=>te.id===ge):ve[0])??null,le=(Q==null?void 0:Q.position)||$e.Top,{x:O,y:Ee}=wo(C.value,Q,le);let E=null;P.value&&((R=l.value)!=null&&R.handleId)&&(t.value===Xt.Strict?E=((k=P.value.handleBounds[ae==="source"?"target":"source"])==null?void 0:k.find(te=>{var ne;return te.id===((ne=l.value)==null?void 0:ne.handleId)}))||null:E=((D=[...P.value.handleBounds.source||[],...P.value.handleBounds.target||[]])==null?void 0:D.find(te=>{var ne;return te.id===((ne=l.value)==null?void 0:ne.handleId)}))||null);const F=((K=l.value)==null?void 0:K.position)??(le?cf[le]:null);if(!le||!F)return null;const b=r.value??f.value.type??jt.Bezier;let U="";const j={sourceX:O,sourceY:Ee,sourcePosition:le,targetX:T.value.x,targetY:T.value.y,targetPosition:F};return b===jt.Bezier?[U]=kl(j):b===jt.Step?[U]=rl({...j,borderRadius:0}):b===jt.SmoothStep?[U]=rl(j):b===jt.SimpleBezier?[U]=Ps(j):U=`M${O},${Ee} ${T.value.x},${T.value.y}`,et("svg",{class:"vue-flow__edges vue-flow__connectionline vue-flow__container"},et("g",{class:"vue-flow__connection"},x?et(x,{sourceX:O,sourceY:Ee,sourcePosition:le,targetX:T.value.x,targetY:T.value.y,targetPosition:F,sourceNode:C.value,sourceHandle:Q,targetNode:P.value,targetHandle:E,markerEnd:A.value,markerStart:I.value,connectionStatus:v.value}):et("path",{d:U,class:[f.value.class,v,"vue-flow__connection-path"],style:{...u.value,...f.value.style},"marker-end":A.value,"marker-start":I.value})))}}}),ff=pf,vf=["id","markerWidth","markerHeight","markerUnits","orient"],gf={name:"MarkerType",compatConfig:{MODE:3}},mf=st({...gf,props:{id:{},type:{},color:{default:"none"},width:{default:12.5},height:{default:12.5},markerUnits:{default:"strokeWidth"},orient:{default:"auto-start-reverse"},strokeWidth:{default:1}},setup(e){return(n,t)=>(y(),z("marker",{id:n.id,class:"vue-flow__arrowhead",viewBox:"-10 -10 20 20",refX:"0",refY:"0",markerWidth:`${n.width}`,markerHeight:`${n.height}`,markerUnits:n.markerUnits,orient:n.orient},[n.type===Y(Pn).ArrowClosed?(y(),z("polyline",{key:0,style:it({stroke:n.color,fill:n.color,strokeWidth:n.strokeWidth}),"stroke-linecap":"round","stroke-linejoin":"round",points:"-5,-4 0,0 -5,4 -5,-4"},null,4)):B("",!0),n.type===Y(Pn).Arrow?(y(),z("polyline",{key:1,style:it({stroke:n.color,strokeWidth:n.strokeWidth}),"stroke-linecap":"round","stroke-linejoin":"round",fill:"none",points:"-5,-4 0,0 -5,4"},null,4)):B("",!0)],8,vf))}}),hf={class:"vue-flow__marker vue-flow__container"},yf={name:"MarkerDefinitions",compatConfig:{MODE:3}},_f=st({...yf,setup(e){const{id:n,edges:t,connectionLineOptions:o,defaultMarkerColor:l}=tt(),a=Oe(()=>{const r=new Set,u=[],f=v=>{if(v){const g=On(v,n);r.has(g)||(typeof v=="object"?u.push({...v,id:g,color:v.color||l.value}):u.push({id:g,color:l.value,type:v}),r.add(g))}};for(const v of[o.value.markerEnd,o.value.markerStart])f(v);for(const v of t.value)for(const g of[v.markerStart,v.markerEnd])f(g);return u.sort((v,g)=>v.id.localeCompare(g.id))});return(r,u)=>(y(),z("svg",hf,[s("defs",null,[(y(!0),z(be,null,Fe(a.value,f=>(y(),ie(mf,{id:f.id,key:f.id,type:f.type,color:f.color,width:f.width,height:f.height,markerUnits:f.markerUnits,"stroke-width":f.strokeWidth,orient:f.orient},null,8,["id","type","color","width","height","markerUnits","stroke-width","orient"]))),128))])]))}}),wf={name:"Edges",compatConfig:{MODE:3}},xf=st({...wf,setup(e){const{findNode:n,getEdges:t,elevateEdgesOnSelect:o}=tt();return(l,a)=>(y(),z(be,null,[h(_f),(y(!0),z(be,null,Fe(Y(t),r=>(y(),z("svg",{key:r.id,class:"vue-flow__edges vue-flow__container",style:it({zIndex:Y(Fc)(r,Y(n),Y(o))})},[h(Y(uf),{id:r.id},null,8,["id"])],4))),128)),h(Y(ff))],64))}}),bf=st({name:"Node",compatConfig:{MODE:3},props:["id","resizeObserver"],setup(e){const{id:n,noPanClassName:t,selectNodesOnDrag:o,nodesSelectionActive:l,multiSelectionActive:a,emits:r,removeSelectedNodes:u,addSelectedNodes:f,updateNodeDimensions:v,onUpdateNodeInternals:g,getNodeTypes:_,nodeExtent:x,elevateNodesOnSelect:C,disableKeyboardA11y:P,ariaLiveMessage:T,snapToGrid:I,snapGrid:A,nodeDragThreshold:R,nodesDraggable:k,elementsSelectable:D,nodesConnectable:K,nodesFocusable:ge,hooks:ae}=tt(),de=q(null);pn(Cs,de),pn(Ss,e.id);const ve=mn(No),Q=Un(),le=Is(),{node:O,parentNode:Ee}=Ms(e.id),{emit:E,on:F}=lp(O,r),b=ot(()=>typeof O.draggable>"u"?k.value:O.draggable),U=ot(()=>typeof O.selectable>"u"?D.value:O.selectable),j=ot(()=>typeof O.connectable>"u"?K.value:O.connectable),te=ot(()=>typeof O.focusable>"u"?ge.value:O.focusable),ne=ot(()=>U.value||b.value||ae.value.nodeClick.hasListeners()||ae.value.nodeDoubleClick.hasListeners()||ae.value.nodeMouseEnter.hasListeners()||ae.value.nodeMouseMove.hasListeners()||ae.value.nodeMouseLeave.hasListeners()),pe=ot(()=>!!O.dimensions.width&&!!O.dimensions.height),Ve=Oe(()=>{const p=O.type||"default",$=ve==null?void 0:ve[`node-${p}`];if($)return $;let M=O.template||_.value[p];if(typeof M=="string"&&Q){const fe=Object.keys(Q.appContext.components);fe&&fe.includes(p)&&(M=We(p,!1))}return M&&typeof M!="string"?M:(r.error(new pt(ct.NODE_TYPE_MISSING,M)),!1)}),re=Ns({id:e.id,el:de,disabled:()=>!b.value,selectable:U,dragHandle:()=>O.dragHandle,onStart(p){E.dragStart(p)},onDrag(p){E.drag(p)},onStop(p){E.dragStop(p)},onClick(p){V(p)}}),se=Oe(()=>O.class instanceof Function?O.class(O):O.class),ke=Oe(()=>{const p=(O.style instanceof Function?O.style(O):O.style)||{},$=O.width instanceof Function?O.width(O):O.width,M=O.height instanceof Function?O.height(O):O.height;return!p.width&&$&&(p.width=typeof $=="string"?$:`${$}px`),!p.height&&M&&(p.height=typeof M=="string"?M:`${M}px`),p}),Ue=ot(()=>Number(O.zIndex??ke.value.zIndex??0));return g(p=>{(p.includes(e.id)||!p.length)&&Le()}),Et(()=>{Ge(()=>O.hidden,(p=!1,$,M)=>{!p&&de.value&&(e.resizeObserver.observe(de.value),M(()=>{de.value&&e.resizeObserver.unobserve(de.value)}))},{immediate:!0,flush:"post"})}),Ge([()=>O.type,()=>O.sourcePosition,()=>O.targetPosition],()=>{Ot(()=>{v([{id:e.id,nodeElement:de.value,forceUpdate:!0}])})}),Ge([()=>O.position.x,()=>O.position.y,()=>{var p;return(p=Ee.value)==null?void 0:p.computedPosition.x},()=>{var p;return(p=Ee.value)==null?void 0:p.computedPosition.y},()=>{var p;return(p=Ee.value)==null?void 0:p.computedPosition.z},Ue,()=>O.selected,()=>O.dimensions.height,()=>O.dimensions.width,()=>{var p;return(p=Ee.value)==null?void 0:p.dimensions.height},()=>{var p;return(p=Ee.value)==null?void 0:p.dimensions.width}],([p,$,M,fe,_e,Ne])=>{const De={x:p,y:$,z:Ne+(C.value&&O.selected?1e3:0)};typeof M<"u"&&typeof fe<"u"?O.computedPosition=Oc({x:M,y:fe,z:_e},De):O.computedPosition=De},{flush:"post",immediate:!0}),Ge([()=>O.extent,x],([p,$],[M,fe])=>{(p!==M||$!==fe)&&Ae()}),O.extent==="parent"||typeof O.extent=="object"&&"range"in O.extent&&O.extent.range==="parent"?Wo(()=>pe).toBe(!0).then(Ae):Ae(),()=>O.hidden?null:et("div",{ref:de,"data-id":O.id,class:["vue-flow__node",`vue-flow__node-${Ve.value===!1?"default":O.type||"default"}`,{[t.value]:b.value,dragging:re==null?void 0:re.value,draggable:b.value,selected:O.selected,selectable:U.value,parent:O.isParent},se.value],style:{visibility:pe.value?"visible":"hidden",zIndex:O.computedPosition.z??Ue.value,transform:`translate(${O.computedPosition.x}px,${O.computedPosition.y}px)`,pointerEvents:ne.value?"all":"none",...ke.value},tabIndex:te.value?0:void 0,role:te.value?"button":void 0,"aria-describedby":P.value?void 0:`${us}-${n}`,"aria-label":O.ariaLabel,onMouseenter:Ie,onMousemove:Te,onMouseleave:ue,onContextmenu:we,onClick:V,onDblclick:Ce,onKeydown:w},[et(Ve.value===!1?_.value.default:Ve.value,{id:O.id,type:O.type,data:O.data,events:{...O.events,...F},selected:O.selected,resizing:O.resizing,dragging:re.value,connectable:j.value,position:O.computedPosition,dimensions:O.dimensions,isValidTargetPos:O.isValidTargetPos,isValidSourcePos:O.isValidSourcePos,parent:O.parentNode,parentNodeId:O.parentNode,zIndex:O.computedPosition.z??Ue.value,targetPosition:O.targetPosition,sourcePosition:O.sourcePosition,label:O.label,dragHandle:O.dragHandle,onUpdateNodeInternals:Le})]);function Ae(){const p=O.computedPosition;I.value&&(p.x=A.value[0]*Math.round(p.x/A.value[0]),p.y=A.value[1]*Math.round(p.y/A.value[1]));const{computedPosition:$,position:M}=wl(O,p,r.error,x.value,Ee.value);(O.computedPosition.x!==$.x||O.computedPosition.y!==$.y)&&(O.computedPosition={...O.computedPosition,...$}),(O.position.x!==M.x||O.position.y!==M.y)&&(O.position=M)}function Le(){de.value&&v([{id:e.id,nodeElement:de.value,forceUpdate:!0}])}function Ie(p){re!=null&&re.value||E.mouseEnter({event:p,node:O})}function Te(p){re!=null&&re.value||E.mouseMove({event:p,node:O})}function ue(p){re!=null&&re.value||E.mouseLeave({event:p,node:O})}function we(p){return E.contextMenu({event:p,node:O})}function Ce(p){return E.doubleClick({event:p,node:O})}function V(p){U.value&&(!o.value||!b.value||R.value>0)&&dl(O,a.value,f,u,l,!1,de.value),E.click({event:p,node:O})}function w(p){if(!(il(p)||P.value))if(ps.includes(p.key)&&U.value){const $=p.key==="Escape";dl(O,a.value,f,u,l,$,de.value)}else b.value&&O.selected&&cn[p.key]&&(T.value=`Moved selected node ${p.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~O.position.x}, y: ${~~O.position.y}`,le({x:cn[p.key].x,y:cn[p.key].y},p.shiftKey))}}}),kf=bf,Vf={height:"0",width:"0"},$f={name:"EdgeLabelRenderer",compatConfig:{MODE:3}},Ef=st({...$f,setup(e){const{viewportRef:n}=tt(),t=ot(()=>{var o;return(o=n.value)==null?void 0:o.getElementsByClassName("vue-flow__edge-labels")[0]});return(o,l)=>(y(),z("svg",null,[(y(),z("foreignObject",Vf,[(y(),ie(va,{to:t.value,disabled:!t.value},[dt(o.$slots,"default")],8,["to","disabled"]))]))]))}});function Sf(e={includeHiddenNodes:!1}){const{nodes:n}=tt();return Oe(()=>{if(n.value.length===0)return!1;for(const t of n.value)if((e.includeHiddenNodes||!t.hidden)&&((t==null?void 0:t.handleBounds)===void 0||t.dimensions.width===0||t.dimensions.height===0))return!1;return!0})}const Cf={class:"vue-flow__nodes vue-flow__container"},Nf={name:"Nodes",compatConfig:{MODE:3}},zf=st({...Nf,setup(e){const{getNodes:n,updateNodeDimensions:t,emits:o}=tt(),l=Sf(),a=q();return Ge(l,r=>{r&&Ot(()=>{o.nodesInitialized(n.value)})},{immediate:!0}),Et(()=>{a.value=new ResizeObserver(r=>{const u=r.map(f=>({id:f.target.getAttribute("data-id"),nodeElement:f.target,forceUpdate:!0}));Ot(()=>t(u))})}),Ci(()=>{var r;return(r=a.value)==null?void 0:r.disconnect()}),(r,u)=>(y(),z("div",Cf,[a.value?(y(!0),z(be,{key:0},Fe(Y(n),(f,v,g,_)=>{const x=[f.id];if(_&&_.key===f.id&&da(_,x))return _;const C=(y(),ie(Y(kf),{id:f.id,key:f.id,"resize-observer":a.value},null,8,["id","resize-observer"]));return C.memo=x,C},u,0),128)):B("",!0)]))}});function Mf(){const{emits:e}=tt();Et(()=>{if(Es()){const n=document.querySelector(".vue-flow__pane");n&&window.getComputedStyle(n).zIndex!=="1"&&e.error(new pt(ct.MISSING_STYLES))}})}const If=s("div",{class:"vue-flow__edge-labels"},null,-1),Df={name:"VueFlow",compatConfig:{MODE:3}},Tf=st({...Df,props:{id:{},modelValue:{},nodes:{},edges:{},edgeTypes:{},nodeTypes:{},connectionMode:{},connectionLineType:{},connectionLineStyle:{default:void 0},connectionLineOptions:{default:void 0},connectionRadius:{},isValidConnection:{type:[Function,null],default:void 0},deleteKeyCode:{default:void 0},selectionKeyCode:{default:void 0},multiSelectionKeyCode:{default:void 0},zoomActivationKeyCode:{default:void 0},panActivationKeyCode:{default:void 0},snapToGrid:{type:Boolean,default:void 0},snapGrid:{},onlyRenderVisibleElements:{type:Boolean,default:void 0},edgesUpdatable:{type:[Boolean,String],default:void 0},nodesDraggable:{type:Boolean,default:void 0},nodesConnectable:{type:Boolean,default:void 0},nodeDragThreshold:{},elementsSelectable:{type:Boolean,default:void 0},selectNodesOnDrag:{type:Boolean,default:void 0},panOnDrag:{type:[Boolean,Array],default:void 0},minZoom:{},maxZoom:{},defaultViewport:{},translateExtent:{},nodeExtent:{},defaultMarkerColor:{},zoomOnScroll:{type:Boolean,default:void 0},zoomOnPinch:{type:Boolean,default:void 0},panOnScroll:{type:Boolean,default:void 0},panOnScrollSpeed:{},panOnScrollMode:{},paneClickDistance:{},zoomOnDoubleClick:{type:Boolean,default:void 0},preventScrolling:{type:Boolean,default:void 0},selectionMode:{},edgeUpdaterRadius:{},fitViewOnInit:{type:Boolean,default:void 0},connectOnClick:{type:Boolean,default:void 0},applyDefault:{type:Boolean,default:void 0},autoConnect:{type:[Boolean,Function],default:void 0},noDragClassName:{},noWheelClassName:{},noPanClassName:{},defaultEdgeOptions:{},elevateEdgesOnSelect:{type:Boolean,default:void 0},elevateNodesOnSelect:{type:Boolean,default:void 0},disableKeyboardA11y:{type:Boolean,default:void 0},edgesFocusable:{type:Boolean,default:void 0},nodesFocusable:{type:Boolean,default:void 0},autoPanOnConnect:{type:Boolean,default:void 0},autoPanOnNodeDrag:{type:Boolean,default:void 0},autoPanSpeed:{}},emits:["nodesChange","edgesChange","nodesInitialized","paneReady","init","updateNodeInternals","error","connect","connectStart","connectEnd","clickConnectStart","clickConnectEnd","moveStart","move","moveEnd","selectionDragStart","selectionDrag","selectionDragStop","selectionContextMenu","selectionStart","selectionEnd","viewportChangeStart","viewportChange","viewportChangeEnd","paneScroll","paneClick","paneContextMenu","paneMouseEnter","paneMouseMove","paneMouseLeave","edgeUpdate","edgeContextMenu","edgeMouseEnter","edgeMouseMove","edgeMouseLeave","edgeDoubleClick","edgeClick","edgeUpdateStart","edgeUpdateEnd","nodeContextMenu","nodeMouseEnter","nodeMouseMove","nodeMouseLeave","nodeDoubleClick","nodeClick","nodeDragStart","nodeDrag","nodeDragStop","miniMapNodeClick","miniMapNodeDoubleClick","miniMapNodeMouseEnter","miniMapNodeMouseMove","miniMapNodeMouseLeave","update:modelValue","update:nodes","update:edges"],setup(e,{expose:n,emit:t}){const o=e,l=ia(),a=Uo(o,"modelValue",t),r=Uo(o,"nodes",t),u=Uo(o,"edges",t),f=tt(o),v=ap({modelValue:a,nodes:r,edges:u},o,f);return rp(t,f.hooks),sf(),Mf(),pn(No,l),cl(()=>{v()}),n(f),(g,_)=>(y(),z("div",{ref:Y(f).vueFlowRef,class:"vue-flow"},[h(Qp,null,{default:N(()=>[h(xf),If,h(zf),dt(g.$slots,"zoom-pane")]),_:3}),dt(g.$slots,"default"),h(lf)],512))}}),Af={name:"Panel",compatConfig:{MODE:3}},Pf=st({...Af,props:{position:{}},setup(e){const n=e,{userSelectionActive:t}=tt(),o=Oe(()=>`${n.position}`.split("-"));return(l,a)=>(y(),z("div",{class:Me(["vue-flow__panel",o.value]),style:it({pointerEvents:Y(t)?"none":"all"})},[dt(l.$slots,"default")],6))}}),Of={name:"ControlButton",compatConfig:{MODE:3}},Uf=(e,n)=>{const t=e.__vccOpts||e;for(const[o,l]of n)t[o]=l;return t},Bf={class:"vue-flow__controls-button"};function Rf(e,n,t,o,l,a){return y(),z("button",Bf,[dt(e.$slots,"default")])}const so=Uf(Of,[["render",Rf]]),Hf={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Lf=s("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"},null,-1),Ff=[Lf];function qf(e,n){return y(),z("svg",Hf,Ff)}const Gf={render:qf},Yf={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},Xf=s("path",{d:"M0 0h32v4.2H0z"},null,-1),Zf=[Xf];function jf(e,n){return y(),z("svg",Yf,Zf)}const Wf={render:jf},Kf={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},Jf=s("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0 0 27.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94a.919.919 0 0 1-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"},null,-1),Qf=[Jf];function ev(e,n){return y(),z("svg",Kf,Qf)}const tv={render:ev},nv={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},ov=s("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 0 0 0 13.714v15.238A3.056 3.056 0 0 0 3.048 32h18.285a3.056 3.056 0 0 0 3.048-3.048V13.714a3.056 3.056 0 0 0-3.048-3.047zM12.19 24.533a3.056 3.056 0 0 1-3.047-3.047 3.056 3.056 0 0 1 3.047-3.048 3.056 3.056 0 0 1 3.048 3.048 3.056 3.056 0 0 1-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"},null,-1),lv=[ov];function iv(e,n){return y(),z("svg",nv,lv)}const sv={render:iv},av={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},dv=s("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 0 0 0 13.714v15.238A3.056 3.056 0 0 0 3.048 32h18.285a3.056 3.056 0 0 0 3.048-3.048V13.714a3.056 3.056 0 0 0-3.048-3.047zM12.19 24.533a3.056 3.056 0 0 1-3.047-3.047 3.056 3.056 0 0 1 3.047-3.048 3.056 3.056 0 0 1 3.048 3.048 3.056 3.056 0 0 1-3.048 3.047z"},null,-1),rv=[dv];function uv(e,n){return y(),z("svg",av,rv)}const cv={render:uv},pv={name:"Controls",compatConfig:{MODE:3}},fv=st({...pv,props:{showZoom:{type:Boolean,default:!0},showFitView:{type:Boolean,default:!0},showInteractive:{type:Boolean,default:!0},fitViewParams:{},position:{default:()=>rs.BottomLeft}},emits:["zoomIn","zoomOut","fitView","interactionChange"],setup(e,{emit:n}){const{nodesDraggable:t,nodesConnectable:o,elementsSelectable:l,setInteractive:a,zoomIn:r,zoomOut:u,fitView:f,viewport:v,minZoom:g,maxZoom:_}=tt(),x=ot(()=>t.value||o.value||l.value),C=ot(()=>v.value.zoom<=g.value),P=ot(()=>v.value.zoom>=_.value);function T(){r(),n("zoomIn")}function I(){u(),n("zoomOut")}function A(){f(e.fitViewParams),n("fitView")}function R(){a(!x.value),n("interactionChange",!x.value)}return(k,D)=>(y(),ie(Y(Pf),{class:"vue-flow__controls",position:k.position},{default:N(()=>[dt(k.$slots,"top"),k.showZoom?(y(),z(be,{key:0},[dt(k.$slots,"control-zoom-in",{},()=>[h(so,{class:"vue-flow__controls-zoomin",disabled:P.value,onClick:T},{default:N(()=>[dt(k.$slots,"icon-zoom-in",{},()=>[(y(),ie(an(Y(Gf))))])]),_:3},8,["disabled"])]),dt(k.$slots,"control-zoom-out",{},()=>[h(so,{class:"vue-flow__controls-zoomout",disabled:C.value,onClick:I},{default:N(()=>[dt(k.$slots,"icon-zoom-out",{},()=>[(y(),ie(an(Y(Wf))))])]),_:3},8,["disabled"])])],64)):B("",!0),k.showFitView?dt(k.$slots,"control-fit-view",{key:1},()=>[h(so,{class:"vue-flow__controls-fitview",onClick:A},{default:N(()=>[dt(k.$slots,"icon-fit-view",{},()=>[(y(),ie(an(Y(tv))))])]),_:3})]):B("",!0),k.showInteractive?dt(k.$slots,"control-interactive",{key:2},()=>[k.showInteractive?(y(),ie(so,{key:0,class:"vue-flow__controls-interactive",onClick:R},{default:N(()=>[x.value?dt(k.$slots,"icon-unlock",{key:0},()=>[(y(),ie(an(Y(cv))))]):B("",!0),x.value?B("",!0):dt(k.$slots,"icon-lock",{key:1},()=>[(y(),ie(an(Y(sv))))])]),_:3})):B("",!0)]):B("",!0),dt(k.$slots,"default")]),_:3},8,["position"]))}}),$i={sumi:"#1C1C1C",gofun:"#FFFFFB",byakuroku:"#A8D8B9",mizu:"#81C7D4",asagi:"#33A6B8",ukon:"#EFBB24",mushikuri:"#D9CD90",hiwa:"#BEC23F",ichigo:"#B5495B",kurenai:"#CB1B45",syojyohi:"#E83015",konjyo:"#113285",fuji:"#8B81C3",ayame:"#6F3381",torinoko:"#DAC9A6",kurotsurubami:"#0B1013",ohni:"#F05E1C",kokikuchinashi:"#FB9966",beniukon:"#E98B2A",sakura:"#FEDFE1",toki:"#EEA9A9"};Object.keys($i).map(e=>({name:e,value:$i[e]}));function Zo(){return"n_"+Date.now()}const vv={draggedType:q(null),isDragOver:q(!1),isDragging:q(!1),nodes:q([])};function ul(){const{draggedType:e,isDragOver:n,isDragging:t,nodes:o}=vv,{addNodes:l,screenToFlowCoordinate:a,onNodesInitialized:r,updateNode:u,ZoomTo:f}=tt();Ge(t,I=>{document.body.style.userSelect=I?"none":""});function v(I,A,R){I.dataTransfer&&(I.dataTransfer.setData("application/vueflow",A),I.dataTransfer.effectAllowed="move"),o.value=R,e.value=A,t.value=!0,document.addEventListener("drop",x)}function g(I){I.preventDefault(),e.value&&(n.value=!0,I.dataTransfer&&(I.dataTransfer.dropEffect="move"))}function _(){n.value=!1}function x(){t.value=!1,n.value=!1,e.value=null,document.removeEventListener("drop",x)}function C(I){const A=a({x:I.clientX,y:I.clientY});let R=T(e.value,A);const{off:k}=r(()=>{u(R.id,D=>({position:{x:D.position.x-D.dimensions.width/2,y:D.position.y-D.dimensions.height/2}})),k()});l(R)}function P(I,A){let R=I,k=-1;if(A.forEach((D,K)=>{D.data.role===R&&(k=K)}),k!==-1){let D=R.split("_");return D.length>1&&parseInt(D[D.length-1])==D[D.length-1]?D[D.length-1]="_"+(parseInt(D[D.length-1])+1):D[D.length-1]=D[D.length-1]+"_1",R=D.join(""),P(R,A)}else return R}function T(I,A,R,k){k&&k.length>0&&(o.value=k);const D=Zo();let K={type:"card",data:I,position:A};return R&&(K=R),K.id=D,K.selected=!1,K.data.id=Date.now(),K.data.role=P(K.data.role,o.value),I.type=="loop"&&(console.log(K.data.height),K.style={backgroundColor:"none",width:K.data.width||"1000px",height:K.data.height||"850px"},setTimeout(()=>{l({id:Zo(),type:"card",data:{id:Date.now(),type:"loop_start",width:"100px",isHideTitle:!0,isopen:!0,pid:K.data.id},position:{x:40,y:720},expandParent:!0,parentNode:K.id})},70)),K}return{initNode:T,getId:Zo,getName:P,draggedType:e,isDragOver:n,isDragging:t,onDragStart:v,onDragLeave:_,onDragOver:g,onDrop:C}}const gv={key:0,class:"loopbg"},mv={class:"itembox"},hv={class:"ltitle c-icons"},yv={style:{"line-height":"20px","padding-left":"5px"}},_v={class:"nodeid c-color-aaa c-pointer"},wv={key:0,style:{display:"flex","align-items":"center","justify-content":"flex-end"},class:"btns"},xv={class:"node_run_debugbtn"},bv={key:1,class:"body"},kv={class:"loopchild"},Vv={class:"ltitle c-icons"},$v={style:{"line-height":"20px","padding-left":"5px"}},Ev={class:"nodeid c-color-aaa c-pointer"},Sv={class:"body"},Cv={key:0,style:{"margin-bottom":"0"},class:"itembox"},Nv={class:"ltitle"},zv={style:{float:"left"}},Mv={key:1,style:{"padding-left":"28px",width:"100%"},class:"errtip"},Iv={key:1,class:"itembox"},Dv={class:"ltitle"},Tv={class:"fr"},Av={class:"outputbox inputbox curstartbox c-treebox"},Pv={class:"item custom-tree-node"},Ov={class:"type"},Uv={class:"intro1"},Bv={class:"opt"},Rv={class:"chkbox oitem"},Hv={class:"addchild oitem"},Lv=["onClick"],Fv={key:0,class:"optfilebox c-form-alignleft"},qv={style:{"padding-top":"6px"},class:"labelbox"},Gv={class:"del oitem"},Yv=["onClick"],Xv={key:0,style:{width:"100%"},class:"errtip"},Zv={key:2,class:"itembox"},jv={class:"ltitle"},Wv={class:"fr"},Kv={class:"itemcontain"},Jv={class:"childbox varbox"},Qv={key:0,class:"c-emptybox"},e1={class:"item"},t1={class:"label"},n1={class:"val"},o1={class:"val"},l1=["onClick"],i1={key:0,style:{width:"100%"},class:"errtip"},s1={key:3,style:{"margin-bottom":"-20px"},class:"itembox"},a1={class:"ltitle"},d1={class:"nowheel nodrag",style:{width:"100%",height:"40px"}},r1={key:4,class:"itembox"},u1={class:"ltitle"},c1={class:"fr"},p1={class:"tscbox utilbox"},f1={key:0,class:"c-emptybox"},v1={key:1,class:"utilitem"},g1={class:"name"},m1={class:"lbox"},h1=["title"],y1={class:"ellipsis3"},_1={key:5,class:"itembox"},w1={class:"ltitle"},x1={class:"fr"},b1={key:0,style:{"margin-bottom":"20px"},class:"inpauto choiceroleprompt"},k1={style:{height:"40px",width:"100%","z-index":"80"}},V1={key:6,style:{"margin-top":"20px"},class:"itembox"},$1={style:{"font-weight":"bold","font-size":"12px"}},E1={class:"c-switchbox"},S1={class:"label"},C1={class:"switch"},N1={key:7,class:"itembox"},z1={class:"ltitle"},M1={key:0,class:"fr"},I1={key:0,style:{"margin-bottom":"20px"},class:"inpauto choiceroleprompt"},D1={style:{height:"100px",width:"100%","z-index":"20"}},T1={class:"utilbox"},A1={style:{margin:"0","padding-top":"0"},class:"ltitle"},P1={class:"fr"},O1={key:0,class:"c-emptybox"},U1=["onClick"],B1={class:"name"},R1={class:"btns"},H1=["onClick"],L1={key:8,class:"itembox"},F1={class:"ltitle"},q1={class:"optbox"},G1={key:0,class:"itembox product_searchbox"},Y1={class:"c-tips ellipsis"},X1={style:{height:"42px",width:"100%","z-index":"53"}},Z1={class:"c-tips ellipsis"},j1={style:{height:"42px",width:"100%","z-index":"52"}},W1={class:"c-tips ellipsis"},K1={style:{height:"42px",width:"100%","z-index":"51"}},J1={class:"c-tips ellipsis"},Q1={style:{height:"42px",width:"100%","z-index":"50"}},eg={class:"c-tips ellipsis"},tg={style:{height:"42px",width:"100%","z-index":"43"}},ng={class:"c-tips ellipsis"},og={style:{height:"42px",width:"100%","z-index":"42"}},lg={class:"c-tips ellipsis"},ig={style:{height:"42px",width:"100%","z-index":"41"}},sg={class:"c-tips ellipsis"},ag={style:{height:"42px",width:"100%","z-index":"40"}},dg={class:"c-tips ellipsis"},rg={style:{height:"42px",width:"100%","z-index":"39"}},ug={class:"c-tips ellipsis"},cg={style:{height:"42px",width:"100%","z-index":"43"}},pg={class:"c-tips ellipsis"},fg={style:{height:"42px",width:"100%","z-index":"42"}},vg={class:"c-tips ellipsis"},gg={style:{height:"42px",width:"100%","z-index":"41"}},mg={class:"c-tips ellipsis"},hg={style:{height:"42px",width:"100%","z-index":"40"}},yg={class:"c-tips ellipsis"},_g={style:{height:"42px",width:"100%","z-index":"39"}},wg={class:"c-tips ellipsis"},xg={style:{height:"42px",width:"100%","z-index":"38"}},bg={class:"c-tips ellipsis"},kg={style:{height:"42px",width:"100%","z-index":"33"}},Vg={class:"c-tips ellipsis"},$g={style:{height:"42px",width:"100%","z-index":"32"}},Eg={class:"c-tips ellipsis"},Sg={style:{height:"42px",width:"100%","z-index":"31"}},Cg={class:"c-tips ellipsis"},Ng={style:{height:"42px",width:"100%","z-index":"23"}},zg={class:"c-tips ellipsis"},Mg={style:{height:"42px",width:"100%","z-index":"22"}},Ig={class:"c-tips ellipsis"},Dg={style:{height:"42px",width:"100%","z-index":"17"}},Tg={class:"c-tips ellipsis"},Ag={style:{height:"42px",width:"100%","z-index":"17"}},Pg={style:{height:"42px",width:"100%","z-index":"15"}},Og={style:{height:"42px",width:"100%","z-index":"16"}},Ug={class:"c-tips ellipsis"},Bg={style:{height:"42px",width:"100%","z-index":"13"}},Rg={class:"c-tips ellipsis"},Hg={style:{height:"42px",width:"100%","z-index":"13"}},Lg={class:"c-tips ellipsis"},Fg={style:{height:"42px",width:"100%","z-index":"12"}},qg={class:"c-tips ellipsis"},Gg={style:{height:"42px",width:"100%","z-index":"11"}},Yg={key:12,class:"formtitle"},Xg={class:"c-danger"},Zg={class:"c-danger"},jg={class:"c-danger"},Wg={style:{"padding-left":"20px"},class:"c-danger"},Kg={key:19,class:"formtitle"},Jg={style:{height:"42px",width:"100%","z-index":"14"}},Qg={key:21,style:{"margin-bottom":"16px"},class:"itembox"},em={class:"ltitle"},tm={class:"fr"},nm={class:"itemcontain"},om={class:"childbox varbox"},lm={key:0,class:"c-emptybox"},im={class:"item"},sm={style:{width:"25%"},class:"val"},am={style:{width:"25%"},class:"val"},dm={style:{width:"25%"},class:"val"},rm={style:{width:"25%"},class:"val"},um=["onClick"],cm={key:0,style:{width:"100%"},class:"errtip"},pm={class:"testbox"},fm={class:"testbody"},vm={class:"namebox"},gm={class:"name"},mm={key:0,class:"c-danger"},hm=["title"],ym=["title"],_m={class:"type"},wm={key:9,class:"itembox"},xm={class:"ltitle"},bm={key:0,class:"fr"},km={class:"itemcontain"},Vm={key:0,style:{"margin-bottom":"20px"},class:"inpauto choiceroleprompt"},$m={style:{height:"100px",width:"100%"}},Em={class:"xyjsbox"},Sm={key:0,class:"c-emptybox"},Cm={class:"citem"},Nm={class:"label"},zm={key:0,class:"itembox"},Mm={class:"ltitle"},Im={class:"fr"},Dm={class:"inpauto choiceroleprompt"},Tm={style:{height:"100px",width:"100%","margin-bottom":"20px"}},Am={class:"outputbox c-flow-outputbox c-treebox"},Pm={key:0,class:"c-emptybox"},Om={class:"item custom-tree-node"},Um={class:"intro"},Bm={class:"type"},Rm={class:"opt"},Hm={class:"chkbox oitem"},Lm=["onClick"],Fm={class:"del oitem"},qm=["onClick"],Gm={key:0,style:{width:"100%"},class:"errtip"},Ym={class:"navbox"},Xm=["onClick"],Zm=["title"],jm={class:"ellipsis"},Wm=["onClick"],Km=["title"],Jm={class:"ellipsis"},Qm=["onClick"],eh=["title"],th={class:"ellipsis"},nh=["onClick"],oh=["title"],lh={class:"ellipsis"},ih=["onClick"],sh=["title"],ah={class:"ellipsis"},dh={__name:"CardNode",props:{id:{type:String,required:!0},data:{type:Object,required:!0},nodes:{type:Array,required:!0},edges:{type:Array,required:!0},llmlist:{type:Array,default:()=>[]},splist:{type:Array,default:()=>[]},textlist:{type:Array,default:()=>[]},excellist:{type:Array,default:()=>[]},funclist:{type:Array,default:()=>[]},navlist:{type:Array,default:()=>[]},space_vars:{type:Array,default:()=>[]}},emits:["delfn","copyfn","initfn","checktypefn","opendrawerfn","opentscfn","changespace_varsname","node_run_debug"],setup(e,{emit:n}){const t=e,o=Ii(),l=n,a=()=>{o.commit("flowdata",{curnodeid:t.id})},{findNode:r,onPaneReady:u,onNodeDragStop:f,onConnect:v,addEdges:g,addNodes:_,toObject:x,removeEdges:C}=tt();v(J=>{const d=r(J.source),ze=r(J.target);J.type="button",J.animated=!0,J.markerEnd=Pn.Arrow,d.parentNode===ze.parentNode&&g([J])});const P=async J=>{await _this.$confirm("确定删除该节点？")&&l("delfn",J)},T=()=>{l("copyfn",t.id)},I=(J,d)=>{const ze={id:Date.now(),name:"",data_type:"String",desc:"",space_vars_id:"",prefix:J>0?"":"role",is_required:!1};d?(d.children||(d.children=[]),d.children.push(ze),t.data.outputs=[...t.data.outputs]):t.data.outputs.push(ze)},A=(J,d)=>{const ze={id:Date.now(),name:"",data_type:"String",desc:"",fileoption:[],is_required:!1};d?(d.children||(d.children=[]),d.children.push(ze),t.data.inputs=[...t.data.inputs]):t.data.inputs.push(ze)},R=(J,d,ze)=>{const Pe=J.parent,he=Pe.data.children||Pe.data,Ye=he.findIndex(at=>at.id===d.id);he.splice(Ye,1),ze==="input"?t.data.inputs=[...t.data.inputs]:t.data.outputs=[...t.data.outputs]},k=(J,d,ze)=>{Ca(J.name)?D(J.name,d.parent?d.parent.childNodes:d)?J.errtip="变量名不能重复":J.errtip="":J.errtip="变量名只能包含字母、数字和下划线，且不能以数字开头",t.data.inputs&&(t.data.inputs=[...t.data.inputs]),t.data.outputs&&(t.data.outputs=[...t.data.outputs])};function D(J,d){let ze=0;return d.forEach(Pe=>{(Pe.data&&Pe.data.name==J||Pe.name==J)&&(ze+=1)}),ze>1}Et(()=>{K(),ge.value=t.data.role});const K=()=>{t.data.type==="llm"?t.data.choice_role_prompt=t.data.choice_role_prompt||"":t.data.type==="work_space"&&t.data.space_vars.forEach((J,d)=>{J.id||(J.id=J.name),J.data_type=J.data_type||"String"})},ge=q(t.data.role),ae=q("");q(!1);const de=q(!0),ve=q(!0),Q=q(!0);q(!0);const le=q(!0),O=q(!0);q(!0);const Ee=q(!0);q(!0);const E=q(!0),F=(J,d)=>J.level>3&&(d=="Object"||d=="Array<Object>"),b=(J,d)=>{d=="Object"||d=="Array<Object>"||(J.children=[],t.data.outputs=[...t.data.outputs])},U=(J,d)=>{d=="Object"||d=="Array<Object>"||(d=="File"||d=="Array<File>"?J.constraint={max_file_kb:1024*2,allowed_ext_types:[],max_qty:1}:(J.children=[],J.constraint=void 0,t.data.inputs=[...t.data.inputs]))},j=(J,d)=>{t.space_vars.forEach(ze=>{ze.id==d&&(J.name=ze.name,J.data_type=ze.data_type)})},te=(J,d)=>{d=="space"&&(J.children=[]),J.name="",J.data_type="String",J.space_vars_id=""},ne=(J,d)=>{if(J){if(d=="auto_section_run"&&t.data.react==!0)return _this.$message("分身和ReAct推理互斥, 不能同时开启。","error"),t.data.auto_section_run=!1,!1;if(d=="react"&&t.data.auto_section_run==!0)return _this.$message("分身和ReAct推理互斥, 不能同时开启。","error"),t.data.react=!1,!1;if(d=="react"&&t.data.auto_choice_node==!0)return _this.$message("ReAct推理和自动选择下游互斥,不能同时开启。","error"),t.data.react=!1,!1;if(d=="auto_choice_node"&&t.data.react==!0)return _this.$message("ReAct推理和自动选择下游互斥,不能同时开启。","error"),t.data.auto_choice_node=!1,!1}},pe=async(J,d)=>{await _this.$confirm(J)&&d&&d()},Ve=q({inputs:void 0});Ge(()=>Ve,(J,d)=>{re()},{deep:!0});const re=()=>{if(t.data.type=="tool"&&(t.data.datatype=="flow"||t.data.datatype=="plugin"||t.data.datatype=="mcp")&&Ve.value.inputs){let J={};Ve.value.inputs.forEach(d=>{J[d.name]=d.curvalue}),t.data.functions[0].options.inputs=JSON.stringify(J)}};(()=>{if(t.data.type=="tool"&&t.data.datatype=="flow"){let J=-1;if(t.funclist.forEach((d,ze)=>{d.id==t.data.functions[0].options.workflow_id&&d.type=="flow"&&(J=ze)}),J>=0&&t.funclist[J].view_json){let d=t.data.functions[0].options,ze=d&&d.inputs?JSON.parse(d.inputs):{},he=JSON.parse(t.funclist[J].view_json).nodes,Ye=[];he.forEach(at=>{at.data&&at.data.type=="start"&&(Ye=He.cloneDeep(at.data.inputs)||[])}),Ye.forEach(at=>{ze&&ze[at.name]?at.curvalue=ze[at.name]:at.curvalue=o.getters.keyTypesValue[at.data_type]}),Ve.value.inputs=He.cloneDeep(Ye)||[]}else Ve.value.inputs=void 0}else if(t.data.type=="tool"&&(t.data.datatype=="plugin"||t.data.datatype=="mcp")){let J=t.data.dataItem,d=[];J.in_params.forEach(he=>{d.push(he)});let ze=He.cloneDeep(d)||[],Pe=t.data.functions[0].options.inputs?JSON.parse(t.data.functions[0].options.inputs):{};ze.forEach(he=>{Pe&&Pe[he.name]?he.curvalue=Pe[he.name]:he.curvalue=""}),Ve.value.inputs=He.cloneDeep(ze)||[]}})();const ke=(J,d,ze)=>{if(d==="")ze(new Error("节点名称不能为空"));else if(d.indexOf("sys")!==-1||d.indexOf("role")!==-1)ze(new Error("节点名称不能包含'sys'或'role'关键字"));else if(Sa(d))ze(new Error("节点名称不能包含特殊符号"));else{let Pe=0;t.nodes.forEach(he=>{he.data.role==d&&(Pe+=1)}),Pe>1?ze(new Error("节点名称不能重复")):(l("initfn"),ze())}},Ue=q(null),Ae=J=>{J.validateField("llm_id")},Le=()=>{let J=t.id,d=t.nodes,ze=-1;return d.forEach((Pe,he)=>{Pe.id==J&&Pe.selected&&(ze=he)}),ze!==-1},{initNode:Ie}=ul(),Te=r(t.id),ue=q(!1),we=q(0),Ce=q(null),V=(J,d,ze)=>{if(d.type==="loop")return _this.$message("暂不支持嵌套循环节点","error"),!1;let Pe=r(t.id),he=Pe.dimensions.width?parseInt(Pe.dimensions.width)+50:800;const Ye=Ie(He.cloneDeep(d),{x:Pe.position.x+he+we.value*50,y:Pe.position.y+we.value*50},void 0,t.nodes);Ye.expandParent=!0,Ye.parentNode=Pe.parentNode,Ye.data.pid=Pe.data.pid,we.value+=1,_(Ye),g([{source:Pe.id,sourceHandle:"source_1",target:Ye.id,targetHandle:"target_1",type:"button",animated:!0,markerEnd:"arrow"}]),ue.value=!1,Ce.value&&Ce.value.hide()},w=q(!0),p=q(null),$=q(null),M=(J,d)=>{if(d===void 0)return!1;let ze=-1;return J.forEach((Pe,he)=>{Pe.space_vars_id==d&&(ze=he)}),ze!==-1},fe=q({start:"icon-kaishi1",work_space:"icon-gongzuokongjianbianliang",llm:"icon-damoxing",temp_executor:"icon-shuchu1",loop:"icon-pichuli",flow:"icon-gongzuoliugongju",plugin:"icon-gongzuochajian",mcp:"icon-MCP",tool:"icon-gongju1",loop_start:"icon-kaishi1"}),_e=q(null),Ne=q(!1),De=q(!1),Be=q(!1),Re=q(He.cloneDeep(t.navlist)),Je=q("");Ge(Je,J=>{gt(J)});const gt=J=>{J?Re.value=t.navlist.filter(d=>d.role.toLowerCase().includes(J.toLowerCase())):Re.value=He.cloneDeep(t.navlist)},It=()=>({String:"String",Integer:"Integer",Number:"Number",Boolean:"Boolean",Object:"Object",File:"File","Array<String>":"Array<String>","Array<Integer>":"Array<Integer>","Array<Number>":"Array<Number>","Array<Boolean>":"Array<Boolean>","Array<Object>":"Array<Object>","Array<File>":"Array<File>"}),ht=(J,d)=>{J.constraint.allowed_ext_types||(J.constraint.allowed_ext_types=[]);let ze={document:["TXT","MD","MARKDOWN","PDF","HTML","XLSX","XLS","DOCX","CSV","EML","MSG","PPTX","PPT","XML","EPUB"],image:["JPG","JPEG","PNG","GIF","WEBP","SVG"],video:["MP4","MOV","MPEG","MPGA"],audio:["MP3","M4A","WAV","WEBM","AMR"]};ze[d]||(ze[d]=[]),J.constraint.allowed_ext_types=J.constraint.allowed_ext_types.concat(ze[d]),J.constraint.allowed_ext_types=He.uniq([...J.constraint.allowed_ext_types])},ft=q(!0),Bt=q(null),mt=q({}),ee=J=>{console.log(J),t.llmlist.forEach(d=>{d.id==J&&(mt.value=d,mt.value.type!="VLM"&&(t.data.use_vt=!1,Bt.value&&Bt.value.setValue("")))})};return t.data.llm_id&&t.llmlist&&ee(t.data.llm_id),(J,d)=>{const ze=We("el-button"),Pe=We("el-input"),he=We("el-form-item"),Ye=We("el-option"),at=We("el-select"),rt=We("el-tooltip"),on=We("el-checkbox"),yt=We("el-input-number"),hn=We("el-input-tag"),Ln=We("el-popover"),Fn=We("el-tree"),Rt=We("el-switch"),yn=We("el-slider"),wt=We("el-radio"),lt=We("el-radio-group"),Ht=We("el-form"),qn=We("el-scrollbar"),vt=zi("copy");return y(),z(be,null,[t.data.type=="loop"?(y(),z("div",gv)):B("",!0),s("div",{onClick:d[125]||(d[125]=m=>a()),class:Me(["cardbox c-flow-cardbox",[{on:Le(),close:!t.data.isopen},t.data.type]]),style:it({width:t.data.width})},[t.data.isHideTitle?B("",!0):(y(),z("div",{key:0,onClick:d[3]||(d[3]=m=>t.data.isopen=!t.data.isopen),class:"header"},[s("div",mv,[s("div",hv,[s("span",{class:Me([{off:t.data.isopen},"iconfont icon-xiajiantou pointer"]),style:{width:"10px",height:"20px",color:"#333",padding:"0"}},null,2),fe.value[t.data.type]||t.data.icon?(y(),z("span",{key:0,class:Me("iconfont "+(fe.value[t.data.type=="tool"?t.data.datatype:t.data.type]||t.data.icon))},null,2)):B("",!0),s("div",yv,[s("span",null,oe(t.data.role),1),d[128]||(d[128]=G()),d[129]||(d[129]=s("br",null,null,-1)),je((y(),z("span",_v,[G("id:"+oe(t.data.id),1)])),[[vt,t.data.id]])])])]),t.data.type!="work_space"&&t.data.type!="start"?(y(),z("div",wv,[s("div",xv,[h(ze,{onClick:d[0]||(d[0]=Se(m=>{l("node_run_debug",{id:t.data.id})},["stop"])),type:"primary",plain:"",size:"small"},{default:N(()=>d[130]||(d[130]=[G("运行一次"),s("span",{style:{margin:"0"},class:"iconfont icon-liebiao-zhihang"},null,-1)])),_:1}),s("span",{onClick:d[1]||(d[1]=Se(m=>T(),["stop"])),title:"创建副本",class:"iconfont icon-chakanxiangqing-fuzhidaima"}),s("span",{onClick:d[2]||(d[2]=Se(m=>P(e.id),["stop"])),title:"删除节点",class:"iconfont icon-liebiao-shanchu"})])])):B("",!0)])),t.data.type=="loop_start"||t.data.type=="loop_end"?(y(),z("div",bv,[s("div",kv,[s("div",Vv,[fe.value[t.data.type]||t.data.icon?(y(),z("span",{key:0,class:Me("iconfont "+(fe.value[t.data.type=="tool"?t.data.datatype:t.data.type]||t.data.icon))},null,2)):B("",!0),s("div",$v,[s("span",null,oe(t.data.type=="loop_start"?"开始":"结束"),1),d[131]||(d[131]=G()),d[132]||(d[132]=s("br",null,null,-1)),je((y(),z("span",Ev,[G("id:"+oe(t.data.id),1)])),[[vt,t.data.id]])])])])])):(y(),ie(Ht,{key:2,style:{width:"100%"},ref_key:"formRef",ref:Ue,"data-id":t.id,model:t.data,"label-width":"auto","label-position":"top",inline:"",class:"demo-dynamic tl"},{default:N(()=>[s("div",Sv,[t.data.description!==void 0&&t.data.type!="start"?(y(),z("div",Cv,[s("div",Nv,[s("span",{class:Me([{off:E.value},"iconfont icon-xiajiantou pointer"]),onClick:d[4]||(d[4]=Se(m=>E.value=!E.value,["stop"]))},null,2),d[133]||(d[133]=G()),d[134]||(d[134]=s("span",{class:"iconfont icon-jiaosexinxi"},null,-1)),d[135]||(d[135]=G(" 角色信息 "))]),je(h(he,{style:it(t.data.type!="tool"&&!t.data.hidellm&&t.data.type!="start"?"width: calc(100% - 216px);margin-right: 16px;":"width: 100%;margin-right: 0px;"),prop:"role",label:"角色名称",rules:{trigger:"blur",required:!0,validator:ke}},{default:N(()=>[h(Pe,{size:"small",style:{width:"100%"},maxlength:"20",onClick:d[5]||(d[5]=Se(()=>{},["stop","prevent"])),onMousedown:d[6]||(d[6]=Se(()=>{},["stop"])),modelValue:t.data.role,"onUpdate:modelValue":d[7]||(d[7]=m=>t.data.role=m)},null,8,["modelValue"])]),_:1},8,["style","rules"]),[[Ke,E.value]]),t.data.type!="tool"&&!t.data.hidellm&&t.data.type!="start"?je((y(),ie(he,{key:0,style:{width:"200px","margin-right":"0"},prop:"llm_id",label:"大模型",rules:{required:!0,message:"请选择大模型"}},{default:N(()=>[h(at,{onChange:ee,style:{width:"200px"},onBlur:d[8]||(d[8]=m=>Ae(Ue.value)),size:"small",modelValue:t.data.llm_id,"onUpdate:modelValue":d[9]||(d[9]=m=>t.data.llm_id=m),class:"val",filterable:"",placeholder:"请选择大模型"},{default:N(()=>[(y(!0),z(be,null,Fe(e.llmlist,m=>(y(),ie(Ye,{value:parseInt(m.id,10),label:m.name},{default:N(()=>[s("span",zv,oe(m.name),1),s("span",{style:it({float:"right",color:m.type=="LLM"?"rgb(100,161,255)":"rgb(152,139,255)"})},oe(m.type),5)]),_:2},1032,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1},512)),[[Ke,E.value]]):B("",!0),ae.value?(y(),z("div",Mv,oe(ae.value),1)):B("",!0),je(h(he,{style:{width:"100%","margin-right":"0","margin-bottom":"0"},prop:"description",label:"角色介绍",rules:{trigger:"blur",required:!0,message:"请输入介绍信息"}},{label:N(()=>[d[137]||(d[137]=G(" 角色介绍")),t.data.type!="start"?(y(),ie(rt,{key:0,"popper-class":"c-flowtip",class:"item",effect:"dark",content:"用于上游节点，在自动选择下游角色时候的参考描述",placement:"top"},{default:N(()=>d[136]||(d[136]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1})):B("",!0)]),default:N(()=>[h(Pe,{onClick:d[10]||(d[10]=Se(()=>{},["stop","prevent"])),onMousedown:d[11]||(d[11]=Se(()=>{},["stop"])),onWheel:d[12]||(d[12]=Se(()=>{},["stop"])),type:"textarea",resize:"none",size:"small",rows:1,placeholder:"请输入介绍信息",modelValue:t.data.description,"onUpdate:modelValue":d[13]||(d[13]=m=>t.data.description=m)},null,8,["modelValue"])]),_:1},512),[[Ke,E.value]])])):B("",!0),t.data.type=="start"?(y(),z("div",Iv,[s("div",Dv,[s("span",{class:Me([{off:Ee.value},"iconfont icon-xiajiantou pointer"]),onClick:d[14]||(d[14]=Se(m=>Ee.value=!Ee.value,["stop"]))},null,2),d[139]||(d[139]=G()),d[140]||(d[140]=s("span",{class:"iconfont icon-shuru1"},null,-1)),d[141]||(d[141]=G(" 输入 ")),s("span",Tv,[s("span",{class:"addvarbtn",onClick:d[15]||(d[15]=m=>A(0))},d[138]||(d[138]=[s("span",{class:"iconfont icon-liebiao-zengjia"},null,-1),G(" 新增变量")]))])]),je(s("div",Av,[d[151]||(d[151]=s("div",{class:"item title"},[s("div",{class:"key"},"变量名"),s("div",{class:"type"},"变量类型"),s("div",{class:"intro1"},"描述"),s("div",{class:"opt"},"是否必须")],-1)),h(Fn,{style:{width:"100%"},data:t.data.inputs,"node-key":"id","default-expand-all":"","empty-text":"","expand-on-click-node":!1},{default:N(({node:m,data:Z})=>[s("div",Pv,[s("div",{class:"key",style:it("margin-right:-"+18*(m.level-1)+"px")},[h(Pe,{onBlur:X=>k(Z,m),onClick:d[16]||(d[16]=Se(()=>{},["stop","prevent"])),onMousedown:d[17]||(d[17]=Se(()=>{},["stop"])),disabled:Z.disabled,placeholder:"输入变量名",size:"small",modelValue:Z.name,"onUpdate:modelValue":X=>Z.name=X,style:it("width:"+(170-18*m.level)+"px")},null,8,["onBlur","disabled","modelValue","onUpdate:modelValue","style"])],4),s("div",Ov,[h(at,{size:"small",modelValue:Z.data_type,"onUpdate:modelValue":X=>Z.data_type=X,disabled:Z.disabled,onChange:X=>{U(Z,X)},placeholder:"选择类型"},{default:N(()=>[(y(!0),z(be,null,Fe(It(),(X,ln)=>(y(),ie(Ye,{value:ln,label:X,disabled:F(m,X)},null,8,["value","label","disabled"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])]),s("div",Uv,[h(Pe,{size:"small",onClick:d[18]||(d[18]=Se(()=>{},["stop","prevent"])),onMousedown:d[19]||(d[19]=Se(()=>{},["stop"])),modelValue:Z.desc,"onUpdate:modelValue":X=>Z.desc=X,placeholder:"请描述变量的用途"},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Bv,[s("div",Rv,[h(on,{disabled:Z.disabled,modelValue:Z.is_required,"onUpdate:modelValue":X=>Z.is_required=X,label:"",size:"small"},null,8,["disabled","modelValue","onUpdate:modelValue"])]),s("div",Hv,[je(s("span",{title:"新增子项",onClick:X=>A(m.level,Z),class:"iconfont icon-jiahao1"},null,8,Lv),[[Ke,m.level<4&&(Z.data_type=="Object"||Z.data_type=="Array<Object>")]]),m.level<=1&&(Z.data_type=="File"||Z.data_type=="Array<File>")?(y(),ie(Ln,{key:0,placement:"right",width:600,trigger:"click"},{reference:N(()=>d[142]||(d[142]=[s("span",{title:"配置文件类型",class:"iconfont icon-moxingpeizhi-weixuanzhong-caidanicon"},null,-1)])),default:N(()=>[Z.constraint?(y(),z("div",Fv,[d[148]||(d[148]=s("div",{class:"labelbox"},[G("文件大小 "),s("span",{class:"c-tips"},"（单个文件最大值，单位KB）")],-1)),Z.constraint&&Z.constraint.max_file_kb?(y(),ie(yt,{key:0,size:"small",style:{width:"100%"},onFocus:d[20]||(d[20]=X=>X.target.select()),modelValue:Z.constraint.max_file_kb,"onUpdate:modelValue":X=>Z.constraint.max_file_kb=X,placeholder:"",min:1,precision:0,step:1,controls:!1},null,8,["modelValue","onUpdate:modelValue"])):B("",!0),d[149]||(d[149]=s("div",{class:"labelbox"},[G("文件数量 "),s("span",{class:"c-tips"},"（最多上传文件数量）")],-1)),Z.constraint&&Z.constraint.max_qty?(y(),ie(yt,{key:1,size:"small",style:{width:"100%"},onFocus:d[21]||(d[21]=X=>X.target.select()),modelValue:Z.constraint.max_qty,"onUpdate:modelValue":X=>Z.constraint.max_qty=X,placeholder:"",disabled:Z.data_type=="File",min:1,precision:0,step:1,controls:!1},null,8,["modelValue","onUpdate:modelValue","disabled"])):B("",!0),d[150]||(d[150]=s("div",{class:"labelbox"},[G("文件类型 "),s("span",{class:"c-tips"},"（回车添加自定义类型）")],-1)),h(hn,{style:{width:"100%"},clearable:"",onAddTag:()=>{Z.constraint.allowed_ext_types?Z.constraint.allowed_ext_types:Z.constraint.allowed_ext_types=[],Z.constraint.allowed_ext_types=Y(He.uniq)([...Z.constraint.allowed_ext_types])},"collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":3,modelValue:Z.constraint.allowed_ext_types,"onUpdate:modelValue":X=>Z.constraint.allowed_ext_types=X,placeholder:"添加自定义文件类型"},null,8,["onAddTag","modelValue","onUpdate:modelValue"]),s("div",qv,[d[147]||(d[147]=G("快捷添加： ")),h(ze,{onClick:X=>ht(Z,"image"),size:"small",plain:""},{default:N(()=>d[143]||(d[143]=[G("图片")])),_:2},1032,["onClick"]),h(ze,{onClick:X=>ht(Z,"video"),size:"small",plain:""},{default:N(()=>d[144]||(d[144]=[G("视频")])),_:2},1032,["onClick"]),h(ze,{onClick:X=>ht(Z,"audio"),size:"small",plain:""},{default:N(()=>d[145]||(d[145]=[G("音频")])),_:2},1032,["onClick"]),h(ze,{onClick:X=>ht(Z,"document"),size:"small",plain:""},{default:N(()=>d[146]||(d[146]=[G("文档")])),_:2},1032,["onClick"])])])):B("",!0)]),_:2},1024)):B("",!0)]),s("div",Gv,[Z.disabled?B("",!0):(y(),z("span",{key:0,title:"删除当前项",onClick:X=>R(m,Z,"input"),class:"iconfont icon-liebiao-shanchu"},null,8,Yv))])]),Z.errtip?(y(),z("div",Xv,oe(Z.errtip),1)):B("",!0)])]),_:1},8,["data"])],512),[[Ke,Ee.value]])])):B("",!0),t.data.space_vars!==void 0?(y(),z("div",Zv,[s("div",jv,[s("span",{class:Me([{off:Ee.value},"iconfont icon-xiajiantou pointer"]),onClick:d[22]||(d[22]=Se(m=>Ee.value=!Ee.value,["stop"]))},null,2),d[153]||(d[153]=G()),d[154]||(d[154]=s("span",{class:"iconfont icon-bianliangpeizhi"},null,-1)),d[155]||(d[155]=G(" 变量配置 ")),s("span",Wv,[s("span",{class:"addvarbtn",onClick:d[23]||(d[23]=m=>{t.data.space_vars.push({id:Date.now(),name:"",type:"over_write",data_type:"String",errtip:""}),l("changespace_varsname",{name:"",id:Date.now(),space_vars:t.data.space_vars,eventtype:"add"})})},d[152]||(d[152]=[s("span",{class:"iconfont icon-liebiao-zengjia"},null,-1),G(" 新增变量")]))])]),je(s("div",Kv,[s("div",Jv,[d[156]||(d[156]=s("div",{class:"item title"},[s("span",{class:"label"},"变量"),s("span",{class:"val"},"变量类型"),s("span",{class:"val"},"存储方式")],-1)),t.data.space_vars&&t.data.space_vars.length>0?B("",!0):(y(),z("div",Qv," 暂无变量 ")),t.data.space_vars&&t.data.space_vars.length>0?(y(!0),z(be,{key:1},Fe(t.data.space_vars,(m,Z)=>je((y(),z("div",e1,[s("span",t1,[h(Pe,{onClick:d[24]||(d[24]=Se(()=>{},["stop","prevent"])),onMousedown:d[25]||(d[25]=Se(()=>{},["stop"])),onBlur:X=>{k(m,t.data.space_vars),l("changespace_varsname",{name:m.name,id:m.id,space_vars:t.data.space_vars,eventtype:"name"})},size:"small",placeholder:"请输入变量名",modelValue:m.name,"onUpdate:modelValue":X=>m.name=X},null,8,["onBlur","modelValue","onUpdate:modelValue"])]),s("div",n1,[h(at,{size:"small",onChange:X=>{(X=="String"||X=="Integer")&&(m.type="over_write"),l("changespace_varsname",{data_type:m.data_type,id:m.id,space_vars:t.data.space_vars,eventtype:"data_type"})},modelValue:m.data_type,"onUpdate:modelValue":X=>m.data_type=X,placeholder:"请选择"},{default:N(()=>[h(Ye,{value:"String",label:"String"}),h(Ye,{value:"Integer",label:"Integer"}),h(Ye,{value:"Number",label:"Number"}),h(Ye,{value:"Array<String>",label:"Array<String>"}),h(Ye,{value:"Array<Integer>",label:"Array<Integer>"}),h(Ye,{value:"Array<Number>",label:"Array<Number>"})]),_:2},1032,["onChange","modelValue","onUpdate:modelValue"])]),s("div",o1,[h(at,{size:"small",modelValue:m.type,"onUpdate:modelValue":X=>m.type=X,placeholder:"请选择"},{default:N(()=>[h(Ye,{value:"over_write",label:"覆盖"}),m.data_type=="Array<Number>"||m.data_type=="Array<String>"||m.data_type=="Array<Integer>"?(y(),ie(Ye,{key:0,value:"append",label:"追加"})):B("",!0),m.data_type=="Array<Number>"||m.data_type=="Array<String>"||m.data_type=="Array<Integer>"?(y(),ie(Ye,{key:1,value:"append_unique",label:"不重复追加"})):B("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue"]),s("span",{title:"删除当前项",onClick:X=>{pe("删除该变量将同步删除工作流下所有节点变量存储下相关的引用，确定要删除么？",()=>{l("changespace_varsname",{data_type:m.data_type,id:m.id,space_vars:t.data.space_vars,eventtype:"del"}),t.data.space_vars.splice(Z,1)})},class:"iconfont icon-liebiao-shanchu"},null,8,l1)]),m.errtip?(y(),z("div",i1,oe(m.errtip),1)):B("",!0)],512)),[[Ke,m.type!=="HIDE_SPACE_VARS"]])),256)):B("",!0)])],512),[[Ke,Ee.value]])])):B("",!0),t.data.loop_traget!==void 0?(y(),z("div",s1,[s("div",a1,[s("span",{class:Me([{off:w.value},"iconfont icon-xiajiantou pointer"]),onClick:d[26]||(d[26]=Se(m=>w.value=!w.value,["stop"]))},null,2),d[158]||(d[158]=G()),d[159]||(d[159]=s("span",{class:"iconfont icon-chaifenziduan"},null,-1)),d[160]||(d[160]=G(" 拆分字段")),h(rt,{"popper-class":"c-flowtip",class:"item",effect:"dark",content:"用于循环的可拆分目标字段",placement:"top"},{default:N(()=>d[157]||(d[157]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1})]),je(h(he,{style:{width:"calc(100% - 252px)","margin-right":"16px"},prop:"loop_traget",label:"目标字段"},{default:N(()=>[s("div",d1,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.loop_traget,"onUpdate:modelValue":d[27]||(d[27]=m=>t.data.loop_traget=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1},512),[[Ke,w.value&&E.value]]),je(h(he,{style:{width:"110px","margin-right":"16px"},prop:"loop_traget",label:"每批大小"},{default:N(()=>[t.data.loop_size!==void 0?(y(),ie(yt,{key:0,style:{width:"100%"},size:"large",onFocus:d[28]||(d[28]=m=>m.target.select()),modelValue:t.data.loop_size,"onUpdate:modelValue":d[29]||(d[29]=m=>t.data.loop_size=m),placeholder:"分拆大小",min:1,precision:0,step:1,controls:!1},null,8,["modelValue"])):B("",!0)]),_:1},512),[[Ke,w.value&&E.value]]),h(he,{style:{width:"110px","margin-right":"0px"},prop:"max_workers",label:"并发数"},{default:N(()=>[h(yt,{style:{width:"100%"},size:"large",onFocus:d[30]||(d[30]=m=>m.target.select()),modelValue:t.data.max_workers,"onUpdate:modelValue":d[31]||(d[31]=m=>t.data.max_workers=m),placeholder:"空表示不限制",min:1,max:64,precision:0,controls:!1},null,8,["modelValue"])]),_:1})])):B("",!0),t.data.prompt_template!==void 0?(y(),z("div",r1,[s("div",u1,[s("span",{class:Me([{off:de.value},"iconfont icon-xiajiantou pointer"]),onClick:d[32]||(d[32]=Se(m=>de.value=!de.value,["stop"]))},null,2),d[161]||(d[161]=s("span",{style:{"font-size":"18px"},class:"iconfont icon-tishici-weixuanzhong-caidanicon"},null,-1)),d[162]||(d[162]=G(" 提示词 ")),s("div",c1,[s("div",{onClick:d[33]||(d[33]=m=>l("opendrawerfn",{type:0,item:t.data,id:t.id,nodeid:t.data.id})),class:"addvarbtn"},"选择提示词")])]),je(s("div",p1,[t.data.prompt_id?(y(),z("div",v1,[s("div",g1,[s("div",m1,oe(t.data.prompt_template.name),1),s("div",{onClick:d[37]||(d[37]=Se(()=>{},["stop"])),class:"rbox"},[h(ze,{style:{"margin-right":"10px"},onClick:d[34]||(d[34]=Se(m=>{l("node_run_debug",{type:"1",id:t.data.id,content:t.data.prompt_template.content})},["stop"])),size:"small",plain:"",type:"primary"},{default:N(()=>d[163]||(d[163]=[G("运行一次"),s("span",{class:"iconfont icon-liebiao-zhihang"},null,-1)])),_:1}),s("span",{title:"修改",onClick:d[35]||(d[35]=m=>l("opentscfn",{type:0,item:t.data.prompt_template,id:t.id,nodeid:t.data.id})),class:"iconfont icon-liebiao-bianji c-pointer"}),s("span",{title:"删除",onClick:d[36]||(d[36]=m=>{t.data.prompt_template="",t.data.prompt_id=""}),class:"iconfont icon-liebiao-shanchu c-pointer"})])]),s("div",{title:t.data.prompt_template.content||"这个提示词还没有介绍~",class:"introbox"},[s("p",y1,oe(t.data.prompt_template.content||"这个提示词还没有介绍~"),1)],8,h1)])):(y(),z("div",f1," 暂无提示词 "))],512),[[Ke,de.value]])])):B("",!0),t.data.type=="llm"?(y(),z("div",_1,[s("div",w1,[s("span",{class:Me([{off:ft.value},"iconfont icon-xiajiantou pointer"]),onClick:d[38]||(d[38]=Se(m=>ft.value=!ft.value,["stop"]))},null,2),d[165]||(d[165]=s("span",{class:"iconfont icon-jiaosexinxi"},null,-1)),d[166]||(d[166]=G(" 视觉 ")),t.data.type=="llm"?(y(),ie(rt,{key:0,"popper-class":"c-flowtip",class:"item",effect:"dark",content:"开启视觉功能将允许模型输入图片，并根据图像内容消息的理解回答用户问题",placement:"top"},{default:N(()=>d[164]||(d[164]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1})):B("",!0),s("div",x1,[h(Rt,{disabled:mt.value.type!="VLM",style:{"margin-left":"5px"},modelValue:t.data.use_vt,"onUpdate:modelValue":d[39]||(d[39]=m=>t.data.use_vt=m)},null,8,["disabled","modelValue"])])]),ft.value&&t.data.use_vt?(y(),z("div",b1,[s("div",k1,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,ref_key:"vt_file",ref:Bt,modelValue:t.data.vt_file,"onUpdate:modelValue":d[40]||(d[40]=m=>t.data.vt_file=m)},null,8,["nodes","edges","nodeid","modelValue"])])])):B("",!0)])):B("",!0),t.data.type=="llm"?(y(),z("div",V1,[t.data.type=="llm"?(y(),ie(he,{key:0,style:{width:"100%","margin-right":"0px","margin-bottom":"0"},prop:"auto_section_run",label:"输出分身"},{label:N(()=>[s("span",$1,[d[168]||(d[168]=G("输出分身 ")),t.data.type=="llm"?(y(),ie(rt,{key:0,"popper-class":"c-flowtip",class:"item",effect:"dark",content:"在面临选择工具、自动决策下游流程、变量存储等多任务并发执行的复杂场景时，大模型可能会遇到处理能力瓶颈。为此，程序特别设计了分身功能，使得该角色能够一分为三，同时并发执行不同的任务。",placement:"top"},{default:N(()=>d[167]||(d[167]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1})):B("",!0)])]),default:N(()=>[s("div",E1,[s("div",S1,[d[169]||(d[169]=s("span",{class:"iconfont icon-shifoufenshen"},null,-1)),G(" "+oe(t.data.auto_section_run?"开启分身":"未开启分身"),1)]),s("div",C1,[h(Rt,{onChange:d[41]||(d[41]=m=>{ne(m,"auto_section_run")}),modelValue:t.data.auto_section_run,"onUpdate:modelValue":d[42]||(d[42]=m=>t.data.auto_section_run=m)},null,8,["modelValue"])])])]),_:1})):B("",!0)])):B("",!0),t.data.functions!==void 0&&t.data.type!=="tool"?(y(),z("div",N1,[s("div",z1,[s("span",{class:Me([{off:ve.value},"iconfont icon-xiajiantou pointer"]),onClick:d[43]||(d[43]=Se(m=>ve.value=!ve.value,["stop"]))},null,2),d[175]||(d[175]=s("span",{class:"iconfont icon-keyonggongju"},null,-1)),d[176]||(d[176]=G(" 可用工具 ")),s("span",{class:Me(["c-pointer inpopenbox",{on:Be.value}]),onClick:d[44]||(d[44]=m=>Be.value=!Be.value)},[d[170]||(d[170]=s("span",{class:"iconfont icon-anniu-zhankai"},null,-1)),G(" "+oe(Be.value?"收起":"展开"),1)],2),t.data.react!==void 0?(y(),z("div",M1,[t.data.react?(y(),z(be,{key:0},[d[172]||(d[172]=s("span",{class:"rborder"},"最大推理次数 ",-1)),h(rt,{"popper-class":"c-flowtip",effect:"dark",content:"可以进行ReAct的最大轮数，达到最大轮数后，系统会自动添加提示词要求模型停止摊理。",placement:"top"},{default:N(()=>d[171]||(d[171]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1}),h(yt,{onClick:d[45]||(d[45]=Se(()=>{},["stop","prevent"])),onMousedown:d[46]||(d[46]=Se(()=>{},["stop"])),size:"small",style:{width:"100px","margin-right":"10px"},placeholder:"最大react次数",modelValue:t.data.react_max_times,"onUpdate:modelValue":d[47]||(d[47]=m=>t.data.react_max_times=m),min:1,max:10,precision:0,step:1},null,8,["modelValue"])],64)):B("",!0),d[174]||(d[174]=s("span",{class:"rborder"},"ReAct推理 ",-1)),h(rt,{"popper-class":"c-flowtip",effect:"dark",content:"思考 → 行动 → 观察 模式。启用后，大模型会多次循环思考或使用工具，速度会变慢，效果会变好",placement:"top"},{default:N(()=>d[173]||(d[173]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1}),h(Rt,{style:{"margin-left":"5px"},onChange:d[48]||(d[48]=m=>{ne(m,"react")}),modelValue:t.data.react,"onUpdate:modelValue":d[49]||(d[49]=m=>t.data.react=m)},null,8,["modelValue"])])):B("",!0)]),t.data.react&&Be.value&&ve.value?(y(),z("div",I1,[s("div",D1,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,ref_key:"react_part_prompt",ref:_e,modelValue:t.data.react_part_prompt,"onUpdate:modelValue":d[50]||(d[50]=m=>t.data.react_part_prompt=m)},null,8,["nodes","edges","nodeid","modelValue"])]),s("div",{onClick:d[51]||(d[51]=m=>_e.value.setValue(Y(o).getters.ComValueMap.react_part_prompt)),class:"btn-update c-pointer"},d[177]||(d[177]=[s("span",{title:"恢复默认值",class:"iconfont icon-huifumorenzhi c-pointer"},null,-1),G(" 重置 ")]))])):B("",!0),je(s("div",T1,[s("div",A1,[d[179]||(d[179]=G(" 选择工具 ")),s("div",P1,[s("span",{style:{"margin-left":"20px"},onClick:d[52]||(d[52]=m=>l("checktypefn",{type:0,item:t.data,id:t.id})),class:"addvarbtn"},d[178]||(d[178]=[s("span",{class:"iconfont icon-liebiao-zengjia"},null,-1),G(" 添加工具")]))])]),t.data.functions&&t.data.functions.length<1?(y(),z("div",O1," 暂无工具 ")):B("",!0),t.data.functions&&t.data.functions.length>0?(y(!0),z(be,{key:1},Fe(t.data.functions,(m,Z)=>(y(),z("div",{onClick:X=>l("checktypefn",{type:m.fun_name,item:t.data,id:t.id}),class:"utilitem"},[s("div",B1,[G(oe(m.name)+" ",1),d[180]||(d[180]=s("br",null,null,-1)),G(" "+oe(m.fun_name),1)]),s("div",R1,[d[181]||(d[181]=s("span",{title:"配置",class:"iconfont icon-peizhi"},null,-1)),s("span",{onClick:Se(X=>{pe("确认删除所选工具么？",()=>{t.data.functions.splice(Z,1)})},["stop"]),title:"删除",class:"iconfont icon-liebiao-shanchu"},null,8,H1)])],8,U1))),256)):B("",!0)],512),[[Ke,ve.value]])])):B("",!0),t.data.functions!==void 0&&t.data.type=="tool"?(y(),z("div",L1,[s("div",F1,[s("span",{class:Me([{off:ve.value},"iconfont icon-xiajiantou pointer"]),onClick:d[53]||(d[53]=Se(m=>ve.value=!ve.value,["stop"]))},null,2),d[182]||(d[182]=s("span",{class:"iconfont icon-keyonggongju"},null,-1)),d[183]||(d[183]=G("工具配置参数 "))]),je(s("div",q1,[t.data.dataItem&&(t.data.dataItem.fun_name=="vectorstore_retrieve"||t.data.dataItem.fun_name=="product_retrieve"||t.data.dataItem.fun_name=="inventory_price_retrieve")||t.data.dataItem.fun_name=="printer_consumable_retrieve"||t.data.dataItem.fun_name=="knowledge_retrieve"||t.data.dataItem.fun_name=="calculator"||t.data.dataItem.fun_name=="knowledge_append"||t.data.dataItem.fun_name=="unit_test_add"||t.data.dataItem.fun_name=="train_case_add"||t.data.dataItem.fun_name=="flow_node_logs"||t.data.dataItem.fun_name=="knowledge_add"||t.data.dataItem.fun_name=="websearch"?(y(),z("div",G1,[h(Ht,{style:{width:"100%"},model:t.data.functions[0].options,"label-position":"top",inline:"","label-width":"auto"},{default:N(()=>[t.data.dataItem.fun_name=="knowledge_add"?(y(),z(be,{key:0},[h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[184]||(d[184]=G(" knowledgebase_id参数")),s("span",Y1,oe(t.data.functions[0].options.knowledgebase_id_desc),1)]),default:N(()=>[s("div",X1,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.knowledgebase_id,"onUpdate:modelValue":d[54]||(d[54]=m=>t.data.functions[0].options.knowledgebase_id=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1}),h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[185]||(d[185]=G(" category_id参数")),s("span",Z1,oe(t.data.functions[0].options.category_id_desc),1)]),default:N(()=>[s("div",j1,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.category_id,"onUpdate:modelValue":d[55]||(d[55]=m=>t.data.functions[0].options.category_id=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1}),h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[186]||(d[186]=G(" title参数")),s("span",W1,oe(t.data.functions[0].options.title_desc),1)]),default:N(()=>[s("div",K1,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.title,"onUpdate:modelValue":d[56]||(d[56]=m=>t.data.functions[0].options.title=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1}),h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[187]||(d[187]=G(" content参数")),s("span",J1,oe(t.data.functions[0].options.content_desc),1)]),default:N(()=>[s("div",Q1,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.content,"onUpdate:modelValue":d[57]||(d[57]=m=>t.data.functions[0].options.content=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1})],64)):B("",!0),t.data.dataItem.fun_name=="flow_node_logs"?(y(),z(be,{key:1},[h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[188]||(d[188]=G(" flow_id参数")),s("span",eg,oe(t.data.functions[0].options.flow_id_desc),1)]),default:N(()=>[s("div",tg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.flow_id,"onUpdate:modelValue":d[58]||(d[58]=m=>t.data.functions[0].options.flow_id=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1}),h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[189]||(d[189]=G(" role_id参数")),s("span",ng,oe(t.data.functions[0].options.role_id_desc),1)]),default:N(()=>[s("div",og,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.role_id,"onUpdate:modelValue":d[59]||(d[59]=m=>t.data.functions[0].options.role_id=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1}),h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[190]||(d[190]=G(" start_time参数")),s("span",lg,oe(t.data.functions[0].options.start_time_desc),1)]),default:N(()=>[s("div",ig,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.start_time,"onUpdate:modelValue":d[60]||(d[60]=m=>t.data.functions[0].options.start_time=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1}),h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[191]||(d[191]=G(" end_time参数")),s("span",sg,oe(t.data.functions[0].options.end_time_desc),1)]),default:N(()=>[s("div",ag,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.end_time,"onUpdate:modelValue":d[61]||(d[61]=m=>t.data.functions[0].options.end_time=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1}),h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[192]||(d[192]=G(" max_top_n参数")),s("span",dg,oe(t.data.functions[0].options.max_top_n_desc),1)]),default:N(()=>[s("div",rg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.max_top_n,"onUpdate:modelValue":d[62]||(d[62]=m=>t.data.functions[0].options.max_top_n=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1})],64)):B("",!0),t.data.dataItem.fun_name=="train_case_add"?(y(),z(be,{key:2},[h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[193]||(d[193]=G(" train_cate_id参数")),s("span",ug,oe(t.data.functions[0].options.train_cate_id_desc),1)]),default:N(()=>[s("div",cg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.train_cate_id,"onUpdate:modelValue":d[63]||(d[63]=m=>t.data.functions[0].options.train_cate_id=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1}),h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[194]||(d[194]=G(" input_content参数")),s("span",pg,oe(t.data.functions[0].options.input_content_desc),1)]),default:N(()=>[s("div",fg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.input_content,"onUpdate:modelValue":d[64]||(d[64]=m=>t.data.functions[0].options.input_content=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1}),h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[195]||(d[195]=G(" output_contet参数")),s("span",vg,oe(t.data.functions[0].options.output_contet_desc),1)]),default:N(()=>[s("div",gg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.output_contet,"onUpdate:modelValue":d[65]||(d[65]=m=>t.data.functions[0].options.output_contet=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1}),h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[196]||(d[196]=G(" feature参数")),s("span",mg,oe(t.data.functions[0].options.feature_desc),1)]),default:N(()=>[s("div",hg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.feature,"onUpdate:modelValue":d[66]||(d[66]=m=>t.data.functions[0].options.feature=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1}),h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[197]||(d[197]=G(" node_log_id参数")),s("span",yg,oe(t.data.functions[0].options.node_log_id_desc),1)]),default:N(()=>[s("div",_g,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.node_log_id,"onUpdate:modelValue":d[67]||(d[67]=m=>t.data.functions[0].options.node_log_id=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1}),h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[198]||(d[198]=G(" test_case_id参数")),s("span",wg,oe(t.data.functions[0].options.test_case_id_desc),1)]),default:N(()=>[s("div",xg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.test_case_id,"onUpdate:modelValue":d[68]||(d[68]=m=>t.data.functions[0].options.test_case_id=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1})],64)):B("",!0),t.data.dataItem.fun_name=="unit_test_add"?(y(),z(be,{key:3},[h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[199]||(d[199]=G(" unit_cate_id参数")),s("span",bg,oe(t.data.functions[0].options.unit_cate_id_desc),1)]),default:N(()=>[s("div",kg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.unit_cate_id,"onUpdate:modelValue":d[69]||(d[69]=m=>t.data.functions[0].options.unit_cate_id=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1}),h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[200]||(d[200]=G(" node_log_id参数")),s("span",Vg,oe(t.data.functions[0].options.node_log_id_desc),1)]),default:N(()=>[s("div",$g,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.node_log_id,"onUpdate:modelValue":d[70]||(d[70]=m=>t.data.functions[0].options.node_log_id=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1}),h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[201]||(d[201]=G(" test_note参数")),s("span",Eg,oe(t.data.functions[0].options.test_note_desc),1)]),default:N(()=>[s("div",Sg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.test_note,"onUpdate:modelValue":d[71]||(d[71]=m=>t.data.functions[0].options.test_note=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1})],64)):B("",!0),t.data.dataItem.fun_name=="knowledge_append"?(y(),z(be,{key:4},[h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[202]||(d[202]=G(" doucument_id参数")),s("span",Cg,oe(t.data.functions[0].options.doucument_id_desc),1)]),default:N(()=>[s("div",Ng,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.doucument_id,"onUpdate:modelValue":d[72]||(d[72]=m=>t.data.functions[0].options.doucument_id=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1}),h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[203]||(d[203]=G(" content参数")),s("span",zg,oe(t.data.functions[0].options.content_desc),1)]),default:N(()=>[s("div",Mg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.content,"onUpdate:modelValue":d[73]||(d[73]=m=>t.data.functions[0].options.content=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1})],64)):B("",!0),t.data.dataItem.fun_name=="printer_consumable_retrieve"?(y(),ie(he,{key:5,style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[204]||(d[204]=G(" model参数")),s("span",Ig,oe(t.data.functions[0].options.model_desc),1)]),default:N(()=>[s("div",Dg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.model,"onUpdate:modelValue":d[74]||(d[74]=m=>t.data.functions[0].options.model=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1})):t.data.dataItem.fun_name=="calculator"?(y(),ie(he,{key:6,style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[205]||(d[205]=G(" expression参数")),s("span",Tg,oe(t.data.functions[0].options.expression_desc),1)]),default:N(()=>[s("div",Ag,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.expression,"onUpdate:modelValue":d[75]||(d[75]=m=>t.data.functions[0].options.expression=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1})):t.data.dataItem.fun_name=="knowledge_retrieve"?(y(),z(be,{key:7},[h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[207]||(d[207]=G(" tags参数 ")),h(rt,{"popper-class":"c-flowtip",effect:"dark","raw-content":"",content:"填写要过滤的知识库标签<br />知识库的标签包含填写的标签或者知识库标签为空的会被匹配。没有填写标签则选择的库均被匹配",placement:"top"},{default:N(()=>d[206]||(d[206]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1})]),default:N(()=>[s("div",Pg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.tags,"onUpdate:modelValue":d[76]||(d[76]=m=>t.data.functions[0].options.tags=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1}),h(he,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[209]||(d[209]=G(" queries参数 ")),h(rt,{"popper-class":"c-flowtip",effect:"dark","raw-content":"",content:"填写要查询的问题，可以是数组形式<br />queries参数，每个query会在过滤后的库中筛选出topk条数据，合并后过滤评分。",placement:"top"},{default:N(()=>d[208]||(d[208]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1})]),default:N(()=>[s("div",Og,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.queries,"onUpdate:modelValue":d[77]||(d[77]=m=>t.data.functions[0].options.queries=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1})],64)):B("",!0),t.data.dataItem.fun_name=="vectorstore_retrieve"?(y(),ie(he,{key:8,style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[210]||(d[210]=G(" querys参数")),s("span",Ug,oe(t.data.functions[0].options.querys_desc),1)]),default:N(()=>[s("div",Bg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.querys,"onUpdate:modelValue":d[78]||(d[78]=m=>t.data.functions[0].options.querys=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1})):B("",!0),t.data.dataItem.fun_name=="product_retrieve"?(y(),ie(he,{key:9,style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[211]||(d[211]=G(" querys参数")),s("span",Rg,oe(t.data.functions[0].options.querys_desc),1)]),default:N(()=>[s("div",Hg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.querys,"onUpdate:modelValue":d[79]||(d[79]=m=>t.data.functions[0].options.querys=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1})):B("",!0),t.data.dataItem.fun_name=="vectorstore_retrieve"?(y(),ie(he,{key:10,style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[212]||(d[212]=G(" brands参数")),s("span",Lg,oe(t.data.functions[0].options.brands_desc),1)]),default:N(()=>[s("div",Fg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.brands,"onUpdate:modelValue":d[80]||(d[80]=m=>t.data.functions[0].options.brands=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1})):B("",!0),t.data.dataItem.fun_name=="product_retrieve"?(y(),ie(he,{key:11,style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[213]||(d[213]=G(" nc_ids参数")),s("span",qg,oe(t.data.functions[0].options.nc_ids_desc),1)]),default:N(()=>[s("div",Gg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.nc_ids,"onUpdate:modelValue":d[81]||(d[81]=m=>t.data.functions[0].options.nc_ids=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1})):B("",!0),t.data.functions[0].options.doc_knowledge_base_ids!==void 0?(y(),z("div",Yg,[d[215]||(d[215]=s("span",null,"请选择知识库",-1)),d[216]||(d[216]=G("   ")),h(rt,{"popper-class":"c-flowtip",effect:"dark","raw-content":"",content:"选择本工具使用哪些知识库",placement:"top"},{default:N(()=>d[214]||(d[214]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1})])):B("",!0),t.data.functions[0].options.doc_knowledge_base_ids!==void 0?(y(),ie(he,{key:13,style:{width:"100%","margin-right":"0"},label:"文档知识库"},{default:N(()=>[h(at,{modelValue:t.data.functions[0].options.doc_knowledge_base_ids,"onUpdate:modelValue":d[82]||(d[82]=m=>t.data.functions[0].options.doc_knowledge_base_ids=m),multiple:"","collapse-tags":"","max-collapse-tags":3,placeholder:"请选择知识库"},{default:N(()=>[(y(!0),z(be,null,Fe(e.textlist,m=>(y(),ie(Ye,{key:m.id,label:m.name,value:m.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):B("",!0),t.data.functions[0].options.doc_top_k!==void 0?(y(),ie(he,{key:14,style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[218]||(d[218]=G("召回数量 ")),h(rt,{"popper-class":"c-flowtip",effect:"dark","raw-content":"",content:"知识库向量查询召回的评分排名靠前的n条",placement:"top"},{default:N(()=>d[217]||(d[217]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1})]),default:N(()=>[h(yt,{onClick:d[83]||(d[83]=Se(()=>{},["stop","prevent"])),onMousedown:d[84]||(d[84]=Se(()=>{},["stop"])),style:{width:"382px","margin-right":"10px"},placeholder:"请填写文本召回文本数",modelValue:t.data.functions[0].options.doc_top_k,"onUpdate:modelValue":d[85]||(d[85]=m=>t.data.functions[0].options.doc_top_k=m),min:0,max:20,precision:0,step:1,"controls-position":"right"},null,8,["modelValue"]),je(s("span",Xg,"文本数太多，可能会影响大模型token数超出限制",512),[[Ke,t.data.functions[0].options.doc_top_k>5]])]),_:1})):B("",!0),t.data.functions[0].options.excel_knowledge_base_ids!==void 0?(y(),ie(he,{key:15,style:{width:"100%","margin-right":"0"},label:"EXCEL参数库"},{default:N(()=>[h(at,{modelValue:t.data.functions[0].options.excel_knowledge_base_ids,"onUpdate:modelValue":d[86]||(d[86]=m=>t.data.functions[0].options.excel_knowledge_base_ids=m),multiple:"","collapse-tags":"","max-collapse-tags":3,placeholder:"请选择EXCEL参数库"},{default:N(()=>[(y(!0),z(be,null,Fe(e.excellist,m=>(y(),ie(Ye,{key:m.id,label:m.name,value:m.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):B("",!0),t.data.functions[0].options.excel_top_k!==void 0?(y(),ie(he,{key:16,style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[220]||(d[220]=G("召回数量 ")),h(rt,{"popper-class":"c-flowtip",effect:"dark","raw-content":"",content:"知识库向量查询召回的评分排名靠前的n条",placement:"top"},{default:N(()=>d[219]||(d[219]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1})]),default:N(()=>[h(yt,{onClick:d[87]||(d[87]=Se(()=>{},["stop","prevent"])),onMousedown:d[88]||(d[88]=Se(()=>{},["stop"])),style:{width:"382px","margin-right":"10px"},placeholder:"请填写EXCEL参数库召回文本数",modelValue:t.data.functions[0].options.excel_top_k,"onUpdate:modelValue":d[89]||(d[89]=m=>t.data.functions[0].options.excel_top_k=m),min:0,max:20,precision:0,step:1,"controls-position":"right"},null,8,["modelValue"]),je(s("span",Zg,"文本数太多，可能会影响大模型token数超出限制",512),[[Ke,t.data.functions[0].options.excel_top_k>5]])]),_:1})):B("",!0),t.data.functions[0].options.top_k!==void 0?(y(),ie(he,{key:17,style:{width:"100%","margin-right":"0"},label:"召回文本数"},{default:N(()=>[h(yt,{onClick:d[90]||(d[90]=Se(()=>{},["stop","prevent"])),onMousedown:d[91]||(d[91]=Se(()=>{},["stop"])),style:{width:"382px","margin-right":"10px"},modelValue:t.data.functions[0].options.top_k,"onUpdate:modelValue":d[92]||(d[92]=m=>t.data.functions[0].options.top_k=m),placeholder:"请填写召回文本数",min:0,max:20,precision:0,step:1,"controls-position":"right"},null,8,["modelValue"]),je(s("span",jg,"文本数太多，可能会影响大模型token数超出限制",512),[[Ke,t.data.functions[0].options.top_k>5]])]),_:1})):B("",!0),t.data.functions[0].options.filter_value!==void 0?(y(),ie(he,{key:18,style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[222]||(d[222]=G("评分过滤 ")),h(rt,{"popper-class":"c-flowtip",effect:"dark","raw-content":"",content:"知识库向量查询分数的阈值，低于此分数的将不会召回",placement:"top"},{default:N(()=>d[221]||(d[221]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1})]),default:N(()=>[h(yn,{onClick:d[93]||(d[93]=Se(()=>{},["stop","prevent"])),onMousedown:d[94]||(d[94]=Se(()=>{},["stop"])),style:{width:"382px","margin-right":"3px"},modelValue:t.data.functions[0].options.filter_value,"onUpdate:modelValue":d[95]||(d[95]=m=>t.data.functions[0].options.filter_value=m),step:.05,min:0,max:1},null,8,["modelValue"]),je(s("span",Wg,"过滤分数过高，可能会影响召回文档数",512),[[Ke,t.data.functions[0].options.filter_value>.5]])]),_:1})):B("",!0),t.data.dataItem.fun_name=="knowledge_retrieve"?(y(),z("div",Kg,[d[224]||(d[224]=s("span",null,"唯一查询编码",-1)),d[225]||(d[225]=G("   ")),h(rt,{"popper-class":"c-flowtip",effect:"dark",content:`根据Excel文档的唯一编码查询，将会按照编码 和 元数据，召回跟编码匹配的所有文\r
档，过滤 taqs和 queries，只按照ids查询`,placement:"top"},{default:N(()=>d[223]||(d[223]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1})])):B("",!0),t.data.dataItem.fun_name=="knowledge_retrieve"?(y(),ie(he,{key:20,style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>[d[227]||(d[227]=G(" ids参数 ")),h(rt,{"popper-class":"c-flowtip",effect:"dark","raw-content":"",content:"数组形式，可以填写一个或多个，对应Excel模板里的 唯一编码",placement:"top"},{default:N(()=>d[226]||(d[226]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1})]),default:N(()=>[s("div",Jg,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:t.data.functions[0].options.ids,"onUpdate:modelValue":d[96]||(d[96]=m=>t.data.functions[0].options.ids=m)},null,8,["nodes","edges","nodeid","modelValue"])])]),_:1})):B("",!0),t.data.functions[0].options&&t.data.functions[0].options.metadata_filter!==void 0?(y(),z("div",Qg,[s("div",em,[s("span",{class:Me([{off:Q.value},"iconfont icon-xiajiantou pointer"]),onClick:d[97]||(d[97]=Se(m=>Q.value=!Q.value,["stop"]))},null,2),d[230]||(d[230]=G()),d[231]||(d[231]=s("span",{class:"iconfont icon-keyonggongju"},null,-1)),d[232]||(d[232]=G("元数据 ")),h(rt,{"popper-class":"c-flowtip",effect:"dark","raw-content":"",content:`与ids参数类似，可以过滤Excel的表头数\r
据据，具体说明参考官方文档`,placement:"top"},{default:N(()=>d[228]||(d[228]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1}),s("span",tm,[s("span",{class:"addvarbtn",onClick:d[98]||(d[98]=m=>t.data.functions[0].options.metadata_filter.push({id:Date.now(),key:"",operator:"=",value:"",desc:""}))},d[229]||(d[229]=[s("span",{class:"iconfont icon-liebiao-zengjia"},null,-1),G(" 添加条件")]))])]),je(s("div",nm,[s("div",om,[d[233]||(d[233]=s("div",{class:"item title"},[s("span",{style:{width:"25%"},class:"val"},"字段"),s("span",{style:{width:"25%"},class:"val"},"操作符"),s("span",{style:{width:"25%"},class:"val"},"值"),s("span",{style:{width:"25%"},class:"val"},"描述")],-1)),t.data.functions[0].options&&t.data.functions[0].options.metadata_filter.length>0?B("",!0):(y(),z("div",lm," 暂无数据 ")),t.data.functions[0].options&&t.data.functions[0].options.metadata_filter.length>0?(y(!0),z(be,{key:1},Fe(t.data.functions[0].options.metadata_filter,(m,Z)=>(y(),z("div",im,[s("div",sm,[h(Pe,{onClick:d[99]||(d[99]=Se(()=>{},["stop","prevent"])),onMousedown:d[100]||(d[100]=Se(()=>{},["stop"])),onBlur:X=>m.key?m.errtip="":m.errtip="字段不能为空",size:"small",placeholder:"",modelValue:m.key,"onUpdate:modelValue":X=>m.key=X},null,8,["onBlur","modelValue","onUpdate:modelValue"])]),s("div",am,[h(at,{size:"small",modelValue:m.operator,"onUpdate:modelValue":X=>m.operator=X,placeholder:"请选择"},{default:N(()=>[h(Ye,{value:"=",label:"="})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),s("div",dm,[h(Pe,{onClick:d[101]||(d[101]=Se(()=>{},["stop","prevent"])),onMousedown:d[102]||(d[102]=Se(()=>{},["stop"])),size:"small",placeholder:"",modelValue:m.value,"onUpdate:modelValue":X=>m.value=X},null,8,["modelValue","onUpdate:modelValue"])]),s("div",rm,[h(Pe,{onBlur:X=>m.desc?m.errtip="":m.errtip="描述不能为空",onClick:d[103]||(d[103]=Se(()=>{},["stop","prevent"])),onMousedown:d[104]||(d[104]=Se(()=>{},["stop"])),size:"small",placeholder:"",modelValue:m.desc,"onUpdate:modelValue":X=>m.desc=X},null,8,["onBlur","modelValue","onUpdate:modelValue"]),s("span",{title:"删除当前项",onClick:X=>{pe("确定要删除该数据吗？",()=>{t.data.functions[0].options.metadata_filter.splice(Z,1)})},class:"iconfont icon-liebiao-shanchu"},null,8,um)]),m.errtip?(y(),z("div",cm,oe(m.errtip),1)):B("",!0)]))),256)):B("",!0)])],512),[[Ke,Q.value]])])):B("",!0),t.data.functions[0].options.output_option!==void 0?(y(),ie(he,{key:22,style:{width:"100%","margin-right":"0"},label:"输出格式"},{default:N(()=>[h(lt,{modelValue:t.data.functions[0].options.output_option,"onUpdate:modelValue":d[105]||(d[105]=m=>t.data.functions[0].options.output_option=m)},{default:N(()=>[h(wt,{value:"json"},{default:N(()=>d[234]||(d[234]=[G("输出json格式内容")])),_:1}),h(wt,{value:"markdown"},{default:N(()=>d[235]||(d[235]=[G("输出markdown内容")])),_:1})]),_:1},8,["modelValue"])]),_:1})):B("",!0)]),_:1},8,["model"])])):(y(),z("div",{key:1,onWheel:d[107]||(d[107]=Se(()=>{},["stop"])),class:"itembox c-scroll-box"},[s("div",pm,[s("div",fm,[h(Ht,{style:{width:"100%"},ref:"formflowRef",model:Ve.value,"label-width":"auto",class:"demo-dynamic"},{default:N(()=>[Ve.value.inputs?(y(!0),z(be,{key:0},Fe(Ve.value.inputs,(m,Z)=>(y(),ie(he,{style:{width:"100%","margin-right":"0"},key:m.key,label:"",prop:"inputs["+Z+"].curvalue"},{default:N(()=>[s("div",vm,[s("span",gm,oe(m.name),1),m.is_required?(y(),z("span",mm,"*")):B("",!0),m.caption?(y(),z("span",{key:1,class:"desc ellipsis",title:m.caption},oe(m.caption),9,hm)):(y(),z("span",{key:2,class:"desc ellipsis",title:m.desc},oe(m.desc),9,ym)),s("span",_m,oe(m.data_type),1)]),m.name=="user_input"?(y(),z("div",{key:0,style:it("height: 240px; width: 100%;z-index: "+(1e3-Z))},[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:m.curvalue,"onUpdate:modelValue":X=>m.curvalue=X},null,8,["nodes","edges","nodeid","modelValue","onUpdate:modelValue"])],4)):(y(),z("div",{key:1,style:it("height: 60px; width: 100%;z-index: "+(1e3-Z))},[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,modelValue:m.curvalue,"onUpdate:modelValue":X=>m.curvalue=X},null,8,["nodes","edges","nodeid","modelValue","onUpdate:modelValue"])],4))]),_:2},1032,["prop"]))),128)):B("",!0),t.data.functions[0].options.output_option!==void 0?(y(),ie(he,{key:1,label:"输出格式"},{default:N(()=>[h(lt,{modelValue:t.data.functions[0].options.output_option,"onUpdate:modelValue":d[106]||(d[106]=m=>t.data.functions[0].options.output_option=m)},{default:N(()=>[h(wt,{value:"json"},{default:N(()=>d[236]||(d[236]=[G("输出json格式内容")])),_:1}),h(wt,{value:"markdown"},{default:N(()=>d[237]||(d[237]=[G("输出markdown内容")])),_:1})]),_:1},8,["modelValue"])]),_:1})):B("",!0)]),_:1},8,["model"])])])],32))],512),[[Ke,ve.value]])])):B("",!0),t.data.isHideChild?B("",!0):(y(),z("div",wm,[s("div",xm,[s("span",{class:Me([{off:le.value},"iconfont icon-xiajiantou pointer"]),onClick:d[108]||(d[108]=Se(m=>le.value=!le.value,["stop"]))},null,2),d[242]||(d[242]=s("span",{class:"iconfont icon-xiayoujiaose"},null,-1)),d[243]||(d[243]=G(" 下游角色")),h(rt,{"popper-class":"c-flowtip",class:"item",effect:"dark",content:"本节点的下游节点，当有多个下游，且开启自动选择时，大模型会根据任务情况自动选择（可以选择多个）",placement:"top"},{default:N(()=>d[238]||(d[238]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1}),s("span",{class:Me(["c-pointer inpopenbox",{on:Ne.value}]),onClick:d[109]||(d[109]=m=>Ne.value=!Ne.value)},[d[239]||(d[239]=s("span",{class:"iconfont icon-anniu-zhankai"},null,-1)),G(" "+oe(Ne.value?"收起":"展开"),1)],2),t.data.auto_choice_node!==void 0?(y(),z("div",bm,[d[241]||(d[241]=s("span",{class:"rborder"},"自动选择",-1)),h(rt,{"popper-class":"c-flowtip",effect:"dark",content:"开启后，大模型根据任务情况选择分支，关闭后，所有分支都会被执行",placement:"top"},{default:N(()=>d[240]||(d[240]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1}),h(Rt,{style:{"margin-left":"5px"},onChange:d[110]||(d[110]=m=>{ne(m,"auto_choice_node")}),modelValue:t.data.auto_choice_node,"onUpdate:modelValue":d[111]||(d[111]=m=>t.data.auto_choice_node=m)},null,8,["modelValue"])])):B("",!0)]),je(s("div",km,[t.data.auto_choice_node&&Ne.value?(y(),z("div",Vm,[s("div",$m,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,ref_key:"choiceroleprompt",ref:p,modelValue:t.data.choice_role_prompt,"onUpdate:modelValue":d[112]||(d[112]=m=>t.data.choice_role_prompt=m)},null,8,["nodes","edges","nodeid","modelValue"])]),s("div",{onClick:d[113]||(d[113]=m=>p.value.setValue(Y(o).getters.ComValueMap.choice_role_prompt)),class:"btn-update c-pointer"},d[244]||(d[244]=[s("span",{title:"恢复默认值",class:"iconfont icon-huifumorenzhi c-pointer"},null,-1),G(" 重置 ")]))])):B("",!0),s("div",Em,[d[245]||(d[245]=s("div",{style:{"margin-bottom":"10px",color:"#333"},class:"citem"},[s("span",{class:"label"},"角色名"),s("span",{class:"val"},"最大运行次数")],-1)),t.data.next_nodes&&t.data.next_nodes.length>0?B("",!0):(y(),z("div",Sm," 暂无下游角色 ")),t.data.next_nodes&&t.data.next_nodes.length>0?(y(!0),z(be,{key:1},Fe(t.data.next_nodes,m=>(y(),z("div",Cm,[s("div",Nm,[h(Pe,{value:m.role,disabled:"",type:"text"},null,8,["value"])]),s("div",{onClick:d[114]||(d[114]=Se(()=>{},["stop","prevent"])),onMousedown:d[115]||(d[115]=Se(()=>{},["stop"])),class:"val"},[h(yt,{style:{width:"100%"},modelValue:m.max_run_times,"onUpdate:modelValue":Z=>m.max_run_times=Z,min:1,max:1e3,controls:!0},null,8,["modelValue","onUpdate:modelValue"])],32)]))),256)):B("",!0)])],512),[[Ke,le.value]])])),t.data.outputs!==void 0?(y(),z(be,{key:10},[t.data.type!=="start"?(y(),z("div",zm,[s("div",Mm,[s("span",{class:Me([{off:O.value},"iconfont icon-xiajiantou pointer"]),onClick:d[116]||(d[116]=Se(m=>O.value=!O.value,["stop"]))},null,2),d[249]||(d[249]=G()),d[250]||(d[250]=s("span",{class:"iconfont icon-bianliangcunchu"},null,-1)),d[251]||(d[251]=G(" 变量存储")),h(rt,{"popper-class":"c-flowtip",class:"item",effect:"dark",content:"使用大模型提取文本的能力，进行各种变量的存储，可以存储到自身，或者工作空间",placement:"top"},{default:N(()=>d[246]||(d[246]=[s("span",{class:"iconfont icon-bangzhu"},null,-1)])),_:1}),s("span",{class:Me(["c-pointer inpopenbox",{on:De.value}]),onClick:d[117]||(d[117]=m=>De.value=!De.value)},[d[247]||(d[247]=s("span",{class:"iconfont icon-anniu-zhankai"},null,-1)),G(" "+oe(De.value?"收起":"展开"),1)],2),s("span",Im,[s("span",{class:"addvarbtn",onClick:d[118]||(d[118]=m=>I(0))},d[248]||(d[248]=[s("span",{class:"iconfont icon-liebiao-zengjia"},null,-1),G(" 新增变量")]))])])])):B("",!0),je(s("div",Dm,[s("div",Tm,[h(ye,{nodes:e.nodes,edges:e.edges,nodeid:e.id,ref_key:"outputvarprompt",ref:$,modelValue:t.data.output_var_prompt,"onUpdate:modelValue":d[119]||(d[119]=m=>t.data.output_var_prompt=m)},null,8,["nodes","edges","nodeid","modelValue"])]),s("div",{onClick:d[120]||(d[120]=m=>$.value.setValue(Y(o).getters.ComValueMap.output_var_prompt)),class:"btn-update c-pointer"},d[252]||(d[252]=[s("span",{title:"恢复默认值",class:"iconfont icon-huifumorenzhi c-pointer"},null,-1),G(" 重置 ")]))],512),[[Ke,O.value&&De.value]]),je(s("div",Am,[d[253]||(d[253]=s("div",{class:"item title"},[s("div",{class:"intro"},"存储位置"),s("div",{class:"key"},"变量名"),s("div",{class:"type"},"变量类型"),s("div",{class:"intro1"},"描述"),s("div",{class:"opt"})],-1)),t.data.outputs&&t.data.outputs.length<1?(y(),z("div",Pm," 暂无变量 ")):B("",!0),t.data.outputs&&t.data.outputs.length>0?(y(),ie(Fn,{key:1,style:{width:"100%"},data:t.data.outputs,"node-key":"id","default-expand-all":"","empty-text":" ","expand-on-click-node":!1},{default:N(({node:m,data:Z})=>[s("div",Om,[s("div",Um,[je(h(at,{size:"small",disabled:m.level>1,onChange:X=>{te(Z,X)},modelValue:Z.prefix,"onUpdate:modelValue":X=>Z.prefix=X,placeholder:"存储位置"},{default:N(()=>[h(Ye,{value:"space",label:"工作空间"}),h(Ye,{value:"role",label:"角色自身"})]),_:2},1032,["disabled","onChange","modelValue","onUpdate:modelValue"]),[[Ke,m.level<=1]])]),s("div",{class:"key",onClick:d[121]||(d[121]=Se(()=>{},["stop","prevent"])),onMousedown:d[122]||(d[122]=Se(()=>{},["stop"])),style:it("margin-right:-"+18*(m.level-1)+"px")},[Z.prefix!="space"?(y(),ie(Pe,{key:0,onBlur:X=>k(Z,m),placeholder:"输入变量名",size:"small",modelValue:Z.name,"onUpdate:modelValue":X=>Z.name=X,style:it("width:"+(160-18*m.level)+"px")},null,8,["onBlur","modelValue","onUpdate:modelValue","style"])):B("",!0),Z.prefix=="space"?(y(),ie(at,{key:1,style:it("width:"+(160-18*m.level)+"px"),size:"small",modelValue:Z.space_vars_id,"onUpdate:modelValue":X=>Z.space_vars_id=X,onChange:X=>{j(Z,X),k(Z,m)},placeholder:"选择工作空间变量"},{default:N(()=>[(y(!0),z(be,null,Fe(t.space_vars,(X,ln)=>(y(),ie(Ye,{disabled:M(t.data.outputs,X.id)&&Z.space_vars_id!=X.id,value:X.id,label:X.name},null,8,["disabled","value","label"]))),256))]),_:2},1032,["style","modelValue","onUpdate:modelValue","onChange"])):B("",!0)],36),s("div",Bm,[h(at,{size:"small",disabled:Z.prefix=="space",modelValue:Z.data_type,"onUpdate:modelValue":X=>Z.data_type=X,onChange:X=>{b(Z,X)},placeholder:"选择类型"},{default:N(()=>[(y(!0),z(be,null,Fe(Y(o).getters.keyTypes,(X,ln)=>(y(),ie(Ye,{value:ln,label:X,disabled:F(m,X)},null,8,["value","label","disabled"]))),256))]),_:2},1032,["disabled","modelValue","onUpdate:modelValue","onChange"])]),s("div",{onClick:d[123]||(d[123]=Se(()=>{},["stop","prevent"])),onMousedown:d[124]||(d[124]=Se(()=>{},["stop"])),class:"intro1"},[h(Pe,{size:"small",modelValue:Z.desc,"onUpdate:modelValue":X=>Z.desc=X,placeholder:"请描述变量的用途"},null,8,["modelValue","onUpdate:modelValue"])],32),s("div",Rm,[s("div",Hm,[je(s("span",{title:"新增子项",onClick:X=>I(m.level,Z),class:"iconfont icon-shuzhuang-tianjia"},null,8,Lm),[[Ke,m.level<4&&(Z.data_type=="Object"||Z.data_type=="Array<Object>")]])]),s("div",Fm,[s("span",{title:"删除当前项",onClick:X=>R(m,Z,"output"),class:"iconfont icon-liebiao-shanchu"},null,8,qm)])]),Z.errtip?(y(),z("div",Gm,oe(Z.errtip),1)):B("",!0)])]),_:1},8,["data"])):B("",!0)],512),[[Ke,O.value]])],64)):B("",!0)])]),_:1},8,["data-id","model"]))],6),t.data.type!="start"&&t.data.type!="work_space"&&t.data.type!="loop_start"?(y(),ie(Y(en),{key:1,id:"target_1",type:"target",class:"c-handle c-handletarget",position:Y($e).Left},null,8,["position"])):B("",!0),Y(Te).parentNode&&Y(Te).data.type!="loop_end"?(y(),ie(Ln,{key:2,ref_key:"popover",ref:Ce,visible:ue.value,placement:"right",width:400},{reference:N(()=>[t.data.type!="end"&&t.data.type!="work_space"&&t.data.type!="loop_end"?(y(),ie(Y(en),{key:0,onMouseup:d[126]||(d[126]=m=>ue.value=!ue.value),id:"source_1",type:"source",class:Me([{on:ue.value},"c-handle c-handlesource addbtn"]),position:Y($e).Right},null,8,["class","position"])):B("",!0)]),default:N(()=>[s("div",Ym,[h(Pe,{type:"text",clearable:"",size:"small",modelValue:Je.value,"onUpdate:modelValue":d[127]||(d[127]=m=>Je.value=m),placeholder:"搜索"},null,8,["modelValue"]),h(qn,null,{default:N(()=>[(y(!0),z(be,null,Fe(Re.value.filter(m=>m.datatype=="llm"),(m,Z)=>(y(),z("div",{key:Z,onClick:X=>V(X,m,Z),class:"item c-shadow"},[s("div",{title:m.role,class:"c-icons ellipsis"},[s("span",{class:Me("iconfont "+m.icon)},null,2),s("div",jm,oe(m.role),1)],8,Zm)],8,Xm))),128)),d[254]||(d[254]=s("div",{class:"navlisttitle"},"工具",-1)),(y(!0),z(be,null,Fe(Re.value.filter(m=>m.datatype=="tool"),(m,Z)=>(y(),z("div",{key:Z,onClick:X=>V(X,m,Z),class:"item c-shadow"},[s("div",{title:m.role,class:"c-icons ellipsis"},[s("span",{class:Me("iconfont "+m.icon)},null,2),s("div",Jm,oe(m.role),1)],8,Km)],8,Wm))),128)),d[255]||(d[255]=s("div",{class:"navlisttitle"},"工作流工具",-1)),(y(!0),z(be,null,Fe(Re.value.filter(m=>m.datatype=="flow"),(m,Z)=>(y(),z("div",{key:Z,onClick:X=>V(X,m,Z),class:"item c-shadow"},[s("div",{title:m.role,class:"c-icons ellipsis"},[s("span",{class:Me("iconfont "+m.icon)},null,2),s("div",th,oe(m.role),1)],8,eh)],8,Qm))),128)),d[256]||(d[256]=s("div",{class:"navlisttitle"},"工具插件",-1)),(y(!0),z(be,null,Fe(Re.value.filter(m=>m.datatype=="plugin"),(m,Z)=>(y(),z("div",{key:Z,onClick:X=>V(X,m,Z),class:"item c-shadow"},[s("div",{title:m.role,class:"c-icons ellipsis"},[s("span",{class:Me("iconfont "+m.icon)},null,2),s("div",lh,oe(m.role),1)],8,oh)],8,nh))),128)),d[257]||(d[257]=s("div",{class:"navlisttitle"},"MCP工具",-1)),(y(!0),z(be,null,Fe(Re.value.filter(m=>m.datatype=="mcp"),(m,Z)=>(y(),z("div",{key:Z,onClick:X=>V(X,m,Z),class:"item c-shadow"},[s("div",{title:m.role,class:"c-icons ellipsis"},[s("span",{class:Me("iconfont "+m.icon)},null,2),s("div",ah,oe(m.role),1)],8,sh)],8,ih))),128))]),_:1})])]),_:1},8,["visible"])):(y(),z(be,{key:3},[t.data.type!="end"&&t.data.type!="work_space"&&t.data.type!="loop_end"?(y(),ie(Y(en),{key:0,id:"source_1",type:"source",class:"c-handle c-handlesource",position:Y($e).Right},null,8,["position"])):B("",!0)],64))],64)}}},rh=Mi(dh,[["__scopeId","data-v-0133d4be"]]),uh={inheritAttrs:!1},ch=Object.assign(uh,{__name:"EdgeWithButton",props:{id:{type:String,required:!0},sourceX:{type:Number,required:!0},sourceY:{type:Number,required:!0},targetX:{type:Number,required:!0},targetY:{type:Number,required:!0},sourcePosition:{type:String,required:!0},targetPosition:{type:String,required:!0},markerEnd:{type:String,required:!1},style:{type:Object,required:!1}},setup(e){const n=e,{removeEdges:t,onEdgeMouseEnter:o,onEdgeMouseMove:l,onEdgeMouseLeave:a}=tt();q(null),o(_=>{f(_.edge.id)});let r={};a(_=>{u(_.edge.id)}),l(_=>{});const u=_=>{clearTimeout(r[_]),r[_]=setTimeout(()=>{let x=document.querySelector(".id-"+_);x&&(x.style.display="none",document.querySelector(".icon-"+_).style.zIndex="110")},1e3)},f=(_,x)=>{clearTimeout(r[_]),setTimeout(()=>{let P=document.querySelector(".id-"+_);P&&(P.style.display="block",document.querySelector(".icon-"+_).style.zIndex="1111")},x||0)},v=Oe(()=>kl(n)),g=async _=>{await _this.$confirm("确定删除该链接？")&&t(_)};return(_,x)=>(y(),z(be,null,[h(Y(Hn),{class:"c-edge",id:e.id,style:it(e.style),path:v.value[0],"marker-end":e.markerEnd},null,8,["id","style","path","marker-end"]),h(Y(Ef),null,{default:N(()=>[s("div",{style:it({pointerEvents:"all",position:"absolute",transform:`translate(-50%, -50%) translate(${v.value[1]}px,${v.value[2]}px)`}),class:Me("nodrag nopan icon-"+e.id)},[s("span",{title:"删除链接",onMouseenter:x[0]||(x[0]=C=>f(e.id,1e3)),onMouseleave:x[1]||(x[1]=C=>u(e.id)),class:Me("icon-del iconfont icon-cuowuguanbiquxiao-xianxingyuankuang id-"+e.id),onClick:x[2]||(x[2]=C=>g(e.id))},null,34)],6)]),_:1})],64))}});var Nt=(e=>(e.Lines="lines",e.Dots="dots",e))(Nt||{});const Us=function({dimensions:e,size:n,color:t}){return et("path",{stroke:t,"stroke-width":n,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`})},Bs=function({radius:e,color:n}){return et("circle",{cx:e,cy:e,r:e,fill:n})};Nt.Lines+"",Nt.Dots+"";const ph={[Nt.Dots]:"#81818a",[Nt.Lines]:"#eee"},fh=["id","x","y","width","height","patternTransform"],vh={key:2,height:"100",width:"100"},gh=["fill"],mh=["x","y","fill"],hh={name:"Background",compatConfig:{MODE:3}},yh=st({...hh,props:{id:{},variant:{default:()=>Nt.Dots},gap:{default:20},size:{default:1},lineWidth:{default:1},patternColor:{},color:{},bgColor:{},height:{default:100},width:{default:100},x:{default:0},y:{default:0},offset:{default:2}},setup(e){const{id:n,viewport:t}=tt(),o=Oe(()=>{const[r,u]=Array.isArray(e.gap)?e.gap:[e.gap,e.gap],f=[r*t.value.zoom||1,u*t.value.zoom||1],v=e.size*t.value.zoom,g=e.variant===Nt.Dots?[v/e.offset,v/e.offset]:[f[0]/e.offset,f[1]/e.offset];return{scaledGap:f,offset:g,size:v}}),l=ot(()=>`pattern-${n}${e.id?`-${e.id}`:""}`),a=ot(()=>e.color||e.patternColor||ph[e.variant||Nt.Dots]);return(r,u)=>(y(),z("svg",{class:"vue-flow__background vue-flow__container",style:it({height:`${r.height>100?100:r.height}%`,width:`${r.width>100?100:r.width}%`})},[dt(r.$slots,"pattern-container",{id:l.value},()=>[s("pattern",{id:l.value,x:Y(t).x%o.value.scaledGap[0],y:Y(t).y%o.value.scaledGap[1],width:o.value.scaledGap[0],height:o.value.scaledGap[1],patternTransform:`translate(-${o.value.offset[0]},-${o.value.offset[1]})`,patternUnits:"userSpaceOnUse"},[dt(r.$slots,"pattern",{},()=>[r.variant===Y(Nt).Lines?(y(),ie(Y(Us),{key:0,size:r.lineWidth,color:a.value,dimensions:o.value.scaledGap},null,8,["size","color","dimensions"])):r.variant===Y(Nt).Dots?(y(),ie(Y(Bs),{key:1,color:a.value,radius:o.value.size/r.offset},null,8,["color","radius"])):B("",!0),r.bgColor?(y(),z("svg",vh,[s("rect",{width:"100%",height:"100%",fill:r.bgColor},null,8,gh)])):B("",!0)])],8,fh)]),s("rect",{x:r.x,y:r.y,width:"100%",height:"100%",fill:`url(#${l.value})`},null,8,mh),dt(r.$slots,"default",{id:l.value})],4))}}),_h={class:"topbox"},wh={class:"selectbox"},xh={key:0,class:"title"},bh={class:"btnbox"},kh={class:"title"},Vh={class:"navbody"},$h=["onClick","onDragstart"],Eh=["title"],Sh={class:"ellipsis"},Ch={class:"navlisttitle"},Nh=["onClick","onDragstart"],zh=["title"],Mh={class:"ellipsis"},Ih={class:"navlisttitle"},Dh=["onClick","onDragstart"],Th=["title"],Ah={class:"ellipsis"},Ph={class:"navlisttitle"},Oh=["onClick","onDragstart"],Uh=["title"],Bh={class:"ellipsis"},Rh={class:"navlisttitle"},Hh=["onClick","onDragstart"],Lh=["title"],Fh={class:"ellipsis"},qh={style:{margin:"0 4px 10px 4px","text-align":"left"},class:"filterfuncTextbox"},Gh={class:"utlidialog"},Yh={style:{margin:"0 20px"}},Xh={key:0,class:"itembox utilbox"},Zh=["onClick"],jh={class:"name"},Wh={class:"desc"},Kh={key:0,class:"iconfont icon-xuanzhong"},Jh={key:0,class:"c-empty"},Qh=["onClick"],e0={class:"name"},t0={class:"desc"},n0={key:0,class:"iconfont icon-xuanzhong"},o0={key:1,class:"c-empty"},l0=["onClick"],i0={class:"name"},s0={class:"desc"},a0={key:0,class:"iconfont icon-xuanzhong"},d0={key:2,class:"c-empty"},r0=["onClick"],u0={class:"name"},c0={class:"desc"},p0={key:0,class:"iconfont icon-xuanzhong"},f0={key:1,class:"itembox product_searchbox"},v0={key:0,class:"c-cardspacebox"},g0={class:"citem"},m0={class:"valuebox",style:{width:"100%"}},h0={class:"citem"},y0={style:"height: 60px; width: 100%;z-index: 17"},_0={class:"c-cardspacebox"},w0={class:"citem"},x0={class:"valuebox",style:{width:"100%"}},b0={class:"citem"},k0={style:"height: 60px; width: 100%;z-index: 50"},V0={class:"c-cardspacebox"},$0={class:"citem"},E0={class:"valuebox",style:{width:"100%"}},S0={class:"citem"},C0={style:"height: 60px; width: 100%;z-index: 49"},N0={class:"c-cardspacebox"},z0={class:"citem"},M0={class:"valuebox",style:{width:"100%"}},I0={class:"citem"},D0={style:"height: 60px; width: 100%;z-index: 48"},T0={class:"c-cardspacebox"},A0={class:"citem"},P0={class:"valuebox",style:{width:"100%"}},O0={class:"citem"},U0={style:"height: 60px; width: 100%;z-index: 47"},B0={class:"c-cardspacebox"},R0={class:"citem"},H0={class:"valuebox",style:{width:"100%"}},L0={class:"citem"},F0={style:"height: 60px; width: 100%;z-index: 50"},q0={class:"c-cardspacebox"},G0={class:"citem"},Y0={class:"valuebox",style:{width:"100%"}},X0={class:"citem"},Z0={style:"height: 60px; width: 100%;z-index: 49"},j0={class:"c-cardspacebox"},W0={class:"citem"},K0={class:"valuebox",style:{width:"100%"}},J0={class:"citem"},Q0={style:"height: 60px; width: 100%;z-index: 48"},ey={class:"c-cardspacebox"},ty={class:"citem"},ny={class:"valuebox",style:{width:"100%"}},oy={class:"citem"},ly={style:"height: 60px; width: 100%;z-index: 47"},iy={class:"c-cardspacebox"},sy={class:"citem"},ay={class:"valuebox",style:{width:"100%"}},dy={class:"citem"},ry={style:"height: 60px; width: 100%;z-index: 36"},uy={class:"c-cardspacebox"},cy={class:"citem"},py={class:"valuebox",style:{width:"100%"}},fy={class:"citem"},vy={style:"height: 60px; width: 100%;z-index: 40"},gy={class:"c-cardspacebox"},my={class:"citem"},hy={class:"valuebox",style:{width:"100%"}},yy={class:"citem"},_y={style:"height: 60px; width: 100%;z-index: 39"},wy={class:"c-cardspacebox"},xy={class:"citem"},by={class:"valuebox",style:{width:"100%"}},ky={class:"citem"},Vy={style:"height: 60px; width: 100%;z-index: 38"},$y={class:"c-cardspacebox"},Ey={class:"citem"},Sy={class:"valuebox",style:{width:"100%"}},Cy={class:"citem"},Ny={style:"height: 60px; width: 100%;z-index: 37"},zy={class:"c-cardspacebox"},My={class:"citem"},Iy={class:"valuebox",style:{width:"100%"}},Dy={class:"citem"},Ty={style:"height: 60px; width: 100%;z-index: 36"},Ay={class:"c-cardspacebox"},Py={class:"citem"},Oy={class:"valuebox",style:{width:"100%"}},Uy={class:"citem"},By={style:"height: 60px; width: 100%;z-index: 35"},Ry={class:"c-cardspacebox"},Hy={class:"citem"},Ly={class:"valuebox",style:{width:"100%"}},Fy={class:"citem"},qy={style:"height: 60px; width: 100%;z-index: 30"},Gy={class:"c-cardspacebox"},Yy={class:"citem"},Xy={class:"valuebox",style:{width:"100%"}},Zy={class:"citem"},jy={style:"height: 60px; width: 100%;z-index: 29"},Wy={class:"c-cardspacebox"},Ky={class:"citem"},Jy={class:"valuebox",style:{width:"100%"}},Qy={class:"citem"},e_={style:"height: 60px; width: 100%;z-index: 29"},t_={class:"c-cardspacebox"},n_={class:"citem"},o_={class:"valuebox",style:{width:"100%"}},l_={class:"citem"},i_={style:"height: 60px; width: 100%;z-index: 20"},s_={class:"c-cardspacebox"},a_={class:"citem"},d_={class:"valuebox",style:{width:"100%"}},r_={class:"citem"},u_={style:"height: 60px; width: 100%;z-index: 20"},c_={key:6,class:"c-cardspacebox"},p_={class:"citem"},f_={class:"valuebox",style:{width:"100%"}},v_={class:"citem"},g_={style:"height: 60px; width: 100%;z-index: 16"},m_={class:"c-cardspacebox"},h_={class:"citem"},y_={class:"valuebox",style:{width:"100%"}},__={class:"citem"},w_={style:"height: 60px; width: 100%;z-index: 15"},x_={class:"c-cardspacebox"},b_={class:"citem"},k_={class:"valuebox",style:{width:"100%"}},V_={class:"citem"},$_={style:"height: 60px; width: 100%;z-index: 14"},E_={class:"c-cardspacebox"},S_={class:"citem"},C_={class:"valuebox",style:{width:"100%"}},N_={class:"citem"},z_={style:"height: 60px; width: 100%;z-index: 15"},M_={class:"c-cardspacebox"},I_={class:"citem"},D_={class:"valuebox",style:{width:"100%"}},T_={class:"citem"},A_={style:"height: 60px; width: 100%;z-index: 14"},P_={class:"c-cardspacebox"},O_={class:"citem"},U_={class:"valuebox",style:{width:"100%"}},B_={class:"citem"},R_={style:"height: 60px; width: 100%;z-index: 13"},H_={class:"c-cardspacebox"},L_={class:"citem"},F_={class:"valuebox",style:{width:"100%"}},q_={class:"citem"},G_={style:"height: 60px; width: 100%;z-index: 12"},Y_={class:"c-cardspacebox"},X_={class:"citem"},Z_={class:"valuebox",style:{width:"100%"}},j_={class:"citem"},W_={style:"height: 60px; width: 100%;z-index: 11"},K_={class:"c-danger"},J_={class:"c-danger"},Q_={class:"c-danger"},ew={key:15,class:"cardbox"},tw={style:{"margin-bottom":"16px"},class:"itembox"},nw={class:"ltitle"},ow={class:"fr"},lw={class:"itemcontain"},iw={class:"childbox varbox"},sw={key:0,class:"c-emptybox"},aw={class:"item"},dw={style:{width:"25%"},class:"val"},rw={style:{width:"25%"},class:"val"},uw={style:{width:"25%"},class:"val"},cw={style:{width:"25%"},class:"val"},pw=["onClick"],fw={key:0,style:{width:"100%"},class:"errtip"},vw={class:"c-danger"},gw={key:2,class:"itembox flowbox"},mw={class:"c-cardspacebox"},hw={class:"ctitle"},yw={key:0,class:"require"},_w={class:"type"},ww={class:"citem"},xw={class:"citem"},bw={key:3,class:"itembox flowbox"},kw={class:"testbox"},Vw={class:"testbody"},$w={class:"c-cardspacebox"},Ew={class:"ctitle"},Sw={key:0,class:"require"},Cw={class:"type"},Nw={class:"citem"},zw={class:"citem"},Mw={class:"dialog-footer"},Iw={style:{margin:"0 -16px",height:"100%"}},Dw={key:0,class:"sharebg"},Tw={key:1,class:"sharepage c-sharepage"},Aw={class:"meslist"},Pw={class:"mes"},Ow=["onClick"],Uw={key:0,class:"item loadingbox"},Bw={class:"load"},Rw={class:"testbox"},Hw={class:"testbody"},Lw={class:"c-cardspacebox"},Fw={class:"ctitle"},qw={key:0,class:"require"},Gw={class:"type"},Yw=["title"],Xw={class:"citem"},Zw={class:"el-upload__tip c-tips"},jw={class:"dialog-footer"},Ww={__name:"flow",setup(e){const n=ga(),t=ma(),o=Ii(),l=q(null),a=q(""),r=()=>{a.value=Aa();let S=window.location.host||"193.111.99.208";S=="localhost:5173"&&(S="193.111.99.208");let i="ws://"+S+"/ws/"+a.value+"/workflow";if(l.value)return!1;l.value=new WebSocket(i),l.value.onopen=H=>{},l.value.onmessage=H=>{var L=JSON.parse(H.data);if(L.type=="error")return _this.$message(L.data.message,"error"),u.value=!1,X.value=!1,!1;L.type=="ai_answer"&&(console.log("收到AI消息开始：============================================================="),console.log(L.data.message),console.log("收到AI消息结束：============================================================="),Do.value.push({type:1,mes:L.data.message})),L.type=="ai_finish"&&(u.value=!1,X.value=!1)},l.value.onclose=H=>{setTimeout(r,1e3)},l.value.onerror=H=>{l.value&&l.value.close(),l.value=null}},u=q(!1),f=S=>{u.value=!0,X.value=!0,l.value&&l.value.send(JSON.stringify(S))};Et(()=>{n.path=="/flowshare"&&r()}),cl(()=>{l.value&&l.value.close(),l.value=null});const{addNodes:v,addEdges:g,screenToFlowCoordinate:_,onNodesInitialized:x,onNodeDragStop:C,onNodesChange:P,onEdgesChange:T,applyEdgeChanges:I,applyNodeChanges:A,updateNode:R,onConnect:k,findNode:D,fitView:K,ZoomTo:ge,onPaneClick:ae,onPaneMouseMove:de,onMoveEnd:ve,GetViewport:Q}=tt(),{onDragOver:le,onDrop:O,onDragLeave:Ee}=ul(),{onDragStart:E,initNode:F}=ul(),b=q([{id:100000000001,type:"card",data:{width:"620px",id:100000000001,type:"start",role:"开始",icon:"icon-kaishi1",isopen:!0,isHideChild:!0,next_nodes:void 0,hidebtn:!0,description:"流程起点",inputs:[{id:Date.now(),name:"user_input",data_type:"String",desc:"用户本轮对话输入内容",is_required:!0,disabled:!0}]},position:{x:600,y:300}},{id:1e11,type:"card",data:{width:"400px",id:1e11,type:"work_space",role:"工作空间变量",icon:"icon-gongzuokongjianbianliang",isopen:!0,space_vars:[],isHideChild:!0,next_nodes:void 0,hidebtn:!0,outputs:void 0,description:void 0,prompt_template:void 0,functions:void 0},position:{x:100,y:300}}]),U=q([]),j=q([{id:1,type:"llm",datatype:"llm",role:"大模型",icon:"icon-damoxing",isopen:!0,next_nodes:[],description:"",prompt_template:"",react_part_prompt:o.getters.ComValueMap.react_part_prompt,choice_role_prompt:o.getters.ComValueMap.choice_role_prompt,output_var_prompt:o.getters.ComValueMap.output_var_prompt,auto_section_run:!1,use_vt:!1,vt_file:"",llm_id:"",functions:[],outputs:[],react:!1,react_max_times:10,auto_choice_node:!1},{id:2,type:"temp_executor",datatype:"llm",role:"执行器",icon:"icon-shuchu1",isopen:!0,next_nodes:[],description:"用于通过模板直接执行系统函数，可以通过jinja模板编写处理逻辑",prompt_template:"",choice_role_prompt:"",auto_section_run:!1,hidellm:!0,llm_id:""},{id:Date.now(),type:"loop",datatype:"llm",role:"分批处理",icon:"icon-pichuli",isopen:!0,next_nodes:[],max_workers:1,description:"分批处理",prompt_template:void 0,loop_traget:"",loop_size:"",choice_role_prompt:"",auto_section_run:!1,hidellm:!0,llm_id:""}]),te=q(!1),ne=q(null);if(n.query.id){let S=n.query.api_key||void 0;ha({id:n.query.id,api_key:S},n.path).then(i=>{if(ne.value=i,document.title=i.name,i.view_json){b.value=JSON.parse(i.view_json).nodes,b.value.forEach(L=>{L.data.type=="work_space"&&(To.value=L.data.space_vars)});let H=JSON.parse(i.view_json).edges;H.forEach(L=>{L.type!=="button"&&(L.type="button",L.animated=!0,L.markerEnd=Pn.Arrow)}),U.value=H,console.log(b.value,H)}n.path=="/flowshare"?Ht():pe()})}else Oo(null,t,"/flowlist");const pe=()=>{ya().then(async S=>{S.forEach(L=>{let me="";if(L.view_json){let W=JSON.parse(L.view_json);me=JSON.stringify(gt(W))}L.type="flow",$.value.push({...L,fun_name:"workflow_"+L.id,tool:"workflow_"+L.id,desc:L.caption,name:L.name,options:{workflow_id:L.id,inputs:me}})});let i=await _a({page:1,pagesize:1e4,is_enable:!0});i&&i.rows&&i.rows.length>0&&i.rows.forEach(L=>{L.type="plugin",L.datatype="plugin",L.in_params=L.in_params||[];let me=[];L.in_params.forEach(Xe=>{Xe.default_value||me.push(Xe)}),L.in_params=me;let W={};L.in_params.forEach(Xe=>{Xe.default_value||(W[Xe.name]="")}),$.value.push({...L,fun_name:L.func_name,tool:L.func_name,desc:L.caption,name:L.name,options:{inputs:JSON.stringify(W),output_option:"json"}})});let H=await wa();H&&H.rows&&H.rows.length>0&&H.rows.forEach(L=>{L.type="plugin",L.datatype="mcp",L.in_params=L.in_params||[];let me={};L.in_params.forEach(W=>{W.default_value||(me[W.name]="")}),$.value.push({...L,fun_name:L.func_name,tool:L.func_name,desc:L.caption,name:L.name,options:{inputs:JSON.stringify(me),output_option:"json"}})}),Ne(),te.value=!0,n.path=="/flowshare"&&Ht()})},Ve=S=>{ka({...ne.value,view_json:JSON.stringify({nodes:Dl(He.cloneDeep(b.value)),edges:Dl(He.cloneDeep(U.value))})}).then(i=>{S||_this.$message("保存成功"),S&&S()})},re=q(null),se=S=>{const i=new Set;function H(W){for(let Xe=0;Xe<b.value.length;Xe++)b.value[Xe].parentNode==W?H(b.value[Xe].id):b.value[Xe].id==W&&i.add(b.value[Xe].id)}H(S),b.value=b.value.filter(W=>!i.has(W.id));const L=new Set;function me(){for(let W=0;W<U.value.length;W++){let Xe=-1,Ze=-1,bt=U.value[W];if(b.value.forEach((kt,kn)=>{kt.id==bt.source&&(Xe=kn),kt.id==bt.target&&(Ze=kn)}),Ze===-1||Xe===-1){L.add(U.value[W].id);continue}}}me(),U.value=U.value.filter(W=>!L.has(W.id)),Ue()};let ke=null;C(S=>{if(!S.node.parentNode)return!1;clearTimeout(ke),ke=setTimeout(()=>{Ue()},70)});const Ue=()=>{b.value.forEach(S=>{S.data.type=="loop"&&Ae(S)})},Ae=S=>{let i=[];if(b.value.forEach(H=>{H.parentNode==S.id&&i.push(H)}),i.length>0){let H=Le(i),L=H.width<=1e3?1e3:H.width,me=H.height<=850?850:H.height;S.style.width=L+"px",S.style.height=me+"px",R(S.id,S,{replace:!0})}else S.style.width="1000px",S.style.height="850px",R(S.id,S,{replace:!0})};function Le(S){let i=1/0,H=1/0,L=-1/0,me=-1/0;return S.forEach(W=>{const{width:Xe,height:Ze}=W.dimensions,{x:bt,y:kt}=W.position;i=Math.min(i,bt),H=Math.min(H,kt),L=Math.max(L,bt+Xe),me=Math.max(me,kt+Ze)}),{width:L+40,height:me+40,x:i,y:H}}P(async S=>{const i=[];for(const H of S){if(H.type==="select"){let L=D(H.id);if(!L.isParent&&L.parentNode){let me=D(L.parentNode);H.selected?me.zIndex=10:me.zIndex=0,R(me.id,me,{replace:!0})}}H.type==="remove"?se(H.id):i.push(H)}A(i)}),T(async S=>{const i=[];for(const H of S)i.push(H);I(i)});const Ie=S=>{b.value.forEach(i=>{if(i.id===S){const H=F(He.cloneDeep(i.data),i.position,He.cloneDeep(i));H.position={x:i.position.x+(i.dimensions.width+50),y:i.position.y+50},v(H)}})};function Te(S){const i=window.getComputedStyle(S),H=new DOMMatrix(i.transform);return{scaleX:H.a,scaleY:H.d,translateX:H.e,translateY:H.f}}const ue=(S,i,H)=>{const L=document.querySelector(".vue-flow__transformationpane"),W=Te(L).scaleX,Xe=window.innerWidth/2,Ze=window.innerHeight/2,bt=_({x:Xe-300*W,y:Ze-300*W}),kt=F(He.cloneDeep(i),bt);v(kt)},we=q(!1),Ce=q({1:"用于查询店铺政策、产品知识、常见参数等的知识库查询工具。适用于一般性问题、多个产品比较类问题等",2:"提取的查询问题列表",3:"品牌选择项：华为、惠普、奔图、爱普生、佳能、兄弟、东芝、利盟、京瓷、联想、施乐；根据聊天记录和问题选择品牌，不涉及品牌时留空",4:"仅当问题中明确包含产品[id]并且是询问该商品的规格时，才使用此工具查询特定[id]商品的规格信息",5:"提取的查询问题列表",6:"提取产品id列表",7:"用于根据商品的品牌、型号查询NC系统商品价格和库存",8:'"输出json格式","输出markdown内容"',9:'[{"brand":"商品1的品牌","model":"商品1的型号"},{"brand":"商品2的品牌","model":"商品2的型号"}]'}),V=()=>{o.commit("flowdata",{curnodeid:""})};Ge(()=>b.value.length,(S,i)=>{w()},{deep:!0}),Ge(()=>U.value.length,(S,i)=>{w()},{deep:!0});const w=()=>{b.value.forEach(S=>{let i=[];U.value.forEach(H=>{if(S.id===H.source){let L=1;S.data.next_nodes&&S.data.next_nodes.length>0&&S.data.next_nodes.forEach(W=>{W.id===H.targetNode.id&&(L=W.max_run_times)});let me=He.cloneDeep(H.targetNode);me.max_run_times=L,i.push({id:me.id,max_run_times:L,role:me.data.role})}}),S.data.next_nodes=i})},p=q({product_knowledge_base_ids:[],product_top_k:1,doc_knowledge_base_ids:[],doc_top_k:1,excel_knowledge_base_ids:[],excel_top_k:1,filter_value:.3,output_option:"json",description:"",querys_desc:"",brands_desc:""}),$=q([{fun_name:"knowledge_retrieve",name:"知识库查询",tool:"knowledge_retrieve",desc:"知识库查询工具，用于查询各种领域知识。",options:{description:"知识库查询工具，用于查询各种领域知识。",queries:"",queries_desc:"提取要查询的问题列表",tags:"",tags_desc:"提取要查询问题的标签列表",ids:"",ids_desc:"提取要查询问题的id列表",product_knowledge_base_ids:void 0,product_top_k:void 0,doc_knowledge_base_ids:[],doc_top_k:1,excel_knowledge_base_ids:[],excel_top_k:1,filter_value:.3,output_option:"json",metadata_filter:[]}},{fun_name:"calculator",name:"计算器",tool:"calculator",nodeType:"tool",desc:"计算器工具，用于执行数学表达式。",options:{description:"计算器工具，用于执行数学表达式。",expression_desc:"填写要计算的数学表达式",expression:""}},{fun_name:"knowledge_append",name:"知识库内容追加",tool:"knowledge_append",nodeType:"tool",desc:"用于向知识库指定的文档中追加内容。",options:{description:"用于向知识库指定的文档中追加内容。",doucument_id_desc:"填写文档的id",doucument_id:"",content_desc:"填写要追加的知识内容",content:""}},{fun_name:"unit_test_add",name:"添加单元测试",tool:"unit_test_add",nodeType:"tool",desc:"用于把指定的流程运行日志添加到单元测试中。",options:{description:"用于把指定的流程运行日志添加到单元测试中。",unit_cate_id_desc:"填写要添加单元测试的指定分类id",unit_cate_id:"",node_log_id:"",node_log_id_desc:"填写要添加单元测试的节点日志id",test_note:"",test_note_desc:"填写测试备注信"}},{fun_name:"train_case_add",name:"添加语料",tool:"train_case_add",nodeType:"tool",desc:"用于向指定的语料分类中添加语料。",options:{description:"用于向指定的语料分类中添加语料。",train_cate_id:"",train_cate_id_desc:"填写语料所要归属的分类id",input_content:"",input_content_desc:"填写语料的输入文本",output_contet:"",output_contet_desc:"填写语料的输出文本",feature:"",feature_desc:"填写语料的特征文本",node_log_id:"",node_log_id_desc:"填写与该语料关联的节点日志ID，非必填",test_case_id:"",test_case_id_desc:"填写与该语料关联的单元测试ID，非必填"}},{fun_name:"flow_node_logs",name:"查询流程日志",tool:"flow_node_logs",nodeType:"tool",desc:"用于使用指定条件查询流程日志",options:{description:"用于使用指定条件查询流程日志",flow_id:"",flow_id_desc:"填写流程id",role_id:"",role_id_desc:"填写节点角色id",start_time:"",start_time_desc:"填写日志起始日期，格式：yyyy-MM-dd hh:mm:ss",end_time:"",end_time_desc:"填写日志结束日期，格式：yyyy-MM-dd hh:mm:ss",max_top_n:"",max_top_n_desc:"填写最大返回的日志数量"}},{fun_name:"knowledge_add",name:"知识库文档添加",tool:"knowledge_add",nodeType:"tool",desc:"用于向指定的知识库指定的分类中添加一份独立的知识文档。",options:{description:"用于向指定的知识库指定的分类中添加一份独立的知识文档。",knowledgebase_id_desc:"填写文档所属知识库id",knowledgebase_id:"",category_id:"",category_id_desc:"填写文档所属分类id",title:"",title_desc:"填写文档的标题",content:"",content_desc:"填写文档的内容"}}]),M=(S,i)=>{var H={knowledge_add:{dataType:"tool",description:"用于向指定的知识库指定的分类中添加一份独立的知识文档。",knowledgebase_id_desc:"填写文档所属知识库id",knowledgebase_id:"",category_id:"",category_id_desc:"填写文档所属分类id",title:"",title_desc:"填写文档的标题",content:"",content_desc:"填写文档的内容"},flow_node_logs:{dataType:"tool",description:"用于使用指定条件查询流程日志",flow_id_desc:"填写流程id",role_id_desc:"填写节点角色id",start_time_desc:"填写日志起始日期，格式：yyyy-MM-dd hh:mm:ss",end_time_desc:"填写日志结束日期，格式：yyyy-MM-dd hh:mm:ss",max_top_n_desc:"填写最大返回的日志数量"},train_case_add:{dataType:"tool",description:"用于向指定的语料分类中添加语料。",train_cate_id_desc:"填写语料所要归属的分类id",input_content_desc:"填写语料的输入文本",output_contet_desc:"填写语料的输出文本",feature_desc:"填写语料的特征文本",node_log_id_desc:"填写与该语料关联的节点日志ID，非必填",test_case_id_desc:"填写与该语料关联的单元测试ID，非必填"},unit_test_add:{dataType:"tool",description:"用于把指定的流程运行日志添加到单元测试中。",unit_cate_id_desc:"填写要添加单元测试的指定分类id",node_log_id_desc:"填写要添加单元测试的节点日志id",test_note_desc:"填写测试备注信"},knowledge_append:{dataType:"tool",description:"用于向知识库指定的文档中追加内容。",doucument_id_desc:"填写文档的id",content_desc:"填写要追加的知识内容"},calculator:{dataType:"tool",description:"计算器工具，用于执行数学表达式。",expression_desc:"填写要计算的数学表达式"},vectorstore_retrieve:{description:Ce.value[1],dataType:"tool",querys_desc:Ce.value[2]},product_retrieve:{description:Ce.value[4],dataType:"tool",querys_desc:Ce.value[5]},inventory_price_retrieve:{description:Ce.value[7],querys_desc:Ce.value[9],dataType:"tool"},printer_consumable_retrieve:{description:"用于查询打印设备的适用耗材（硒鼓、墨盒、碳粉、粉盒、粉仓、墨水、色带架、色带芯等）",model_desc:"提取打印设备的型号，类似LaserJet Pro MFP M226dw",dataType:"tool"},websearch:{description:"使用搜索引擎查询相关信息",model_desc:"使用搜索引擎查询相关信息",dataType:"tool"},knowledge_retrieve:{description:"知识库查询工具，用于查询各种领域知识。",queries_desc:"提取的查询问题列表",tags_desc:"提取的查询问题的标签列表",ids_desc:"提取查询问题的id列表",dataType:"tool"}};return H[S]&&H[S][i]!==void 0?H[S][i]:""},fe=q([]),_e=q([]),Ne=()=>{let S=He.cloneDeep($.value);_e.value=S,console.log(S),S.forEach(i=>{let H=He.cloneDeep(i.options);const L={id:i.id+"_"+new Date().getTime(),type:"tool",width:"750px",isopen:!0,next_nodes:[],prompt_template:void 0,choice_role_prompt:void 0,auto_section_run:void 0,llm_id:void 0,functions:[{fun_name:i.fun_name,options:H,name:i.name}],outputs:void 0,react:void 0,react_max_times:10,auto_choice_node:void 0,dataItem:i};let me;i.type=="flow"?me={datatype:"flow",role:i.name,icon:"icon-gongzuoliugongju",description:i.caption,caption:i.caption}:i.type=="plugin"&&i.datatype=="plugin"?me={datatype:"plugin",role:i.name,icon:"icon-gongzuochajian",description:i.caption,caption:i.caption}:i.type=="plugin"&&i.datatype=="mcp"?me={datatype:"mcp",role:i.name,icon:"icon-MCP",description:i.caption,caption:i.caption}:me={datatype:"tool",role:i.name,icon:"icon-gongju1",description:M(i.fun_name,"description")},j.value.push({...L,...me})}),fe.value=He.cloneDeep(j.value),console.log(j.value)},De=q("");Ge(De,S=>{Je(S)});const Be=q("");Ge(Be,S=>{Re(S)});const Re=S=>{S?j.value=fe.value.filter(i=>i.role.toLowerCase().includes(S.toLowerCase())):j.value=He.cloneDeep(fe.value)},Je=S=>{S?$.value=_e.value.filter(i=>i.name.toLowerCase().includes(S.toLowerCase())):$.value=He.cloneDeep(_e.value)},gt=(S,i)=>{let H=[],L=[],me=i&&i.inputs?JSON.parse(i.inputs):{};if(S&&(L=S.nodes,L.forEach(W=>{W.data&&W.data.type=="start"&&(H=He.cloneDeep(W.data.inputs)||[])})),H.forEach(W=>{me&&me[W.name]?W.curvalue=me[W.name]:W.curvalue=""}),i===void 0){let W={};return H.forEach(Xe=>{W[Xe.name]=Xe.curvalue}),W}else lt.value.inputs=He.cloneDeep(H)||[]},It=()=>{let S={};lt.value.inputs.forEach(i=>{S[i.name]=i.curvalue}),mt.value.forEach(i=>{i.fun_name==ee.value.type&&(i.options.inputs=JSON.stringify(S),i.options.output_option=lt.value.output_option)})},ht=(S,i)=>$.value.filter(H=>S?i?H.type===S&&H.datatype===i:H.type===S:H.type!=="flow"&&H.type!=="plugin"),ft=S=>{let i=!1;return mt.value.forEach(H=>{S.fun_name===H.fun_name&&(i=!0)}),i},Bt=S=>{if(ft(S)){let i=mt.value.findIndex(H=>H.fun_name===S.fun_name);mt.value.splice(i,1)}else mt.value.push({fun_name:S.fun_name,options:He.cloneDeep(S.options),name:S.name})},mt=q([]),ee=q(null),J=q(!1),d=q("工作流配置"),ze=S=>{if(d.value="工作流配置",lt.value.type=void 0,console.log(S),qe.value=S.id,ee.value=S||null,mt.value=He.cloneDeep(S.item.functions)||[],ee.value.type==0)d.value="选择工具";else if(M(ee.value.type,"dataType")=="tool")mt.value.forEach(i=>{i.fun_name==ee.value.type&&(d.value=i.name,p.value=He.cloneDeep(i.options))});else{let i=-1;if($.value.forEach((H,L)=>{H.fun_name==ee.value.type&&(i=L)}),i!==-1){let H=$.value[i];if(H.type==="plugin")mt.value.forEach(L=>{if(L.fun_name==ee.value.type){d.value=H.name,lt.value.output_option=L.options.output_option||void 0,lt.value.type=H.type,lt.value.caption=H.desc;let me=[];H.in_params.forEach(Ze=>{Ze.default_value||me.push(Ze)});let W=He.cloneDeep(me)||[],Xe=L.options.inputs?JSON.parse(L.options.inputs):{};W.forEach(Ze=>{Xe&&Xe[Ze.name]?Ze.curvalue=Xe[Ze.name]:Ze.curvalue=""}),lt.value.inputs=He.cloneDeep(W)||[]}});else if(H.view_json){let L=JSON.parse(H.view_json);mt.value.forEach(me=>{me.fun_name==ee.value.type&&(d.value=me.name,lt.value.output_option=me.options.output_option||void 0,gt(L,He.cloneDeep(me.options)),lt.value.caption=H.caption)})}else{_this.$message("未找到该工具配置，请先配置相关参数","error");return}}else{_this.$message("未找到该工具配置，请先配置相关参数","error");return}}J.value=!0},Pe=async(S,i)=>{await _this.$confirm(S)&&i&&i()},he=async S=>{let i=-1;if(console.log(p.value),b.value.forEach((H,L)=>{ee.value&&ee.value.id===H.id&&(i=L)}),ee.value.type!=0)if(M(ee.value.type,"dataType")=="tool")mt.value.forEach(H=>{H.fun_name==ee.value.type&&(H.options=He.cloneDeep(p.value))});else{if(!S)return;if(!await S.validate(L=>{if(L)It();else return!1}))return!1}i!==-1&&(b.value[i].data.functions=mt.value),J.value=!1},Ye=q([]),at=q([]),rt=q([]);n.path!="/flowshare"&&xa().then(S=>{let i=S||[];Ye.value=[],i.forEach(H=>{H.type==2?at.value.push(H):H.type==1?Ye.value.push(H):H.type==3&&rt.value.push(H)})});const on=q(!1),yt=q([]);q("");const hn=q(null),Ln=S=>{let i=-1;b.value.forEach((H,L)=>{hn.value&&hn.value.id===H.id&&(i=L)}),b.value[i].data.prompt_template=S[0],b.value[i].data.prompt_id=S[0].id,on.value=!1,yt.value=[]},Fn=S=>{qe.value=S.id,hn.value=S,Yn.value=S.nodeid,Xn.value=n.query.id,S.item.prompt_template&&S.item.prompt_template.id?yt.value=[{id:S.item.prompt_template.id}]:yt.value=[],on.value=!0},Rt=q(!1),yn=q([]),wt=q({inputs:[]}),lt=q({inputs:[]}),Ht=()=>{if(vt.value)return vt.value.__isShowBtn__=!0,m.value=!0,!1;b.value.forEach(S=>{S.data&&S.data.type=="start"&&(yn.value=He.cloneDeep(S.data.inputs)||[])}),yn.value.forEach(S=>{let i=-1;wt.value.inputs.forEach((H,L)=>{H.id==S.id&&(i=L)}),i!==-1?((S.data_type=="File"||S.data_type=="Array<File>")&&(S.fileList=wt.value.inputs[i].fileList),S.curvalue=wt.value.inputs[i].curvalue):S.data_type=="File"?(S.curvalue={},S.fileList=[]):S.data_type=="Array<File>"?(S.curvalue=[],S.fileList=[]):S.curvalue=o.getters.keyTypesValue[S.data_type]}),wt.value.inputs=He.cloneDeep(yn.value)||[],Rt.value=!0},qn=q(null),vt=q(null),m=q(!1),Z=q(null),X=q(!1),ln=S=>{if(n.path=="/flowshare"){if(X.value)return!1;X.value=!0;let L={};return wt.value.inputs.forEach(me=>{L[me.name]=me.curvalue}),Do.value.push({type:2,mes:L.user_input}),f({type:"run_workflow",data:{question_id:a.value,pin_id:a.value,workflow_id:n.query.id,user_id:a.value,input:L,origin:3,api_key:n.query.api_key}}),!1}let i=!0,H="";if(b.value.forEach(L=>{L.data&&L.data.type=="llm"&&(L.data.prompt_id||(H="请检查节点配置，提示词不能为空!",i=!1),L.data.llm_id||(H="请检查节点配置，大模型不能为空!",i=!1),(L.data.role==""||L.data.role==null)&&(H="请检查节点配置，节点名称不能为空!",i=!1))}),!i)return _this.$message(H,"error"),!1;S&&S.validate(L=>{if(L){let W={id:n.query.id,inputs:""},Xe={};wt.value.inputs.forEach(Ze=>{Xe[Ze.name]=Ze.curvalue}),W.inputs=JSON.stringify(Xe),W.use_log=!0,Ea(W).then(Ze=>{Ze.flow_name=ne.value.name,vt.value=Ze,vt.value.__isShowBtn__=!0,Sl.value="760px",m.value=!0})}else return!1})},Rs=(S,i,H)=>{let L=S.row;if(!(!L.is_required&&!i)){if(L.is_required&&!i&&i!==0)return H(new Error("请输入"+L.name)),!1;if(i&&L.data_type!="String"){if(L.data_type=="Integer"){if(!Na(i))return H(new Error("请输入整数")),!1}else if(L.data_type=="Number"){if(!za(i))return H(new Error("请输入数字")),!1}else if(L.data_type=="Object"){if(!Al(i))return H(new Error("请输入正确的json")),!1}else if(L.data_type.indexOf("Array")!==-1&&L.data_type.indexOf("File")===-1&&!Al(i))return H(new Error("请输入正确的数组")),!1}}H()},Gn=q(!1),$l=q({name:"",content:"",id:void 0,prompt_type_id:null}),Yn=q(""),Xn=q(""),qe=q(""),Hs=S=>{qe.value=S.id,Yn.value=S.nodeid,Xn.value=n.query.id;let i=S.item;i&&($l.value=He.cloneDeep(i),Gn.value=!0)},Ls=(S,i)=>{b.value.forEach(H=>{H.data.prompt_template&&H.data.prompt_template.id==S.id&&(H.data.prompt_template.name=S.name,H.data.prompt_template.content=S.content,H.data.prompt_template.prompt_type_id=S.prompt_type_id)}),Gn.value=!1},Fs=S=>{},El=q([]);n.path!="/flowshare"&&ba({}).then(S=>{El.value=S||[]});const Sl=q("760px"),qs=q([]),Cl=q(!1),Do=q([]),Gs=S=>{},To=q([]),Ys=S=>{if(S.eventtype=="add")To.value=S.space_vars;else if(S.eventtype=="del")b.value.forEach(i=>{i.data.type=="llm"&&i.data.outputs&&i.data.outputs.length>0&&Xs(i.data.outputs,S.id)});else{let i=null;S.space_vars.forEach(H=>{H.id==S.id&&(i=H)}),b.value.forEach(H=>{H.data.type=="llm"&&Nl(H.data.outputs,S.id,i)})}b.value=[].concat(b.value)};function Nl(S,i,H){for(let L=0;L<S.length;L++){if(S[L].space_vars_id===i)return S[L].name=H.name,S[L].data_type=H.data_type,!0;if(S[L].children&&S[L].children.length>0&&Nl(S[L].children,i,H))return!0}return!1}function zl(S,i,H,L){if(S.space_vars_id===i)return{parentChildren:H,parentIndex:L};if(S.children)for(let me=0;me<S.children.length;me++){const W=zl(S.children[me],i,S.children,me);if(W)return W}return null}function Xs(S,i){return S.forEach((H,L)=>{const me=zl(H,i,S,L);if(me)return me.parentChildren.splice(me.parentIndex,1),!0}),!1}const Zn=q(!0),Ml=q({}),Ao=q(!1),Zs=async S=>{let i=null;S.type=="1"?i=await Va({flow_id:n.query.id,runner_id:S.id+"",prompt_temp:S.content}):i=await $a({flow_id:n.query.id,runner_id:S.id+""}),i&&(S.type=="1"?(Ml.value=i.prompt_str,Ao.value=!0):(vt.value=He.cloneDeep(i),vt.value.__uid__=vt.value.id,vt.value.__flowid__=n.query.id,vt.value.__runnerid__=S.id+"",vt.value.__isShowBtn__=!1,vt.value.id=void 0,m.value=!0))},js=()=>{re.value.fitView({padding:10,minZoom:.8,maxZoom:1,nodes:[jn.value]})},jn=q("");Ge(jn,S=>{js()});const _n=q(!0),wn=q(!0),xn=q(!0),bn=q(!0);function Ws(S,i){return new RegExp(`\\.(${i.join("|")})$`,"i").test(S.name)}const Ks=(S,i)=>S.size>i.constraint.max_file_kb*1024?(_this.$message(`文件大小不能超过${i.constraint.max_file_kb}KB`,"error"),!1):Ws(S,i.constraint.allowed_ext_types)?(o.commit("loading",!0),!0):(_this.$message(`不支持的文件类型，请上传${i.constraint.allowed_ext_types}格式文件`,"error"),!1),Po=(S,i,H,L)=>{o.commit("loading",!1);let me=[];L.fileList.forEach(W=>{me.push(W.response)}),L.data_type=="File"?L.curvalue=me[0]:L.curvalue=me,console.log(L)},Js=S=>{o.commit("loading",!1);let i=S.toString();i=i.replace("UploadAjaxError: ",""),i=JSON.parse(i),_this.$message(i.detail,"error")},Qs=S=>{console.log(S),localStorage.setItem("COMMON__MARKDOWN_EDITOR__TEXT",S)};return(S,i)=>{const H=We("el-option"),L=We("el-select"),me=We("el-button"),W=We("el-input"),Xe=We("el-scrollbar"),Ze=We("el-form-item"),bt=We("el-input-number"),kt=We("el-radio"),kn=We("el-radio-group"),ea=We("el-slider"),Wn=We("el-form"),Kn=We("el-drawer"),Il=We("v-md-preview"),ta=We("el-upload"),na=We("el-switch"),oa=zi("loading");return y(),z(be,null,[s("div",{onClick:i[15]||(i[15]=c=>V()),class:"pagebox c-pagebox"},[s("div",_h,[s("div",wh,[s("div",{onClick:i[0]||(i[0]=c=>Y(Oo)(null,S.$router,"/flowlist")),class:"back"},[ne.value&&ne.value.name?(y(),z("span",xh,oe(ne.value.name),1)):B("",!0)])]),s("div",bh,[h(L,{modelValue:jn.value,"onUpdate:modelValue":i[1]||(i[1]=c=>jn.value=c),filterable:"",placeholder:"快速定位节点",style:{width:"200px","margin-right":"16px"}},{default:N(()=>[(y(!0),z(be,null,Fe(b.value.filter(c=>c.data.type!="loop_start"),c=>(y(),ie(H,{key:c.id,label:c.data.role,value:c.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),h(me,{plain:"",onClick:i[2]||(i[2]=c=>Ve(()=>{Ht()}))},{default:N(()=>i[135]||(i[135]=[G("保存并运行")])),_:1}),h(me,{type:"primary",onClick:i[3]||(i[3]=c=>Ve())},{default:N(()=>i[136]||(i[136]=[G("保存")])),_:1}),s("span",{onClick:i[4]||(i[4]=c=>Y(Oo)(null,S.$router,"/flowlist")),class:"c-iconbackbox"},i[137]||(i[137]=[s("span",{class:"iconfont icon-fuwenben-chexiao"},null,-1),G(" 返回 ")]))])]),we.value?B("",!0):(y(),z("div",{key:0,onClick:i[5]||(i[5]=c=>we.value=!0),title:"选择节点",class:"showAddbtn"},i[138]||(i[138]=[s("span",{class:"iconfont icon-jiahao1"},null,-1)]))),s("div",{class:Me([{open:we.value},"navbox"])},[s("div",kh,[s("span",{onClick:i[6]||(i[6]=c=>{Be.value="",we.value=!1}),class:"iconfont icon-fanhui"}),h(W,{style:{width:"calc(100% - 50px)"},type:"text",modelValue:Be.value,"onUpdate:modelValue":i[7]||(i[7]=c=>Be.value=c),clearable:"",size:"small",placeholder:"搜索"},null,8,["modelValue"])]),s("div",Vh,[h(Xe,null,{default:N(()=>[(y(!0),z(be,null,Fe(j.value.filter(c=>c.datatype=="llm"),(c,nt)=>(y(),z("div",{key:nt,class:"vue-flow__node-input item",onClick:xe=>ue(xe,c,nt),draggable:!0,onDragstart:xe=>Y(E)(xe,Y(He.cloneDeep)(c),b.value)},[s("div",{title:c.role,class:"c-icons"},[s("span",{class:Me("iconfont "+c.icon)},null,2),s("div",Sh,oe(c.role),1)],8,Eh),i[139]||(i[139]=s("span",{class:"iconfont icon-liebiao-zengjia"},null,-1))],40,$h))),128)),s("div",Ch,[s("span",{class:Me(["c-open-zhankaibox",{on:bn.value}]),onClick:i[8]||(i[8]=c=>bn.value=!bn.value)},[i[140]||(i[140]=s("span",{class:"iconfont icon-anniu-zhankai"},null,-1)),G(" "+oe((bn.value,""))+"工具 ",1)],2)]),(y(!0),z(be,null,Fe(j.value.filter(c=>c.datatype=="tool"),(c,nt)=>je((y(),z("div",{key:nt,class:"vue-flow__node-input item c-shadow",draggable:!0,onClick:xe=>ue(xe,c,nt),onDragstart:xe=>Y(E)(xe,Y(He.cloneDeep)(c),b.value)},[s("div",{title:c.role,class:"c-icons"},[s("span",{class:Me("iconfont "+c.icon)},null,2),s("div",Mh,oe(c.role),1)],8,zh),i[141]||(i[141]=s("span",{class:"iconfont icon-liebiao-zengjia"},null,-1))],40,Nh)),[[Ke,bn.value]])),128)),s("div",Ih,[s("span",{class:Me(["c-open-zhankaibox",{on:xn.value}]),onClick:i[9]||(i[9]=c=>xn.value=!xn.value)},[i[142]||(i[142]=s("span",{class:"iconfont icon-anniu-zhankai"},null,-1)),G(" "+oe((xn.value,""))+"工作流工具 ",1)],2)]),(y(!0),z(be,null,Fe(j.value.filter(c=>c.datatype=="flow"),(c,nt)=>je((y(),z("div",{key:nt,class:"vue-flow__node-input item c-shadow",draggable:!0,onClick:xe=>ue(xe,c,nt),onDragstart:xe=>Y(E)(xe,Y(He.cloneDeep)(c),b.value)},[s("div",{title:c.role,class:"c-icons"},[s("span",{class:Me("iconfont "+c.icon)},null,2),s("div",Ah,oe(c.role),1)],8,Th),i[143]||(i[143]=s("span",{class:"iconfont icon-liebiao-zengjia"},null,-1))],40,Dh)),[[Ke,xn.value]])),128)),s("div",Ph,[s("span",{class:Me(["c-open-zhankaibox",{on:wn.value}]),onClick:i[10]||(i[10]=c=>wn.value=!wn.value)},[i[144]||(i[144]=s("span",{class:"iconfont icon-anniu-zhankai"},null,-1)),G(" "+oe((wn.value,""))+"API工具 ",1)],2)]),(y(!0),z(be,null,Fe(j.value.filter(c=>c.datatype=="plugin"),(c,nt)=>je((y(),z("div",{key:nt,class:"vue-flow__node-input item c-shadow",draggable:!0,onClick:xe=>ue(xe,c,nt),onDragstart:xe=>Y(E)(xe,Y(He.cloneDeep)(c),b.value)},[s("div",{title:c.role,class:"c-icons"},[s("span",{class:Me("iconfont "+c.icon)},null,2),s("div",Bh,oe(c.role),1)],8,Uh),i[145]||(i[145]=s("span",{class:"iconfont icon-liebiao-zengjia"},null,-1))],40,Oh)),[[Ke,wn.value]])),128)),s("div",Rh,[s("span",{class:Me(["c-open-zhankaibox",{on:_n.value}]),onClick:i[11]||(i[11]=c=>_n.value=!_n.value)},[i[146]||(i[146]=s("span",{class:"iconfont icon-anniu-zhankai"},null,-1)),G(" "+oe((_n.value,""))+"MCP工具 ",1)],2)]),(y(!0),z(be,null,Fe(j.value.filter(c=>c.datatype=="mcp"),(c,nt)=>je((y(),z("div",{key:nt,class:"vue-flow__node-input item c-shadow",draggable:!0,onClick:xe=>ue(xe,c,nt),onDragstart:xe=>Y(E)(xe,Y(He.cloneDeep)(c),b.value)},[s("div",{title:c.role,class:"c-icons"},[s("span",{class:Me("iconfont "+c.icon)},null,2),s("div",Fh,oe(c.role),1)],8,Lh),i[147]||(i[147]=s("span",{class:"iconfont icon-liebiao-zengjia"},null,-1))],40,Hh)),[[Ke,_n.value]])),128))]),_:1})])],2),Y(n).path!="/flowshare"&&te.value?(y(),z("div",{key:1,onDrop:i[14]||(i[14]=(...c)=>Y(O)&&Y(O)(...c)),class:"flow c-flow-box"},[h(Y(Tf),{maxZoom:1,"apply-default":!1,"elevate-edges-on-select":!0,minZoom:.2,ref_key:"curflow",ref:re,"connection-mode":Y(Xt).Strict,nodes:b.value,"onUpdate:nodes":i[12]||(i[12]=c=>b.value=c),edges:U.value,"onUpdate:edges":i[13]||(i[13]=c=>U.value=c),onDragover:Y(le),onDragleave:Y(Ee),class:"custom-node-flow","fit-view-on-init":""},{"edge-button":N(c=>[h(ch,{id:c.id,"source-x":c.sourceX,"source-y":c.sourceY,"target-x":c.targetX,"target-y":c.targetY,"source-position":c.sourcePosition,"target-position":c.targetPosition,"marker-end":c.markerEnd,style:it(c.style)},null,8,["id","source-x","source-y","target-x","target-y","source-position","target-position","marker-end","style"])]),"node-card":N(c=>[h(rh,{id:c.id,onDelfn:se,onCopyfn:Ie,onInitfn:w,onChecktypefn:ze,onOpendrawerfn:Fn,onOpentscfn:Hs,onChangespace_varsname:Ys,onNode_run_debug:Zs,space_vars:To.value,llmlist:El.value,edges:U.value,nodes:b.value,data:c.data,splist:at.value,textlist:Ye.value,excellist:rt.value,funclist:$.value,navlist:j.value},null,8,["id","space_vars","llmlist","edges","nodes","data","splist","textlist","excellist","funclist","navlist"])]),default:N(()=>[h(Y(yh),{"pattern-color":"#F6FAFD",gap:0}),h(Y(fv),{position:"right-bottom"})]),_:1},8,["connection-mode","nodes","edges","onDragover","onDragleave"])],32)):B("",!0)]),h(Kn,{modelValue:J.value,"onUpdate:modelValue":i[126]||(i[126]=c=>J.value=c),class:"c-drawer-box",title:ee.value?d.value:"",size:"600px"},{default:N(()=>[s("div",qh,[ee.value.type==0?(y(),ie(W,{key:0,clearable:"",modelValue:De.value,"onUpdate:modelValue":i[16]||(i[16]=c=>De.value=c),placeholder:"搜索"},null,8,["modelValue"])):B("",!0)]),s("div",Gh,[h(Xe,{ref:"scrollbarlog"},{default:N(()=>[s("div",Yh,[ee.value.type==0?(y(),z("div",Xh,[(y(!0),z(be,null,Fe(ht(),c=>(y(),z("div",{class:Me(["item",{on:ft(c)}]),onClick:nt=>Bt(c)},[s("div",jh,oe(c.name),1),s("div",Wh,oe(c.desc),1),ft(c)?(y(),z("span",Kh)):B("",!0)],10,Zh))),256)),i[148]||(i[148]=s("div",{class:"utilboxtitle"},[G(" 工具流工具 "),s("span",{class:"c-tips"},"(工作流被设置为工具 )")],-1)),ht("flow").length<1?(y(),z("div",Jh," 暂无数据 ")):B("",!0),(y(!0),z(be,null,Fe(ht("flow"),c=>(y(),z("div",{class:Me(["item",{on:ft(c)}]),onClick:nt=>Bt(c)},[s("div",e0,oe(c.name),1),s("div",t0,oe(c.desc),1),ft(c)?(y(),z("span",n0)):B("",!0)],10,Qh))),256)),i[149]||(i[149]=s("div",{class:"utilboxtitle"},[G(" API工具 "),s("span",{class:"c-tips"},"(启用的API工具插件 )")],-1)),ht("plugin","plugin").length<1?(y(),z("div",o0," 暂无数据 ")):B("",!0),(y(!0),z(be,null,Fe(ht("plugin","plugin"),c=>(y(),z("div",{class:Me(["item",{on:ft(c)}]),onClick:nt=>Bt(c)},[s("div",i0,oe(c.name),1),s("div",s0,oe(c.desc),1),ft(c)?(y(),z("span",a0)):B("",!0)],10,l0))),256)),i[150]||(i[150]=s("div",{class:"utilboxtitle"},[G(" MCP工具 "),s("span",{class:"c-tips"},"(MCP工具插件)")],-1)),ht("plugin","mcp").length<1?(y(),z("div",d0," 暂无数据 ")):B("",!0),(y(!0),z(be,null,Fe(ht("plugin","mcp"),c=>(y(),z("div",{class:Me(["item",{on:ft(c)}]),onClick:nt=>Bt(c)},[s("div",u0,oe(c.name),1),s("div",c0,oe(c.desc),1),ft(c)?(y(),z("span",p0)):B("",!0)],10,r0))),256))])):M(ee.value.type,"dataType")=="tool"?(y(),z("div",f0,[h(Wn,{class:"tl",model:p.value,"label-position":"top",inline:"","label-width":"auto"},{default:N(()=>[h(Ze,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>i[151]||(i[151]=[s("span",{style:{"font-weight":"bold"}},"工具描述",-1)])),default:N(()=>[h(W,{style:{width:"calc(100% - 27px)"},modelValue:p.value.description,"onUpdate:modelValue":i[17]||(i[17]=c=>p.value.description=c),placeholder:M(ee.value.type,"description"),type:"text"},null,8,["modelValue","placeholder"]),s("span",{onClick:i[18]||(i[18]=c=>p.value.description=M(ee.value.type,"description")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})]),_:1}),ee.value.type=="printer_consumable_retrieve"?(y(),z("div",v0,[i[154]||(i[154]=s("div",{class:"ctitle"},"model参数",-1)),s("div",g0,[i[152]||(i[152]=s("div",{class:"label"},"描述",-1)),s("div",m0,[h(W,{modelValue:p.value.model_desc,"onUpdate:modelValue":i[19]||(i[19]=c=>p.value.model_desc=c),placeholder:M(ee.value.type,"model_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[20]||(i[20]=c=>p.value.model_desc=M(ee.value.type,"model_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",h0,[i[153]||(i[153]=s("div",{class:"label"},"值",-1)),s("div",y0,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.model,"onUpdate:modelValue":i[21]||(i[21]=c=>p.value.model=c)},null,8,["nodes","edges","nodeid","modelValue"])])])])):B("",!0),ee.value.type=="knowledge_add"?(y(),z(be,{key:1},[s("div",_0,[i[157]||(i[157]=s("div",{class:"ctitle"},"knowledgebase_id参数",-1)),s("div",w0,[i[155]||(i[155]=s("div",{class:"label"},"描述",-1)),s("div",x0,[h(W,{modelValue:p.value.knowledgebase_id_desc,"onUpdate:modelValue":i[22]||(i[22]=c=>p.value.knowledgebase_id_desc=c),placeholder:M(ee.value.type,"knowledgebase_id_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[23]||(i[23]=c=>p.value.knowledgebase_id_desc=M(ee.value.type,"knowledgebase_id_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",b0,[i[156]||(i[156]=s("div",{class:"label"},"值",-1)),s("div",k0,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.knowledgebase_id,"onUpdate:modelValue":i[24]||(i[24]=c=>p.value.knowledgebase_id=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",V0,[i[160]||(i[160]=s("div",{class:"ctitle"},"category_id参数",-1)),s("div",$0,[i[158]||(i[158]=s("div",{class:"label"},"描述",-1)),s("div",E0,[h(W,{modelValue:p.value.category_id_desc,"onUpdate:modelValue":i[25]||(i[25]=c=>p.value.category_id_desc=c),placeholder:M(ee.value.type,"category_id_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[26]||(i[26]=c=>p.value.category_id_desc=M(ee.value.type,"category_id_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",S0,[i[159]||(i[159]=s("div",{class:"label"},"值",-1)),s("div",C0,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.category_id,"onUpdate:modelValue":i[27]||(i[27]=c=>p.value.category_id=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",N0,[i[163]||(i[163]=s("div",{class:"ctitle"},"title参数",-1)),s("div",z0,[i[161]||(i[161]=s("div",{class:"label"},"描述",-1)),s("div",M0,[h(W,{modelValue:p.value.title_desc,"onUpdate:modelValue":i[28]||(i[28]=c=>p.value.title_desc=c),placeholder:M(ee.value.type,"title_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[29]||(i[29]=c=>p.value.title_desc=M(ee.value.type,"title_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",I0,[i[162]||(i[162]=s("div",{class:"label"},"值",-1)),s("div",D0,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.title,"onUpdate:modelValue":i[30]||(i[30]=c=>p.value.title=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",T0,[i[166]||(i[166]=s("div",{class:"ctitle"},"content参数",-1)),s("div",A0,[i[164]||(i[164]=s("div",{class:"label"},"描述",-1)),s("div",P0,[h(W,{modelValue:p.value.content_desc,"onUpdate:modelValue":i[31]||(i[31]=c=>p.value.content_desc=c),placeholder:M(ee.value.type,"content_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[32]||(i[32]=c=>p.value.content_desc=M(ee.value.type,"content_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",O0,[i[165]||(i[165]=s("div",{class:"label"},"值",-1)),s("div",U0,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.content,"onUpdate:modelValue":i[33]||(i[33]=c=>p.value.content=c)},null,8,["nodes","edges","nodeid","modelValue"])])])])],64)):B("",!0),ee.value.type=="flow_node_logs"?(y(),z(be,{key:2},[s("div",B0,[i[169]||(i[169]=s("div",{class:"ctitle"},"flow_id参数",-1)),s("div",R0,[i[167]||(i[167]=s("div",{class:"label"},"描述",-1)),s("div",H0,[h(W,{modelValue:p.value.flow_id_desc,"onUpdate:modelValue":i[34]||(i[34]=c=>p.value.flow_id_desc=c),placeholder:M(ee.value.type,"flow_id_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[35]||(i[35]=c=>p.value.flow_id_desc=M(ee.value.type,"flow_id_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",L0,[i[168]||(i[168]=s("div",{class:"label"},"值",-1)),s("div",F0,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.flow_id,"onUpdate:modelValue":i[36]||(i[36]=c=>p.value.flow_id=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",q0,[i[172]||(i[172]=s("div",{class:"ctitle"},"role_id参数",-1)),s("div",G0,[i[170]||(i[170]=s("div",{class:"label"},"描述",-1)),s("div",Y0,[h(W,{modelValue:p.value.role_id_desc,"onUpdate:modelValue":i[37]||(i[37]=c=>p.value.role_id_desc=c),placeholder:M(ee.value.type,"role_id_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[38]||(i[38]=c=>p.value.role_id_desc=M(ee.value.type,"role_id_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",X0,[i[171]||(i[171]=s("div",{class:"label"},"值",-1)),s("div",Z0,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.role_id,"onUpdate:modelValue":i[39]||(i[39]=c=>p.value.role_id=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",j0,[i[175]||(i[175]=s("div",{class:"ctitle"},"start_time参数",-1)),s("div",W0,[i[173]||(i[173]=s("div",{class:"label"},"描述",-1)),s("div",K0,[h(W,{modelValue:p.value.start_time_desc,"onUpdate:modelValue":i[40]||(i[40]=c=>p.value.start_time_desc=c),placeholder:M(ee.value.type,"start_time_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[41]||(i[41]=c=>p.value.start_time_desc=M(ee.value.type,"start_time_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",J0,[i[174]||(i[174]=s("div",{class:"label"},"值",-1)),s("div",Q0,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.start_time,"onUpdate:modelValue":i[42]||(i[42]=c=>p.value.start_time=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",ey,[i[178]||(i[178]=s("div",{class:"ctitle"},"end_time参数",-1)),s("div",ty,[i[176]||(i[176]=s("div",{class:"label"},"描述",-1)),s("div",ny,[h(W,{modelValue:p.value.end_time_desc,"onUpdate:modelValue":i[43]||(i[43]=c=>p.value.end_time_desc=c),placeholder:M(ee.value.type,"end_time_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[44]||(i[44]=c=>p.value.end_time_desc=M(ee.value.type,"end_time_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",oy,[i[177]||(i[177]=s("div",{class:"label"},"值",-1)),s("div",ly,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.end_time,"onUpdate:modelValue":i[45]||(i[45]=c=>p.value.end_time=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",iy,[i[181]||(i[181]=s("div",{class:"ctitle"},"max_top_n参数",-1)),s("div",sy,[i[179]||(i[179]=s("div",{class:"label"},"描述",-1)),s("div",ay,[h(W,{modelValue:p.value.max_top_n_desc,"onUpdate:modelValue":i[46]||(i[46]=c=>p.value.max_top_n_desc=c),placeholder:M(ee.value.type,"max_top_n_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[47]||(i[47]=c=>p.value.max_top_n_desc=M(ee.value.type,"max_top_n_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",dy,[i[180]||(i[180]=s("div",{class:"label"},"值",-1)),s("div",ry,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.max_top_n,"onUpdate:modelValue":i[48]||(i[48]=c=>p.value.max_top_n=c)},null,8,["nodes","edges","nodeid","modelValue"])])])])],64)):B("",!0),ee.value.type=="train_case_add"?(y(),z(be,{key:3},[s("div",uy,[i[184]||(i[184]=s("div",{class:"ctitle"},"train_cate_id参数",-1)),s("div",cy,[i[182]||(i[182]=s("div",{class:"label"},"描述",-1)),s("div",py,[h(W,{modelValue:p.value.train_cate_id_desc,"onUpdate:modelValue":i[49]||(i[49]=c=>p.value.train_cate_id_desc=c),placeholder:M(ee.value.type,"train_cate_id_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[50]||(i[50]=c=>p.value.train_cate_id_desc=M(ee.value.type,"train_cate_id_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",fy,[i[183]||(i[183]=s("div",{class:"label"},"值",-1)),s("div",vy,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.train_cate_id,"onUpdate:modelValue":i[51]||(i[51]=c=>p.value.train_cate_id=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",gy,[i[187]||(i[187]=s("div",{class:"ctitle"},"input_content参数",-1)),s("div",my,[i[185]||(i[185]=s("div",{class:"label"},"描述",-1)),s("div",hy,[h(W,{modelValue:p.value.input_content_desc,"onUpdate:modelValue":i[52]||(i[52]=c=>p.value.input_content_desc=c),placeholder:M(ee.value.type,"input_content_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[53]||(i[53]=c=>p.value.input_content_desc=M(ee.value.type,"input_content_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",yy,[i[186]||(i[186]=s("div",{class:"label"},"值",-1)),s("div",_y,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.input_content,"onUpdate:modelValue":i[54]||(i[54]=c=>p.value.input_content=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",wy,[i[190]||(i[190]=s("div",{class:"ctitle"},"output_contet参数",-1)),s("div",xy,[i[188]||(i[188]=s("div",{class:"label"},"描述",-1)),s("div",by,[h(W,{modelValue:p.value.output_contet_desc,"onUpdate:modelValue":i[55]||(i[55]=c=>p.value.output_contet_desc=c),placeholder:M(ee.value.type,"output_contet_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[56]||(i[56]=c=>p.value.output_contet_desc=M(ee.value.type,"output_contet_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",ky,[i[189]||(i[189]=s("div",{class:"label"},"值",-1)),s("div",Vy,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.output_contet,"onUpdate:modelValue":i[57]||(i[57]=c=>p.value.output_contet=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",$y,[i[193]||(i[193]=s("div",{class:"ctitle"},"feature参数",-1)),s("div",Ey,[i[191]||(i[191]=s("div",{class:"label"},"描述",-1)),s("div",Sy,[h(W,{modelValue:p.value.feature_desc,"onUpdate:modelValue":i[58]||(i[58]=c=>p.value.feature_desc=c),placeholder:M(ee.value.type,"feature_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[59]||(i[59]=c=>p.value.feature_desc=M(ee.value.type,"feature_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",Cy,[i[192]||(i[192]=s("div",{class:"label"},"值",-1)),s("div",Ny,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.feature,"onUpdate:modelValue":i[60]||(i[60]=c=>p.value.feature=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",zy,[i[196]||(i[196]=s("div",{class:"ctitle"},"node_log_id参数",-1)),s("div",My,[i[194]||(i[194]=s("div",{class:"label"},"描述",-1)),s("div",Iy,[h(W,{modelValue:p.value.node_log_id_desc,"onUpdate:modelValue":i[61]||(i[61]=c=>p.value.node_log_id_desc=c),placeholder:M(ee.value.type,"node_log_id_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[62]||(i[62]=c=>p.value.node_log_id_desc=M(ee.value.type,"node_log_id_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",Dy,[i[195]||(i[195]=s("div",{class:"label"},"值",-1)),s("div",Ty,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.node_log_id,"onUpdate:modelValue":i[63]||(i[63]=c=>p.value.node_log_id=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",Ay,[i[199]||(i[199]=s("div",{class:"ctitle"},"test_case_id参数",-1)),s("div",Py,[i[197]||(i[197]=s("div",{class:"label"},"描述",-1)),s("div",Oy,[h(W,{modelValue:p.value.test_case_id_desc,"onUpdate:modelValue":i[64]||(i[64]=c=>p.value.test_case_id_desc=c),placeholder:M(ee.value.type,"test_case_id_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[65]||(i[65]=c=>p.value.test_case_id_desc=M(ee.value.type,"test_case_id_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",Uy,[i[198]||(i[198]=s("div",{class:"label"},"值",-1)),s("div",By,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.test_case_id,"onUpdate:modelValue":i[66]||(i[66]=c=>p.value.test_case_id=c)},null,8,["nodes","edges","nodeid","modelValue"])])])])],64)):B("",!0),ee.value.type=="unit_test_add"?(y(),z(be,{key:4},[s("div",Ry,[i[202]||(i[202]=s("div",{class:"ctitle"},"unit_cate_id参数",-1)),s("div",Hy,[i[200]||(i[200]=s("div",{class:"label"},"描述",-1)),s("div",Ly,[h(W,{modelValue:p.value.unit_cate_id_desc,"onUpdate:modelValue":i[67]||(i[67]=c=>p.value.unit_cate_id_desc=c),placeholder:M(ee.value.type,"unit_cate_id_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[68]||(i[68]=c=>p.value.unit_cate_id_desc=M(ee.value.type,"unit_cate_id_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",Fy,[i[201]||(i[201]=s("div",{class:"label"},"值",-1)),s("div",qy,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.unit_cate_id,"onUpdate:modelValue":i[69]||(i[69]=c=>p.value.unit_cate_id=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",Gy,[i[205]||(i[205]=s("div",{class:"ctitle"},"node_log_id参数",-1)),s("div",Yy,[i[203]||(i[203]=s("div",{class:"label"},"描述",-1)),s("div",Xy,[h(W,{modelValue:p.value.node_log_id_desc,"onUpdate:modelValue":i[70]||(i[70]=c=>p.value.node_log_id_desc=c),placeholder:M(ee.value.type,"node_log_id_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[71]||(i[71]=c=>p.value.node_log_id_desc=M(ee.value.type,"node_log_id_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",Zy,[i[204]||(i[204]=s("div",{class:"label"},"值",-1)),s("div",jy,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.node_log_id,"onUpdate:modelValue":i[72]||(i[72]=c=>p.value.node_log_id=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",Wy,[i[208]||(i[208]=s("div",{class:"ctitle"},"test_note参数",-1)),s("div",Ky,[i[206]||(i[206]=s("div",{class:"label"},"描述",-1)),s("div",Jy,[h(W,{modelValue:p.value.test_note_desc,"onUpdate:modelValue":i[73]||(i[73]=c=>p.value.test_note_desc=c),placeholder:M(ee.value.type,"test_note_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[74]||(i[74]=c=>p.value.test_note_desc=M(ee.value.type,"test_note_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",Qy,[i[207]||(i[207]=s("div",{class:"label"},"值",-1)),s("div",e_,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.test_note,"onUpdate:modelValue":i[75]||(i[75]=c=>p.value.test_note=c)},null,8,["nodes","edges","nodeid","modelValue"])])])])],64)):B("",!0),ee.value.type=="knowledge_append"?(y(),z(be,{key:5},[s("div",t_,[i[211]||(i[211]=s("div",{class:"ctitle"},"doucument_id参数",-1)),s("div",n_,[i[209]||(i[209]=s("div",{class:"label"},"描述",-1)),s("div",o_,[h(W,{modelValue:p.value.doucument_id_desc,"onUpdate:modelValue":i[76]||(i[76]=c=>p.value.doucument_id_desc=c),placeholder:M(ee.value.type,"doucument_id_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[77]||(i[77]=c=>p.value.doucument_id_desc=M(ee.value.type,"doucument_id_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",l_,[i[210]||(i[210]=s("div",{class:"label"},"值",-1)),s("div",i_,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.doucument_id,"onUpdate:modelValue":i[78]||(i[78]=c=>p.value.doucument_id=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",s_,[i[214]||(i[214]=s("div",{class:"ctitle"},"content参数",-1)),s("div",a_,[i[212]||(i[212]=s("div",{class:"label"},"描述",-1)),s("div",d_,[h(W,{modelValue:p.value.content_desc,"onUpdate:modelValue":i[79]||(i[79]=c=>p.value.content_desc=c),placeholder:M(ee.value.type,"content_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[80]||(i[80]=c=>p.value.content_desc=M(ee.value.type,"content_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",r_,[i[213]||(i[213]=s("div",{class:"label"},"值",-1)),s("div",u_,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.content,"onUpdate:modelValue":i[81]||(i[81]=c=>p.value.content=c)},null,8,["nodes","edges","nodeid","modelValue"])])])])],64)):B("",!0),ee.value.type=="calculator"?(y(),z("div",c_,[i[217]||(i[217]=s("div",{class:"ctitle"},"expression参数",-1)),s("div",p_,[i[215]||(i[215]=s("div",{class:"label"},"描述",-1)),s("div",f_,[h(W,{modelValue:p.value.expression_desc,"onUpdate:modelValue":i[82]||(i[82]=c=>p.value.expression_desc=c),placeholder:M(ee.value.type,"expression_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[83]||(i[83]=c=>p.value.expression_desc=M(ee.value.type,"expression_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",v_,[i[216]||(i[216]=s("div",{class:"label"},"值",-1)),s("div",g_,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.expression,"onUpdate:modelValue":i[84]||(i[84]=c=>p.value.expression=c)},null,8,["nodes","edges","nodeid","modelValue"])])])])):B("",!0),ee.value.type=="vectorstore_retrieve"?(y(),z(be,{key:7},[s("div",m_,[i[220]||(i[220]=s("div",{class:"ctitle"},"querys参数",-1)),s("div",h_,[i[218]||(i[218]=s("div",{class:"label"},"描述",-1)),s("div",y_,[h(W,{modelValue:p.value.querys_desc,"onUpdate:modelValue":i[85]||(i[85]=c=>p.value.querys_desc=c),placeholder:M(ee.value.type,"querys_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[86]||(i[86]=c=>p.value.querys_desc=M(ee.value.type,"querys_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",__,[i[219]||(i[219]=s("div",{class:"label"},"值",-1)),s("div",w_,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.querys,"onUpdate:modelValue":i[87]||(i[87]=c=>p.value.querys=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",x_,[i[223]||(i[223]=s("div",{class:"ctitle"},"brands参数",-1)),s("div",b_,[i[221]||(i[221]=s("div",{class:"label"},"描述",-1)),s("div",k_,[h(W,{modelValue:p.value.brands_desc,"onUpdate:modelValue":i[88]||(i[88]=c=>p.value.brands_desc=c),placeholder:Ce.value[3],type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[89]||(i[89]=c=>p.value.brands_desc=Ce.value[3]),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",V_,[i[222]||(i[222]=s("div",{class:"label"},"值",-1)),s("div",$_,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.brands,"onUpdate:modelValue":i[90]||(i[90]=c=>p.value.brands=c)},null,8,["nodes","edges","nodeid","modelValue"])])])])],64)):B("",!0),ee.value.type=="product_retrieve"?(y(),z(be,{key:8},[s("div",E_,[i[226]||(i[226]=s("div",{class:"ctitle"},"querys参数",-1)),s("div",S_,[i[224]||(i[224]=s("div",{class:"label"},"描述",-1)),s("div",C_,[h(W,{modelValue:p.value.querys_desc,"onUpdate:modelValue":i[91]||(i[91]=c=>p.value.querys_desc=c),placeholder:M(ee.value.type,"querys_desc"),type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[92]||(i[92]=c=>p.value.querys_desc=M(ee.value.type,"querys_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",N_,[i[225]||(i[225]=s("div",{class:"label"},"值",-1)),s("div",z_,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.querys,"onUpdate:modelValue":i[93]||(i[93]=c=>p.value.querys=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",M_,[i[229]||(i[229]=s("div",{class:"ctitle"},"nc_ids参数",-1)),s("div",I_,[i[227]||(i[227]=s("div",{class:"label"},"描述",-1)),s("div",D_,[h(W,{modelValue:p.value.nc_ids_desc,"onUpdate:modelValue":i[94]||(i[94]=c=>p.value.nc_ids_desc=c),placeholder:Ce.value[6],type:"text",style:{width:"calc(100% - 27px)"}},null,8,["modelValue","placeholder"]),s("span",{onClick:i[95]||(i[95]=c=>p.value.nc_ids_desc=Ce.value[6]),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",T_,[i[228]||(i[228]=s("div",{class:"label"},"值",-1)),s("div",A_,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.nc_ids,"onUpdate:modelValue":i[96]||(i[96]=c=>p.value.nc_ids=c)},null,8,["nodes","edges","nodeid","modelValue"])])])])],64)):B("",!0),ee.value.type=="knowledge_retrieve"?(y(),z(be,{key:9},[s("div",P_,[i[232]||(i[232]=s("div",{class:"ctitle"},"queries参数",-1)),s("div",O_,[i[230]||(i[230]=s("div",{class:"label"},"描述",-1)),s("div",U_,[h(W,{style:{width:"calc(100% - 27px)"},modelValue:p.value.queries_desc,"onUpdate:modelValue":i[97]||(i[97]=c=>p.value.queries_desc=c),placeholder:M(ee.value.type,"queries_desc"),type:"text"},null,8,["modelValue","placeholder"]),s("span",{onClick:i[98]||(i[98]=c=>p.value.queries_desc=M(ee.value.type,"queries_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",B_,[i[231]||(i[231]=s("div",{class:"label"},"值",-1)),s("div",R_,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.queries,"onUpdate:modelValue":i[99]||(i[99]=c=>p.value.queries=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",H_,[i[235]||(i[235]=s("div",{class:"ctitle"},"tags参数",-1)),s("div",L_,[i[233]||(i[233]=s("div",{class:"label"},"描述",-1)),s("div",F_,[h(W,{style:{width:"calc(100% - 27px)"},modelValue:p.value.tags_desc,"onUpdate:modelValue":i[100]||(i[100]=c=>p.value.tags_desc=c),placeholder:M(ee.value.type,"tags_desc"),type:"text"},null,8,["modelValue","placeholder"]),s("span",{onClick:i[101]||(i[101]=c=>p.value.tags_desc=M(ee.value.type,"tags_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",q_,[i[234]||(i[234]=s("div",{class:"label"},"值",-1)),s("div",G_,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.tags,"onUpdate:modelValue":i[102]||(i[102]=c=>p.value.tags=c)},null,8,["nodes","edges","nodeid","modelValue"])])])]),s("div",Y_,[i[238]||(i[238]=s("div",{class:"ctitle"},"ids参数",-1)),s("div",X_,[i[236]||(i[236]=s("div",{class:"label"},"描述",-1)),s("div",Z_,[h(W,{style:{width:"calc(100% - 27px)"},modelValue:p.value.ids_desc,"onUpdate:modelValue":i[103]||(i[103]=c=>p.value.ids_desc=c),placeholder:M(ee.value.type,"ids_desc"),type:"text"},null,8,["modelValue","placeholder"]),s("span",{onClick:i[104]||(i[104]=c=>p.value.ids_desc=M(ee.value.type,"ids_desc")),title:"恢复默认值",style:{"margin-left":"10px"},class:"iconfont icon-huifumorenzhi c-pointer"})])]),s("div",j_,[i[237]||(i[237]=s("div",{class:"label"},"值",-1)),s("div",W_,[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:p.value.ids,"onUpdate:modelValue":i[105]||(i[105]=c=>p.value.ids=c)},null,8,["nodes","edges","nodeid","modelValue"])])])])],64)):B("",!0),p.value.doc_knowledge_base_ids!==void 0?(y(),ie(Ze,{key:10,style:{width:"calc(50% - 8px)","margin-right":"16px"},label:"文档知识库"},{default:N(()=>[h(L,{modelValue:p.value.doc_knowledge_base_ids,"onUpdate:modelValue":i[106]||(i[106]=c=>p.value.doc_knowledge_base_ids=c),multiple:"","collapse-tags":"","max-collapse-tags":2,placeholder:"请选择知识库"},{default:N(()=>[(y(!0),z(be,null,Fe(Ye.value,c=>(y(),ie(H,{key:c.id,label:c.name,value:c.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):B("",!0),p.value.doc_top_k!==void 0?(y(),ie(Ze,{key:11,style:{width:"calc(50% - 8px)","margin-right":"0px"},label:"文档知识库召回文本数"},{default:N(()=>[h(bt,{style:{width:"100%"},placeholder:"请填写文本召回文本数",modelValue:p.value.doc_top_k,"onUpdate:modelValue":i[107]||(i[107]=c=>p.value.doc_top_k=c),min:0,max:20,precision:0,step:1,"controls-position":"right"},null,8,["modelValue"]),je(s("span",K_,"文本数太多，可能会影响大模型token数超出限制",512),[[Ke,p.value.doc_top_k>5]])]),_:1})):B("",!0),p.value.excel_knowledge_base_ids!==void 0?(y(),ie(Ze,{key:12,style:{width:"calc(50% - 8px)","margin-right":"16px"},label:"EXCEL参数库"},{default:N(()=>[h(L,{modelValue:p.value.excel_knowledge_base_ids,"onUpdate:modelValue":i[108]||(i[108]=c=>p.value.excel_knowledge_base_ids=c),multiple:"","collapse-tags":"","max-collapse-tags":2,placeholder:"请选择EXCEL参数库"},{default:N(()=>[(y(!0),z(be,null,Fe(rt.value,c=>(y(),ie(H,{key:c.id,label:c.name,value:c.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):B("",!0),p.value.excel_top_k!==void 0?(y(),ie(Ze,{key:13,style:{width:"calc(50% - 8px)","margin-right":"0px"},label:"EXCEL参数库召回文本数"},{default:N(()=>[h(bt,{style:{width:"100%"},placeholder:"请填写EXCEL参数库召回文本数",modelValue:p.value.excel_top_k,"onUpdate:modelValue":i[109]||(i[109]=c=>p.value.excel_top_k=c),min:0,max:20,precision:0,step:1,"controls-position":"right"},null,8,["modelValue"]),je(s("span",J_,"文本数太多，可能会影响大模型token数超出限制",512),[[Ke,p.value.excel_top_k>5]])]),_:1})):B("",!0),p.value.top_k!==void 0?(y(),ie(Ze,{key:14,style:{width:"calc(50% - 8px)","margin-right":"16px"},label:"召回文本数"},{default:N(()=>[h(bt,{style:{width:"100%"},placeholder:"请填写召回文本数",modelValue:p.value.top_k,"onUpdate:modelValue":i[110]||(i[110]=c=>p.value.top_k=c),min:0,max:20,precision:0,step:1,"controls-position":"right"},null,8,["modelValue"]),je(s("span",Q_,"文本数太多，可能会影响大模型token数超出限制",512),[[Ke,p.value.top_k>5]])]),_:1})):B("",!0),p.value.metadata_filter!==void 0?(y(),z("div",ew,[s("div",tw,[s("div",nw,[s("span",{class:Me([{off:Zn.value},"iconfont icon-xiajiantou pointer"]),onClick:i[111]||(i[111]=Se(c=>Zn.value=!Zn.value,["stop"]))},null,2),i[240]||(i[240]=G()),i[241]||(i[241]=s("span",{class:"iconfont icon-keyonggongju"},null,-1)),i[242]||(i[242]=G("元数据过滤 ")),s("span",ow,[s("span",{class:"addvarbtn",onClick:i[112]||(i[112]=c=>p.value.metadata_filter.push({id:Date.now(),key:"",operator:"=",value:"",desc:""}))},i[239]||(i[239]=[s("span",{class:"iconfont icon-liebiao-zengjia"},null,-1),G(" 添加条件")]))])]),je(s("div",lw,[s("div",iw,[i[243]||(i[243]=s("div",{class:"item title"},[s("span",{style:{width:"25%"},class:"val"},"字段"),s("span",{style:{width:"25%"},class:"val"},"操作符"),s("span",{style:{width:"25%"},class:"val"},"值"),s("span",{style:{width:"25%"},class:"val"},"描述")],-1)),p.value&&p.value.metadata_filter.length>0?B("",!0):(y(),z("div",sw," 暂无数据 ")),p.value&&p.value.metadata_filter.length>0?(y(!0),z(be,{key:1},Fe(p.value.metadata_filter,(c,nt)=>(y(),z("div",aw,[s("div",dw,[h(W,{onClick:i[113]||(i[113]=Se(()=>{},["stop","prevent"])),onMousedown:i[114]||(i[114]=Se(()=>{},["stop"])),onBlur:xe=>c.key?c.errtip="":c.errtip="字段不能为空",size:"small",placeholder:"",modelValue:c.key,"onUpdate:modelValue":xe=>c.key=xe},null,8,["onBlur","modelValue","onUpdate:modelValue"])]),s("div",rw,[h(L,{size:"small",modelValue:c.operator,"onUpdate:modelValue":xe=>c.operator=xe,placeholder:"请选择"},{default:N(()=>[h(H,{value:"=",label:"="})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),s("div",uw,[h(W,{onClick:i[115]||(i[115]=Se(()=>{},["stop","prevent"])),onMousedown:i[116]||(i[116]=Se(()=>{},["stop"])),size:"small",placeholder:"",modelValue:c.value,"onUpdate:modelValue":xe=>c.value=xe},null,8,["modelValue","onUpdate:modelValue"])]),s("div",cw,[h(W,{onBlur:xe=>c.desc?c.errtip="":c.errtip="描述不能为空",onClick:i[117]||(i[117]=Se(()=>{},["stop","prevent"])),onMousedown:i[118]||(i[118]=Se(()=>{},["stop"])),size:"small",placeholder:"",modelValue:c.desc,"onUpdate:modelValue":xe=>c.desc=xe},null,8,["onBlur","modelValue","onUpdate:modelValue"]),s("span",{title:"删除当前项",onClick:xe=>{Pe("确定要删除该数据吗？",()=>{p.value.metadata_filter.splice(nt,1)})},class:"iconfont icon-liebiao-shanchu"},null,8,pw)]),c.errtip?(y(),z("div",fw,oe(c.errtip),1)):B("",!0)]))),256)):B("",!0)])],512),[[Ke,Zn.value]])])])):B("",!0),p.value.output_option!==void 0?(y(),ie(Ze,{key:16,style:{width:"calc(50% - 8px)","margin-right":"0px"},label:"输出格式"},{default:N(()=>[h(kn,{modelValue:p.value.output_option,"onUpdate:modelValue":i[119]||(i[119]=c=>p.value.output_option=c)},{default:N(()=>[h(kt,{value:"json"},{default:N(()=>i[244]||(i[244]=[G("输出json格式内容")])),_:1}),h(kt,{value:"markdown"},{default:N(()=>i[245]||(i[245]=[G("输出markdown内容")])),_:1})]),_:1},8,["modelValue"])]),_:1})):B("",!0),p.value.filter_value!==void 0?(y(),ie(Ze,{key:17,style:{width:"100%","margin-right":"0px"},label:"评分过滤值"},{default:N(()=>[h(ea,{style:{width:"300px"},modelValue:p.value.filter_value,"onUpdate:modelValue":i[120]||(i[120]=c=>p.value.filter_value=c),step:.05,min:0,max:1},null,8,["modelValue"]),je(s("span",vw,"过滤分数过高，可能会影响召回文档数",512),[[Ke,p.value.filter_value>.5]])]),_:1})):B("",!0)]),_:1},8,["model"])])):lt.value.type=="plugin"?(y(),z("div",gw,[h(Wn,{ref_key:"formflowRef",ref:Z,model:lt.value,"label-width":"auto","label-position":"top",inline:"",class:"demo-dynamic tl"},{default:N(()=>[h(Ze,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>i[246]||(i[246]=[s("span",{style:{"font-weight":"bold"}},"工具描述",-1)])),default:N(()=>[h(W,{style:{width:"calc(100%)"},modelValue:lt.value.caption,"onUpdate:modelValue":i[121]||(i[121]=c=>lt.value.caption=c),disabled:"",type:"text"},null,8,["modelValue"])]),_:1}),J.value&&lt.value.inputs?(y(!0),z(be,{key:0},Fe(lt.value.inputs,(c,nt)=>(y(),ie(Ze,{style:{width:"100%","margin-right":"0px"},key:c.key},{default:N(()=>[s("div",mw,[s("div",hw,[G(oe(c.name)+"参数",1),c.is_required?(y(),z("span",yw,"*")):B("",!0),i[247]||(i[247]=G()),s("span",_w,oe(c.data_type),1)]),s("div",ww,[i[248]||(i[248]=s("div",{class:"label"},"描述",-1)),h(W,{style:{width:"100%"},disabled:"",modelValue:c.caption,"onUpdate:modelValue":xe=>c.caption=xe,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),s("div",xw,[i[249]||(i[249]=s("div",{class:"label"},"值",-1)),s("div",{style:it("height: 60px; width: 100%;z-index: "+(1e3-nt))},[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:c.curvalue,"onUpdate:modelValue":xe=>c.curvalue=xe},null,8,["nodes","edges","nodeid","modelValue","onUpdate:modelValue"])],4)])])]),_:2},1024))),128)):B("",!0),lt.value.output_option!==void 0?(y(),ie(Ze,{key:1,style:{width:"100%","margin-right":"0px"},label:"输出格式"},{default:N(()=>[h(kn,{modelValue:lt.value.output_option,"onUpdate:modelValue":i[122]||(i[122]=c=>lt.value.output_option=c)},{default:N(()=>[h(kt,{value:"markdown"},{default:N(()=>i[250]||(i[250]=[G("输出markdown内容")])),_:1}),h(kt,{value:"json"},{default:N(()=>i[251]||(i[251]=[G("输出json格式内容")])),_:1})]),_:1},8,["modelValue"])]),_:1})):B("",!0)]),_:1},8,["model"])])):(y(),z("div",bw,[s("div",kw,[s("div",Vw,[h(Wn,{style:{margin:"0px 20px","text-align":"left"},ref_key:"formflowRef",ref:Z,model:lt.value,"label-width":"auto","label-position":"top",inline:"",class:"demo-dynamic"},{default:N(()=>[h(Ze,{style:{width:"100%","margin-right":"0"},label:""},{label:N(()=>i[252]||(i[252]=[s("span",{style:{"font-weight":"bold"}},"工具描述",-1)])),default:N(()=>[h(W,{style:{width:"calc(100%)"},modelValue:lt.value.caption,"onUpdate:modelValue":i[123]||(i[123]=c=>lt.value.caption=c),disabled:"",type:"text"},null,8,["modelValue"])]),_:1}),J.value&&lt.value.inputs?(y(!0),z(be,{key:0},Fe(lt.value.inputs,(c,nt)=>(y(),ie(Ze,{style:{width:"100%","margin-right":"0px"},key:c.key,prop:"inputs["+nt+"].curvalue"},{default:N(()=>[s("div",$w,[s("div",Ew,[G(oe(c.name)+"参数",1),c.is_required?(y(),z("span",Sw,"*")):B("",!0),i[253]||(i[253]=G()),s("span",Cw,oe(c.data_type),1)]),s("div",Nw,[i[254]||(i[254]=s("div",{class:"label"},"描述",-1)),h(W,{style:{width:"100%"},disabled:"",modelValue:c.desc,"onUpdate:modelValue":xe=>c.desc=xe,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),s("div",zw,[i[255]||(i[255]=s("div",{class:"label"},"值",-1)),s("div",{style:it("height: 60px; width: 100%;z-index: "+(1e3-nt))},[h(ye,{nodes:b.value,edges:U.value,nodeid:qe.value,modelValue:c.curvalue,"onUpdate:modelValue":xe=>c.curvalue=xe},null,8,["nodes","edges","nodeid","modelValue","onUpdate:modelValue"])],4)])])]),_:2},1032,["prop"]))),128)):B("",!0)]),_:1},8,["model"])])])]))])]),_:1},512)]),s("div",Mw,[h(me,{onClick:i[124]||(i[124]=c=>J.value=!1),plain:""},{default:N(()=>i[256]||(i[256]=[G(" 取消 ")])),_:1}),h(me,{type:"primary",onClick:i[125]||(i[125]=c=>he(Z.value))},{default:N(()=>i[257]||(i[257]=[G(" 保存 ")])),_:1})])]),_:1},8,["modelValue","title"]),h(Kn,{modelValue:Ao.value,"onUpdate:modelValue":i[127]||(i[127]=c=>Ao.value=c),"close-on-click-modal":!0,size:"780px",title:"运行结果",direction:"rtl"},{default:N(()=>[s("div",Iw,[h(Xe,null,{default:N(()=>[h(Il,{text:Ml.value},null,8,["text"])]),_:1})])]),_:1},8,["modelValue"]),Y(n).path=="/flowshare"?(y(),z("div",Dw)):B("",!0),Y(n).path=="/flowshare"?(y(),z("div",Tw,[s("div",Aw,[h(Xe,{ref:"shareScroll"},{default:N(()=>[(y(!0),z(be,null,Fe(Do.value,(c,nt)=>(y(),z("div",{key:nt,class:Me(["item",{lbox:c.type==1,rbox:c.type==2,["js-"+c.id]:!0,active:S.dialogFormVisibleid==c.id}])},[s("div",Pw,[s("span",{onClick:xe=>Qs(c.mes),class:"iconfontbox"},[c.type==2?(y(),ie(Tl,{key:0,type:"userphone",width:"30",height:"30"})):B("",!0),c.type==1?(y(),ie(Tl,{key:1,type:"jiqiren",width:"30",height:"30"})):B("",!0)],8,Ow),s("div",null,[h(Il,{text:c.mes},null,8,["text"])])])],2))),128)),u.value?(y(),z("div",Uw,[je(s("div",Bw,null,512),[[oa,u.value]])])):B("",!0)]),_:1},512)])])):B("",!0),h(Kn,{modelValue:Rt.value,"onUpdate:modelValue":i[129]||(i[129]=c=>Rt.value=c),"close-on-click-modal":!0,modal:Y(n).path!="/flowshare",size:Sl.value,title:"试运行",direction:"rtl"},{default:N(()=>[je(s("div",Rw,[s("div",Hw,[h(Xe,null,{default:N(()=>[h(Wn,{style:{margin:"0 20px"},ref_key:"formRef",ref:qn,model:wt.value,"label-width":"auto",class:"demo-dynamic"},{default:N(()=>[(y(!0),z(be,null,Fe(wt.value.inputs,(c,nt)=>(y(),ie(Ze,{key:c.key,prop:"inputs["+nt+"].curvalue",rules:{trigger:"blur",validator:Rs,row:c}},{default:N(()=>[s("div",Lw,[s("div",Fw,[G(oe(c.name)+"参数",1),c.is_required?(y(),z("span",qw,"*")):B("",!0),i[258]||(i[258]=G()),s("span",Gw,oe(c.data_type),1)]),s("div",{title:c.desc,class:"citem"},[i[259]||(i[259]=s("div",{class:"label"},"描述",-1)),h(W,{style:{width:"100%"},disabled:"",modelValue:c.desc,"onUpdate:modelValue":xe=>c.desc=xe,type:"text"},null,8,["modelValue","onUpdate:modelValue"])],8,Yw),s("div",Xw,[i[261]||(i[261]=s("div",{style:{display:"flex","align-items":"center","justify-content":"space-between"},class:"label"},[s("span",null,"值")],-1)),s("div",null,[c.data_type=="File"||c.data_type=="Array<File>"?(y(),z(be,{key:0},[c.constraint?(y(),ie(ta,{key:0,class:"upload-demo","file-list":c.fileList,"onUpdate:fileList":xe=>c.fileList=xe,headers:{authorization:"Bearer "+Y(o).state.token},action:"/api/files/upload?flow_id="+Y(n).query.id+(Y(n).query.api_key?"&api_key="+Y(n).query.api_key:""),"show-file-list":!0,limit:c.constraint.max_qty,"auto-upload":!0,multiple:c.constraint.max_qty>1,"on-exceed":(xe,Dt)=>{S.exceedFile(xe,Dt,c)},"on-error":Js,"on-change":(xe,Dt)=>{c.fileList=Dt,Po({},xe,Dt,c)},"on-remove":(xe,Dt)=>{c.fileList=Dt,Po({},xe,Dt,c)},"on-success":(xe,Dt,la)=>{Po(xe,Dt,la,c)},"before-upload":xe=>Ks(xe,c)},{tip:N(()=>[s("div",Zw,[G(" 文件大小不能超过 "+oe(c.constraint.max_file_kb)+"KB， 仅支持下列文件格式：",1),(y(!0),z(be,null,Fe(c.constraint.allowed_ext_types,xe=>(y(),z("span",null,oe(xe)+", ",1))),256))])]),default:N(()=>[h(me,{size:"small",type:"primary"},{default:N(()=>i[260]||(i[260]=[G("上传文件")])),_:1})]),_:2},1032,["file-list","onUpdate:fileList","headers","action","limit","multiple","on-exceed","on-change","on-remove","on-success","before-upload"])):B("",!0)],64)):c.data_type=="String"?(y(),z(be,{key:1},[c.name=="user_input"?(y(),ie(W,{key:0,placeholder:"请输入"+c.name,modelValue:c.curvalue,"onUpdate:modelValue":xe=>c.curvalue=xe,type:"textarea",rows:6},null,8,["placeholder","modelValue","onUpdate:modelValue"])):(y(),ie(W,{key:1,placeholder:"请输入"+c.name,modelValue:c.curvalue,"onUpdate:modelValue":xe=>c.curvalue=xe},null,8,["placeholder","modelValue","onUpdate:modelValue"]))],64)):c.data_type=="Integer"||c.data_type=="Number"?(y(),ie(bt,{key:2,modelValue:c.curvalue,"onUpdate:modelValue":xe=>c.curvalue=xe,style:{width:"500px","text-align":"left"},placeholder:"请输入"+c.name,controls:!0,"controls-position":"right",size:"small"},null,8,["modelValue","onUpdate:modelValue","placeholder"])):c.data_type=="Boolean"?(y(),ie(na,{key:3,modelValue:c.curvalue,"onUpdate:modelValue":xe=>c.curvalue=xe},null,8,["modelValue","onUpdate:modelValue"])):(y(),ie(W,{key:4,modelValue:c.curvalue,"onUpdate:modelValue":xe=>c.curvalue=xe,rows:10,type:"textarea",placeholder:"请输入"+c.name},null,8,["modelValue","onUpdate:modelValue","placeholder"]))])])])]),_:2},1032,["prop","rules"]))),128))]),_:1},8,["model"])]),_:1})]),s("div",jw,[h(me,{disabled:X.value,loading:X.value,onClick:i[128]||(i[128]=c=>ln(qn.value)),type:"primary"},{default:N(()=>i[262]||(i[262]=[G("运行")])),_:1},8,["disabled","loading"])])],512),[[Ke,!m.value]])]),_:1},8,["modelValue","modal","size"]),h(Kn,{modelValue:on.value,"onUpdate:modelValue":i[130]||(i[130]=c=>on.value=c),size:"90%",title:"",direction:"rtl"},{default:N(()=>[h(Ia,{onSubfn:Ln,curdataid:Yn.value,curflowid:Xn.value,isCheck:!0,nodeid:qe.value,nodes:b.value,edges:U.value,checkList:yt.value},null,8,["curdataid","curflowid","nodeid","nodes","edges","checkList"])]),_:1},8,["modelValue"]),h(Ma,{modelValue:Gn.value,"onUpdate:modelValue":i[131]||(i[131]=c=>Gn.value=c),onSubfn:Ls,onErrfn:Fs,nodeid:qe.value,curdataid:Yn.value,curflowid:Xn.value,nodes:b.value,edges:U.value,item:$l.value},null,8,["modelValue","nodeid","curdataid","curflowid","nodes","edges","item"]),h(Da,{title:"引用内容",curContext:qs.value,modelValue:Cl.value,"onUpdate:modelValue":i[132]||(i[132]=c=>Cl.value=c)},null,8,["curContext","modelValue"]),Y(n).path!="/flowshare"?(y(),ie(Ta,{key:2,modelValue:m.value,"onUpdate:modelValue":i[133]||(i[133]=c=>m.value=c),onChange:Gs,onBtnclose:i[134]||(i[134]=c=>{vt.value=null,c&&Ht()}),data:vt.value},null,8,["modelValue","data"])):B("",!0)],64)}}},dx=Mi(Ww,[["__scopeId","data-v-ab1dab7c"]]);export{dx as default};
